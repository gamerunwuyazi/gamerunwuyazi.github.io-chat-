"use strict";(self["webpackChunkvue_chat"]=self["webpackChunkvue_chat"]||[]).push([[461],{1241:function(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[n,l]of t)a[n]=l;return a}},7461:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});a(4114),a(9112),a(3110);var n=a(6768),l=a(144),s=a(7507);const r={class:"register-container"},u={class:"register-form"},o={class:"input-group"},i={class:"input-group"},c={class:"input-group"},v={class:"input-group"},d={class:"input-group"},p={class:"input-group"},f={style:{display:"flex",gap:"10px","align-items":"center"}},m={class:"login-link"};var k={__name:"Register",setup(e){const t=(0,s.n)(),a=(0,l.KR)(null),k=(0,l.KR)(null),g=(0,l.KR)(null),h=(0,l.KR)(null),y=(0,l.KR)(null),L=(0,l.KR)(null),x=(0,l.KR)(null),C=(0,l.KR)(null),w=(0,l.KR)(null),b=(0,l.KR)(null),_=(0,l.KR)(null),R=(0,l.KR)(null),K=(0,l.KR)(null),N=(0,l.KR)(null),I=(0,l.KR)(null);let E="";function T(e,t){let a;return function(){clearTimeout(a),a=setTimeout(()=>e.apply(this,arguments),t)}}async function q(){try{const e=await fetch("https://back.hs.airoe.cn/captcha"),t=await e.json();"success"===t.status&&N.value&&(N.value.innerHTML=t.captchaSvg,E=t.captchaId)}catch(e){F("获取验证码失败，请稍后重试","error")}}async function A(){if(!k.value||!g.value)return!1;const e=k.value.value.trim();if(!e)return g.value.textContent="",!1;if(e.length>30)return g.value.textContent="用户名长度不能超过30个字符",g.value.className="validation-message error",!1;g.value.textContent="检查中...",g.value.className="validation-message";try{const t=await fetch(`https://back.hs.airoe.cn/check-username?username=${encodeURIComponent(e)}`),a=await t.json();return"success"===a.status?a.isAvailable?(g.value.textContent="用户名可用",g.value.className="validation-message success",!0):(g.value.textContent="用户名已存在",g.value.className="validation-message error",!1):(g.value.textContent=a.message||"检查失败，请稍后重试",g.value.className="validation-message error",!1)}catch(t){return g.value.textContent="网络错误，请检查用户名是否合法，并稍后重试",g.value.className="validation-message error",!1}}function P(){if(!h.value||!y.value)return!1;const e=h.value.value.trim();return e?e.length>30?(y.value.textContent="昵称长度不能超过30个字符",y.value.className="validation-message error",!1):(y.value.textContent="昵称可用",y.value.className="validation-message success",!0):(y.value.textContent="",!1)}function S(){if(!L.value||!x.value||!C.value)return!1;const e=L.value.value;return e?e.length<6?(x.value.textContent="密码长度不能少于6个字符",x.value.className="validation-message error",C.value.textContent="",!1):(x.value.textContent="",x.value.className="validation-message",O(e),!0):(x.value.textContent="",C.value.textContent="",!1)}function O(e){if(!C.value)return;let t=0;e.length>=6&&t++,/[0-9]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/[^A-Za-z0-9]/.test(e)&&t++;let a="",n="";t<=2?(a="密码强度：弱",n="password-strength weak"):t<=3?(a="密码强度：中等",n="password-strength medium"):(a="密码强度：强",n="password-strength strong"),C.value.textContent=a,C.value.className=n}function j(){if(!L.value||!w.value||!b.value)return!1;const e=L.value.value,t=w.value.value;return t?e!==t?(b.value.textContent="两次输入的密码不一致",b.value.className="validation-message error",!1):(b.value.textContent="密码一致",b.value.className="validation-message success",!0):(b.value.textContent="",!1)}async function W(){const e=await A(),t=P(),a=S(),n=j(),l=""!==K.value?.value?.trim();return e&&t&&a&&n&&l}async function z(e){if(e.preventDefault(),!await W())return void F("请修正表单中的错误后再提交","error");const a=k.value?.value?.trim()||"",n=h.value?.value?.trim()||"",l=L.value?.value?.trim()||"",s=I.value?.value?.trim()||"",r=K.value?.value?.trim()||"";try{R.value&&(R.value.disabled=!0,R.value.textContent="注册中...");const e=await fetch("https://back.hs.airoe.cn/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,nickname:n,password:l,signature:s,captchaId:E,captchaCode:r})}),o=await e.text();let i;try{i=JSON.parse(o)}catch(u){return void F("服务器响应格式错误，请稍后重试","error")}if(i.success||"success"===i.status||200===i.code)F("注册成功，即将跳转到登录页面...","success"),setTimeout(()=>{t.push("/login")},1500);else{const e=i.message||i.msg||"注册失败，请稍后重试";F(e,"error"),q()}}catch(o){F("注册请求失败，请检查用户名/昵称/密码是否合法，并稍后重试","error"),q()}finally{R.value&&(R.value.disabled=!1,R.value.textContent="注册")}}function F(e,t){_.value&&(_.value.textContent=e,_.value.style.display="block","error"===t?(_.value.style.color="#d32f2f",_.value.style.backgroundColor="#ffebee",_.value.style.borderColor="#ffcdd2"):"success"===t&&(_.value.style.color="#388e3c",_.value.style.backgroundColor="#e8f5e8",_.value.style.borderColor="#c8e6c9"))}return(0,n.sV)(()=>{q(),N.value&&N.value.addEventListener("click",q),a.value&&a.value.addEventListener("submit",z),k.value&&k.value.addEventListener("input",T(A,500)),h.value&&h.value.addEventListener("input",P),L.value&&L.value.addEventListener("input",S),w.value&&w.value.addEventListener("input",j)}),(e,t)=>{const l=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",r,[t[9]||(t[9]=(0,n.Lk)("div",{class:"decoration decoration-1"},null,-1)),t[10]||(t[10]=(0,n.Lk)("div",{class:"decoration decoration-2"},null,-1)),t[11]||(t[11]=(0,n.Lk)("div",{class:"decoration decoration-3"},null,-1)),(0,n.Lk)("div",u,[t[8]||(t[8]=(0,n.Lk)("h1",null,"注册聊天室账号",-1)),(0,n.Lk)("form",{ref_key:"registerForm",ref:a},[(0,n.Lk)("div",o,[t[0]||(t[0]=(0,n.Lk)("label",{for:"username"},"用户名",-1)),(0,n.Lk)("input",{type:"text",id:"username",ref_key:"usernameInput",ref:k,name:"username",required:"",placeholder:"请输入用户名"},null,512)]),(0,n.Lk)("div",i,[t[1]||(t[1]=(0,n.Lk)("label",{for:"nickname"},"昵称",-1)),(0,n.Lk)("input",{type:"text",id:"nickname",ref_key:"nicknameInput",ref:h,name:"nickname",required:"",placeholder:"请输入昵称"},null,512)]),(0,n.Lk)("div",c,[t[2]||(t[2]=(0,n.Lk)("label",{for:"password"},"密码",-1)),(0,n.Lk)("input",{type:"password",id:"password",ref_key:"passwordInput",ref:L,name:"password",required:"",placeholder:"请输入密码"},null,512),(0,n.Lk)("div",{class:"password-strength",ref_key:"passwordStrength",ref:C},null,512)]),(0,n.Lk)("div",v,[t[3]||(t[3]=(0,n.Lk)("label",{for:"confirmPassword"},"确认密码",-1)),(0,n.Lk)("input",{type:"password",id:"confirmPassword",ref_key:"confirmPasswordInput",ref:w,name:"confirmPassword",required:"",placeholder:"请再次输入密码"},null,512)]),(0,n.Lk)("div",d,[t[4]||(t[4]=(0,n.Lk)("label",{for:"signature"},[(0,n.eW)("个性签名 "),(0,n.Lk)("span",{style:{color:"#999","font-weight":"normal"}},"(可选)")],-1)),(0,n.Lk)("input",{type:"text",id:"signature",ref_key:"signatureInput",ref:I,name:"signature",placeholder:"请输入个性签名（最多500字）",maxlength:"500"},null,512)]),(0,n.Lk)("div",p,[t[5]||(t[5]=(0,n.Lk)("label",{for:"captcha"},"验证码",-1)),(0,n.Lk)("div",f,[(0,n.Lk)("input",{type:"text",id:"captcha",ref_key:"captchaInput",ref:K,name:"captcha",required:"",placeholder:"请输入验证码",style:{flex:"1",width:"0"}},null,512),(0,n.Lk)("div",{ref_key:"captchaContainer",ref:N,style:{cursor:"pointer","flex-shrink":"0",width:"120px"}},null,512)])]),(0,n.Lk)("button",{type:"submit",ref_key:"registerButton",ref:R},"注册",512)],512),(0,n.Lk)("p",m,[t[7]||(t[7]=(0,n.eW)("已有账号？",-1)),(0,n.bF)(l,{to:"/login"},{default:(0,n.k6)(()=>[...t[6]||(t[6]=[(0,n.eW)("去登录",-1)])]),_:1})]),(0,n.Lk)("div",{ref_key:"registerMessage",ref:_,class:"register-message",style:{display:"none"}},null,512)])])}}},g=a(1241);const h=(0,g.A)(k,[["__scopeId","data-v-01b46922"]]);var y=h}}]);