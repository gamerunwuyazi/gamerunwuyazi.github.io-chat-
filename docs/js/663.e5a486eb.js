"use strict";(self["webpackChunkvue_chat"]=self["webpackChunkvue_chat"]||[]).push([[663],{1241:function(e,a){a.A=(e,a)=>{const t=e.__vccOpts||e;for(const[n,l]of a)t[n]=l;return t}},4663:function(e,a,t){t.r(a),t.d(a,{default:function(){return h}});t(4114),t(9112),t(3110);var n=t(6768),l=t(144),s=t(7507);const r={class:"register-container"},u={class:"register-form"},i={class:"input-group"},o={class:"input-group"},c={class:"input-group"},v={class:"input-group"},d={class:"input-group"},f={style:{display:"flex",gap:"10px","align-items":"center"}},p={class:"login-link"};var m={__name:"Register",setup(e){const a=(0,s.n)(),t=(0,l.KR)(null),m=(0,l.KR)(null),k=(0,l.KR)(null),g=(0,l.KR)(null),h=(0,l.KR)(null),y=(0,l.KR)(null),L=(0,l.KR)(null),C=(0,l.KR)(null),w=(0,l.KR)(null),x=(0,l.KR)(null),b=(0,l.KR)(null),_=(0,l.KR)(null),R=(0,l.KR)(null),N=(0,l.KR)(null);let K="";function I(e,a){let t;return function(){clearTimeout(t),t=setTimeout(()=>e.apply(this,arguments),a)}}async function E(){try{const e=await fetch("https://back.hs.airoe.cn/captcha"),a=await e.json();"success"===a.status&&N.value&&(N.value.innerHTML=a.captchaSvg,K=a.captchaId)}catch(e){j("获取验证码失败，请稍后重试","error")}}async function P(){if(!m.value||!k.value)return!1;const e=m.value.value.trim();if(!e)return k.value.textContent="",!1;if(e.length>30)return k.value.textContent="用户名长度不能超过30个字符",k.value.className="validation-message error",!1;k.value.textContent="检查中...",k.value.className="validation-message";try{const a=await fetch(`https://back.hs.airoe.cn/check-username?username=${encodeURIComponent(e)}`),t=await a.json();return"success"===t.status?t.isAvailable?(k.value.textContent="用户名可用",k.value.className="validation-message success",!0):(k.value.textContent="用户名已存在",k.value.className="validation-message error",!1):(k.value.textContent=t.message||"检查失败，请稍后重试",k.value.className="validation-message error",!1)}catch(a){return k.value.textContent="网络错误，请检查用户名是否合法，并稍后重试",k.value.className="validation-message error",!1}}function T(){if(!g.value||!h.value)return!1;const e=g.value.value.trim();return e?e.length>30?(h.value.textContent="昵称长度不能超过30个字符",h.value.className="validation-message error",!1):(h.value.textContent="昵称可用",h.value.className="validation-message success",!0):(h.value.textContent="",!1)}function q(){if(!y.value||!L.value||!C.value)return!1;const e=y.value.value;return e?e.length<6?(L.value.textContent="密码长度不能少于6个字符",L.value.className="validation-message error",C.value.textContent="",!1):(L.value.textContent="",L.value.className="validation-message",A(e),!0):(L.value.textContent="",C.value.textContent="",!1)}function A(e){if(!C.value)return;let a=0;e.length>=6&&a++,/[0-9]/.test(e)&&a++,/[a-z]/.test(e)&&a++,/[A-Z]/.test(e)&&a++,/[^A-Za-z0-9]/.test(e)&&a++;let t="",n="";a<=2?(t="密码强度：弱",n="password-strength weak"):a<=3?(t="密码强度：中等",n="password-strength medium"):(t="密码强度：强",n="password-strength strong"),C.value.textContent=t,C.value.className=n}function S(){if(!y.value||!w.value||!x.value)return!1;const e=y.value.value,a=w.value.value;return a?e!==a?(x.value.textContent="两次输入的密码不一致",x.value.className="validation-message error",!1):(x.value.textContent="密码一致",x.value.className="validation-message success",!0):(x.value.textContent="",!1)}async function V(){const e=await P(),a=T(),t=q(),n=S(),l=""!==R.value?.value?.trim();return e&&a&&t&&n&&l}async function O(e){if(e.preventDefault(),!await V())return void j("请修正表单中的错误后再提交","error");const t=m.value?.value?.trim()||"",n=g.value?.value?.trim()||"",l=y.value?.value?.trim()||"",s=R.value?.value?.trim()||"";try{_.value&&(_.value.disabled=!0,_.value.textContent="注册中...");const e=await fetch("https://back.hs.airoe.cn/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,nickname:n,password:l,captchaId:K,captchaCode:s})}),u=await e.text();let i;try{i=JSON.parse(u)}catch(r){return void j("服务器响应格式错误，请稍后重试","error")}if(i.success||"success"===i.status||200===i.code)j("注册成功，即将跳转到登录页面...","success"),setTimeout(()=>{a.push("/login")},1500);else{const e=i.message||i.msg||"注册失败，请稍后重试";j(e,"error"),E()}}catch(u){j("注册请求失败，请检查用户名/昵称/密码是否合法，并稍后重试","error"),E()}finally{_.value&&(_.value.disabled=!1,_.value.textContent="注册")}}function j(e,a){b.value&&(b.value.textContent=e,b.value.style.display="block","error"===a?(b.value.style.color="#d32f2f",b.value.style.backgroundColor="#ffebee",b.value.style.borderColor="#ffcdd2"):"success"===a&&(b.value.style.color="#388e3c",b.value.style.backgroundColor="#e8f5e8",b.value.style.borderColor="#c8e6c9"))}return(0,n.sV)(()=>{E(),N.value&&N.value.addEventListener("click",E),t.value&&t.value.addEventListener("submit",O),m.value&&m.value.addEventListener("input",I(P,500)),g.value&&g.value.addEventListener("input",T),y.value&&y.value.addEventListener("input",q),w.value&&w.value.addEventListener("input",S)}),(e,a)=>{const l=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",r,[a[8]||(a[8]=(0,n.Lk)("div",{class:"decoration decoration-1"},null,-1)),a[9]||(a[9]=(0,n.Lk)("div",{class:"decoration decoration-2"},null,-1)),a[10]||(a[10]=(0,n.Lk)("div",{class:"decoration decoration-3"},null,-1)),(0,n.Lk)("div",u,[a[7]||(a[7]=(0,n.Lk)("h1",null,"注册聊天室账号",-1)),(0,n.Lk)("form",{ref_key:"registerForm",ref:t},[(0,n.Lk)("div",i,[a[0]||(a[0]=(0,n.Lk)("label",{for:"username"},"用户名",-1)),(0,n.Lk)("input",{type:"text",id:"username",ref_key:"usernameInput",ref:m,name:"username",required:"",placeholder:"请输入用户名"},null,512),(0,n.Lk)("div",{class:"validation-message",ref_key:"usernameValidation",ref:k},null,512)]),(0,n.Lk)("div",o,[a[1]||(a[1]=(0,n.Lk)("label",{for:"nickname"},"昵称",-1)),(0,n.Lk)("input",{type:"text",id:"nickname",ref_key:"nicknameInput",ref:g,name:"nickname",required:"",placeholder:"请输入昵称"},null,512),(0,n.Lk)("div",{class:"validation-message",ref_key:"nicknameValidation",ref:h},null,512)]),(0,n.Lk)("div",c,[a[2]||(a[2]=(0,n.Lk)("label",{for:"password"},"密码",-1)),(0,n.Lk)("input",{type:"password",id:"password",ref_key:"passwordInput",ref:y,name:"password",required:"",placeholder:"请输入密码"},null,512),(0,n.Lk)("div",{class:"validation-message",ref_key:"passwordValidation",ref:L},null,512),(0,n.Lk)("div",{class:"password-strength",ref_key:"passwordStrength",ref:C},null,512)]),(0,n.Lk)("div",v,[a[3]||(a[3]=(0,n.Lk)("label",{for:"confirmPassword"},"确认密码",-1)),(0,n.Lk)("input",{type:"password",id:"confirmPassword",ref_key:"confirmPasswordInput",ref:w,name:"confirmPassword",required:"",placeholder:"请再次输入密码"},null,512),(0,n.Lk)("div",{class:"validation-message",ref_key:"confirmPasswordValidation",ref:x},null,512)]),(0,n.Lk)("div",d,[a[4]||(a[4]=(0,n.Lk)("label",{for:"captcha"},"验证码",-1)),(0,n.Lk)("div",f,[(0,n.Lk)("input",{type:"text",id:"captcha",ref_key:"captchaInput",ref:R,name:"captcha",required:"",placeholder:"请输入验证码",style:{flex:"1",width:"0"}},null,512),(0,n.Lk)("div",{ref_key:"captchaContainer",ref:N,style:{cursor:"pointer","flex-shrink":"0",width:"120px"}},null,512)])]),(0,n.Lk)("button",{type:"submit",ref_key:"registerButton",ref:_},"注册",512)],512),(0,n.Lk)("p",p,[a[6]||(a[6]=(0,n.eW)("已有账号？",-1)),(0,n.bF)(l,{to:"/login"},{default:(0,n.k6)(()=>[...a[5]||(a[5]=[(0,n.eW)("去登录",-1)])]),_:1})]),(0,n.Lk)("div",{ref_key:"registerMessage",ref:b,class:"register-message",style:{display:"none"}},null,512)])])}}},k=t(1241);const g=(0,k.A)(m,[["__scopeId","data-v-6ea70aad"]]);var h=g}}]);