{"version":3,"file":"js/app.e0617a77.js","mappings":"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","sources":["webpack://vue-chat/./src/utils/toast.js","webpack://vue-chat/./src/utils/chat.js","webpack://vue-chat/./src/components/ChatModal.vue","webpack://vue-chat/./src/components/ChatSidebar.vue","webpack://vue-chat/./src/components/ChatSidebar.vue?2d0c","webpack://vue-chat/./src/components/ChatSecondarySidebar.vue","webpack://vue-chat/./src/components/ChatSecondarySidebar.vue?2c9a","webpack://vue-chat/./src/components/ChatModal.vue?18b3","webpack://vue-chat/./src/App.vue","webpack://vue-chat/./src/App.vue?7ccd","webpack://vue-chat/./src/main.js","webpack://vue-chat/webpack/bootstrap","webpack://vue-chat/webpack/runtime/chunk loaded","webpack://vue-chat/webpack/runtime/compat get default export","webpack://vue-chat/webpack/runtime/define property getters","webpack://vue-chat/webpack/runtime/ensure chunk","webpack://vue-chat/webpack/runtime/get javascript chunk filename","webpack://vue-chat/webpack/runtime/get mini-css chunk filename","webpack://vue-chat/webpack/runtime/global","webpack://vue-chat/webpack/runtime/hasOwnProperty shorthand","webpack://vue-chat/webpack/runtime/load script","webpack://vue-chat/webpack/runtime/make namespace object","webpack://vue-chat/webpack/runtime/publicPath","webpack://vue-chat/webpack/runtime/css loading","webpack://vue-chat/webpack/runtime/jsonp chunk loading","webpack://vue-chat/webpack/startup"],"sourcesContent":["// \n\n// toast\nfunction createToastContainer() {\n  let container = document.getElementById('toast-container');\n  if (!container) {\n    container = document.createElement('div');\n    container.id = 'toast-container';\n    container.style.position = 'fixed';\n    container.style.top = '20px';\n    container.style.right = '20px';\n    container.style.zIndex = '9999';\n    container.style.display = 'flex';\n    container.style.flexDirection = 'column';\n    container.style.alignItems = 'flex-end';\n    container.style.gap = '10px';\n    document.body.appendChild(container);\n  }\n  return container;\n}\n\n// \nfunction showToast(message, type = 'info', duration = 3000) {\n  const container = createToastContainer();\n  \n  const toast = document.createElement('div');\n  toast.className = `toast toast-${type}`;\n  toast.style.padding = '10px 15px';\n  toast.style.borderRadius = '4px';\n  toast.style.color = 'white';\n  toast.style.fontSize = '14px';\n  toast.style.fontWeight = '500';\n  toast.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.15)';\n  toast.style.transition = 'all 0.3s ease';\n  toast.style.transform = 'translateX(100%)';\n  toast.style.opacity = '0';\n  \n  // \n  switch (type) {\n    case 'success':\n      toast.style.backgroundColor = '#52c41a';\n      break;\n    case 'error':\n      toast.style.backgroundColor = '#f5222d';\n      break;\n    case 'warning':\n      toast.style.backgroundColor = '#faad14';\n      break;\n    default:\n      toast.style.backgroundColor = '#1890ff';\n  }\n  \n  toast.textContent = message;\n  container.appendChild(toast);\n  \n  // \n  setTimeout(() => {\n    toast.style.transform = 'translateX(0)';\n    toast.style.opacity = '1';\n  }, 10);\n  \n  // \n  setTimeout(() => {\n    toast.style.transform = 'translateX(100%)';\n    toast.style.opacity = '0';\n    setTimeout(() => {\n      if (toast.parentNode === container) {\n        container.removeChild(toast);\n      }\n    }, 300);\n  }, duration);\n  \n  return toast;\n}\n\n// \nconst toast = {\n  success: (message, duration) => showToast(message, 'success', duration),\n  error: (message, duration) => showToast(message, 'error', duration),\n  warning: (message, duration) => showToast(message, 'warning', duration),\n  info: (message, duration) => showToast(message, 'info', duration)\n};\n\nexport default toast;","/* eslint-disable */\n/*\n * JavaScript\n * UIJS\n * @copyright Copyright (c) 2026 gamerunwuyazi. All rights reserved.\n */\nimport {onMounted} from \"vue\";\nconst marked = require('marked');\nconst io = require('socket.io-client');\nimport toast from \"./toast.js\";\n\n\nconst SERVER_URL = 'https://back.hs.airoe.cn';\n\n// \nexport let sessionStore = {\n    currentGroupId: null,\n    currentGroupName: '',\n    currentPrivateChatUserId: null,\n    currentPrivateChatUsername: '',\n    currentPrivateChatNickname: '',\n    currentPrivateChatAvatarUrl: '',\n    currentActiveChat: 'main',\n    currentSendChatType: 'main',\n    selectedGroupIdForCard: null\n};\n\n// \nlet currentUser = null;\nlet currentSessionToken = localStorage.getItem('currentSessionToken') || null;\n\n// \nwindow.currentUser = currentUser;\nwindow.currentSessionToken = currentSessionToken;\nlet isConnected = false;\nlet currentGroupId = sessionStore.currentGroupId;\nlet currentGroupName = sessionStore.currentGroupName;\nlet currentPrivateChatUserId = sessionStore.currentPrivateChatUserId; // ID\nlet currentPrivateChatUsername = sessionStore.currentPrivateChatUsername; // \nlet currentPrivateChatNickname = sessionStore.currentPrivateChatNickname; // \nlet onlineUsersList = [];\nlet friendsList = []; // \nlet hasReceivedHistory = false; // \nlet hasReceivedGroupHistory = false; // \nlet hasReceivedPrivateHistory = false; // \nlet originalTitle = document.title; // \nlet unreadMessages = { global: 0, groups: {}, private: {} }; // \nlet isPageVisible = true; // \nlet currentActiveChat = sessionStore.currentActiveChat; // 'main'IDID\n// let lastNotificationTime = 0; // \nlet groupMessageCache = {}; // \nlet currentSendChatType = sessionStore.currentSendChatType; // maingroup\nlet selectedGroupIdForCard = sessionStore.selectedGroupIdForCard; // ID\nlet currentSharedGroup = null; // \nlet chatHistory = null;\n\n// \nexport function setCurrentUser(user) {\n    currentUser = user;\n    window.currentUser = user; // \n    if (user) {\n        localStorage.setItem('userId', user.id);\n        localStorage.setItem('nickname', user.nickname);\n        localStorage.setItem('avatarUrl', user.avatarUrl || '');\n    }\n}\n\n// \nexport function setCurrentSessionToken(token) {\n    currentSessionToken = token;\n    window.currentSessionToken = token; // \n    if (token) {\n        localStorage.setItem('sessionToken', token);\n    }\n}\n\n// \nexport function initializeChat() {\n        // \n        if (!currentUser || !currentSessionToken) {\n            // localStorage\n            const userId = localStorage.getItem('chatUserId');\n            const sessionToken = localStorage.getItem('chatSessionToken');\n            const nickname = localStorage.getItem('chatUserNickname');\n            const avatarUrl = localStorage.getItem('chatUserAvatar');\n\n            if (userId && sessionToken) {\n                currentUser = {\n                    id: userId,\n                    nickname: nickname,\n                    avatarUrl: avatarUrl\n                };\n                currentSessionToken = sessionToken;\n                // \n                window.currentUser = currentUser;\n                window.currentSessionToken = currentSessionToken;\n            } else {\n                console.warn('');\n                return;\n            }\n        }\n\n        // \n        try {\n            // \n            if (typeof initializeChatInternal === 'function') {\n                initializeChatInternal();\n            } else {\n                // \n                console.warn('');\n                if (typeof initializeWebSocket === 'function') initializeWebSocket();\n                if (typeof initializeMessageSending === 'function') initializeMessageSending();\n                if (typeof enableMessageSending === 'function') enableMessageSending();\n            }\n            \n            // initializeChat\n            setTimeout(() => {\n                // \n                if (currentPrivateChatUserId) {\n                    console.log(':', {\n                        userId: currentPrivateChatUserId,\n                        username: currentPrivateChatUsername,\n                        nickname: currentPrivateChatNickname,\n                        activeChat: currentActiveChat\n                    });\n                    setActiveChat('private', currentPrivateChatUserId);\n                    // \n                    const privateEmptyState = document.getElementById('privateEmptyState');\n                    const privateChatInterface = document.getElementById('privateChatInterface');\n                    const privateUserName = document.getElementById('privateUserName');\n                    if (privateEmptyState) privateEmptyState.style.display = 'none';\n                    if (privateChatInterface) {\n                        privateChatInterface.style.display = 'flex';\n                        privateChatInterface.style.flexDirection = 'column';\n                    }\n                    if (privateUserName) privateUserName.textContent = currentPrivateChatNickname;\n                    // \n                    loadPrivateChatHistory(currentPrivateChatUserId);\n                }\n            }, 500);\n        } catch (error) {\n            console.error(':', error);\n        }\n}\n\n// \nfunction updateUserAvatar() {\n    const currentUserAvatar = document.getElementById('currentUserAvatar');\n    const userInitials = document.getElementById('userInitials');\n\n    if (!currentUser || !currentUserAvatar || !userInitials) return;\n\n    // URL\n    let avatarUrl = '';\n    if (currentUser.avatar && typeof currentUser.avatar === 'string') {\n        avatarUrl = currentUser.avatar.trim();\n    } else if (currentUser.avatarUrl && typeof currentUser.avatarUrl === 'string') {\n        avatarUrl = currentUser.avatarUrl.trim();\n    }\n\n    // URLSVGSVG XSS\n    const isSvgAvatar = avatarUrl && /\\.svg$/i.test(avatarUrl);\n\n    if (avatarUrl && !isSvgAvatar) {\n        // \n        const fullAvatarUrl = `${SERVER_URL}${avatarUrl}`;\n        currentUserAvatar.src = fullAvatarUrl;\n        currentUserAvatar.style.display = 'block';\n        userInitials.style.display = 'none';\n    } else {\n        // SVG\n        const initials = currentUser.nickname ? currentUser.nickname.charAt(0).toUpperCase() : 'U';\n        userInitials.textContent = initials;\n        userInitials.style.display = 'block';\n        currentUserAvatar.style.display = 'none';\n    }\n}\n\n// \nfunction initializePrivateChatFunctions() {\n    // \n    initializeFriendsListListeners();\n\n    // \n    initializeUserProfileModal();\n\n    // \n    initializeUserSearch();\n\n    // \n    initializePrivateMessageSending();\n\n    // \n    initializePrivateChatInterface();\n}\n\n// \nfunction loadFriendsList() {\n    if (!currentUser || !currentSessionToken) return;\n\n    // fetch API\n    fetch(`${SERVER_URL}/user/friends`, {\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                updateFriendsList(data.friends);\n            } else {\n                const friendsList = document.getElementById('friendsList');\n                if (friendsList) {\n                    friendsList.innerHTML = '<li>: ' + data.message + '</li>';\n                }\n            }\n        })\n        .catch(() => {\n            const friendsList = document.getElementById('friendsList');\n            if (friendsList) {\n                friendsList.innerHTML = '<li>: </li>';\n            }\n        });\n}\n\n// \nfunction updateFriendsList(friends) {\n    const friendsListElement = document.getElementById('friendsList');\n    if (!friendsListElement) return;\n\n    friendsListElement.innerHTML = '';\n\n    // \n    friendsList = friends;\n\n    if (friends.length === 0) {\n        friendsListElement.innerHTML = '<li class=\"empty-friends\"></li>';\n        return;\n    }\n\n    friends.forEach(friend => {\n        const li = document.createElement('li');\n        li.className = 'friend-item';\n        li.dataset.userId = friend.id;\n        li.dataset.userNickname = friend.nickname;\n\n        // URL\n        let avatarUrl = '';\n        if (friend.avatarUrl && typeof friend.avatarUrl === 'string') {\n            avatarUrl = friend.avatarUrl.trim();\n        } else if (friend.avatar_url && typeof friend.avatar_url === 'string') {\n            avatarUrl = friend.avatar_url.trim();\n        }\n\n        // \n        let avatarHtml;\n        if (avatarUrl) {\n            // URLSVGXSS\n            const isSvgAvatar = /\\.svg$/i.test(avatarUrl);\n            if (isSvgAvatar) {\n                // SVG\n                const initials = friend.nickname ? friend.nickname.charAt(0).toUpperCase() : 'U';\n                avatarHtml = `<span class=\"user-avatar\">${initials}</span>`;\n            } else {\n                const fullAvatarUrl = `${SERVER_URL}${avatarUrl}`;\n                avatarHtml = `<span class=\"user-avatar\"><img src=\"${fullAvatarUrl}\" alt=\"${friend.nickname}\"></span>`;\n            }\n        } else {\n            const initials = friend.nickname ? friend.nickname.charAt(0).toUpperCase() : 'U';\n            avatarHtml = `<span class=\"user-avatar\">${initials}</span>`;\n        }\n\n        // \n        const isOnline = onlineUsersList.some(onlineUser => String(onlineUser.id) === String(friend.id));\n\n        // HTML\n        li.innerHTML = `\n            ${avatarHtml}\n            <span class=\"friend-name\">${friend.nickname}</span>\n            <span class=\"friend-status ${isOnline ? 'online' : 'offline'}\"></span>\n            <div class=\"unread-count private-unread-count\" id=\"privateUnreadCount_${friend.id}\"></div>\n        `;\n\n        // \n        li.addEventListener('click', () => {\n            switchToPrivateChat(friend.id, friend.nickname, friend.username, avatarUrl);\n        });\n\n        friendsListElement.appendChild(li);\n    });\n\n    // \n    updateUnreadCountsDisplay();\n\n    // \n    addAvatarClickListeners();\n}\n\n// \nfunction switchToPrivateChat(userId, nickname, username, avatarUrl) {\n    currentPrivateChatUserId = userId;\n    currentPrivateChatUsername = username;\n    currentPrivateChatNickname = nickname;\n    currentActiveChat = `private_${userId}`;\n    \n    // \n    sessionStore.currentPrivateChatUserId = currentPrivateChatUserId;\n    sessionStore.currentPrivateChatUsername = currentPrivateChatUsername;\n    sessionStore.currentPrivateChatNickname = currentPrivateChatNickname;\n    sessionStore.currentPrivateChatAvatarUrl = avatarUrl;\n    sessionStore.currentActiveChat = currentActiveChat;\n    // console.log(':', {\n    //     userId: currentPrivateChatUserId,\n    //     username: currentPrivateChatUsername,\n    //     nickname: currentPrivateChatNickname,\n    //     activeChat: currentActiveChat\n    // });\n\n    // \n    const privateChatInterface = document.getElementById('privateChatInterface');\n    const privateEmptyState = document.getElementById('privateEmptyState');\n    const privateUserName = document.getElementById('privateUserName');\n    const privateUserAvatar = document.getElementById('privateUserAvatar');\n    const privateUserInitials = document.getElementById('privateUserInitials');\n    const privateUserStatus = document.getElementById('privateUserStatus');\n\n    if (privateChatInterface && privateEmptyState && privateUserName && privateUserAvatar && privateUserInitials) {\n        // \n        privateChatInterface.style.display = 'flex';\n        privateChatInterface.style.flexDirection = 'column';\n        privateEmptyState.style.display = 'none';\n\n        // \n        privateUserName.textContent = nickname ? unescapeHtml(nickname) : '';\n\n        // \n        if (avatarUrl) {\n            const fullAvatarUrl = `${SERVER_URL}${avatarUrl}`;\n            privateUserAvatar.src = fullAvatarUrl;\n            privateUserAvatar.style.display = 'block';\n            privateUserAvatar.style.visibility = 'visible'; // \n            privateUserInitials.style.display = 'none';\n            privateUserInitials.style.visibility = 'hidden'; // \n        } else {\n            const initials = nickname ? nickname.charAt(0).toUpperCase() : 'U';\n            privateUserInitials.textContent = initials;\n            privateUserInitials.style.display = 'flex';\n            privateUserInitials.style.visibility = 'visible'; // \n            privateUserAvatar.style.display = 'none';\n            privateUserAvatar.style.visibility = 'hidden'; // \n            privateUserAvatar.src = ''; // src\n        }\n\n        // \n        if (privateUserStatus) {\n            const isOnline = onlineUsersList.some(onlineUser => String(onlineUser.id) === String(userId));\n            privateUserStatus.textContent = isOnline ? '' : '';\n            privateUserStatus.className = `user-status ${isOnline ? 'online' : 'offline'}`;\n        }\n    }\n\n    // \n    loadPrivateChatHistory(userId);\n\n    // \n    setActiveChat('private', userId);\n\n    // \n    initializePrivateChatInterface();\n}\n\n// \nexport function loadPrivateChatHistory(userId) {\n    if (!currentUser || !currentSessionToken) return;\n\n    const privateMessageContainer = document.getElementById('privateMessageContainer');\n    if (privateMessageContainer) {\n        // \n        privateMessageContainer.innerHTML = `\n            <div class=\"loading-messages\">\n                <div class=\"loading-spinner\"></div>\n                <div class=\"loading-text\">...</div>\n            </div>\n        `;\n\n        // \n        if (window.chatSocket) {\n            window.chatSocket.emit('join-private-chat', {\n                userId: currentUser.id,\n                friendId: userId,\n                sessionToken: currentSessionToken\n            });\n        } else {\n            // WebSocket\n            privateMessageContainer.innerHTML = `\n                <div class=\"empty-state error-state\">\n                    <div class=\"error-icon\"></div>\n                    <h3></h3>\n                    <p></p>\n                    <button class=\"retry-button\" onclick=\"loadPrivateChatHistory(${userId})\"></button>\n                </div>\n            `;\n        }\n    }\n}\n\n// \nfunction renderPrivateMessage(message, returnElement = false) {\n    const privateMessageContainer = document.getElementById('privateMessageContainer');\n    if (!privateMessageContainer) return;\n\n    // \n    if (!message) {\n        return;\n    }\n\n    // \n    const msgSenderId = String(message.senderId);\n    const msgReceiverId = String(message.receiverId);\n    const currentChatId = String(currentPrivateChatUserId);\n    if (msgSenderId !== currentChatId && msgReceiverId !== currentChatId) {\n        return;\n    }\n\n    // ID\n    if (document.querySelector(`#privateMessageContainer [data-id=\"${message.id}\"]`)) {\n        return;\n    }\n\n    // \n    const loadingElement = privateMessageContainer.querySelector('.loading-messages');\n    if (loadingElement) {\n        loadingElement.remove();\n    }\n\n    // \n    const emptyElement = privateMessageContainer.querySelector('.empty-state');\n    if (emptyElement) {\n        emptyElement.remove();\n    }\n\n    // contentnull\n    if (!message.messageType && !message.content && !message.imageUrl && !message.fileUrl && !message.text) {\n        return;\n    }\n\n    // userIdnickname\n    const messageUser = {\n        id: message.senderId,\n        nickname: message.senderNickname || message.sender || '',\n        avatarUrl: message.senderAvatarUrl || message.avatarUrl\n    };\n\n    // \n    const senderId = messageUser.id;\n    // const senderNickname = messageUser.nickname;\n    // const senderAvatarUrl = messageUser.avatarUrl;\n    const isOwn = currentUser && String(currentUser.id) === String(senderId);\n\n    // \n    const messageElement = document.createElement('div');\n    // \n    messageElement.className = `message ${isOwn ? 'own-message' : 'other-message'}`;\n    messageElement.setAttribute('data-id', message.id);\n    messageElement.setAttribute('data-user-id', senderId);\n\n    // sequence\n    if (message.sequence !== undefined) {\n        messageElement.setAttribute('data-sequence', message.sequence);\n    }\n\n    // \n    if (isOwn) {\n        messageElement.style.marginLeft = '20%';\n        messageElement.style.marginRight = '10px';\n        messageElement.style.backgroundColor = '#E8F5E8';\n        messageElement.style.borderRadius = '18px';\n        messageElement.style.padding = '10px 15px';\n        messageElement.style.maxWidth = '80%';\n        messageElement.style.minWidth = '70px'; // \n        messageElement.style.alignSelf = 'flex-end';\n        messageElement.style.position = 'relative'; // \n        messageElement.style.transition = 'all 0.2s';\n    } else {\n        messageElement.style.marginLeft = '10px';\n        messageElement.style.marginRight = '20%';\n        messageElement.style.backgroundColor = '#FFFFFF';\n        messageElement.style.borderRadius = '18px';\n        messageElement.style.padding = '10px 15px';\n        messageElement.style.maxWidth = '80%';\n        messageElement.style.minWidth = '70px'; // \n        messageElement.style.alignSelf = 'flex-start';\n        messageElement.style.border = '1px solid #E0E0E0';\n        messageElement.style.position = 'relative'; // \n    }\n    messageElement.style.display = 'flex';\n    messageElement.style.flexDirection = 'column';\n    messageElement.style.marginBottom = '10px';\n\n\n\n    // HTMLXSS\n    function escapeHtml(text) {\n        if (typeof text !== 'string') return text;\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n\n    // HTML\n    let messageHtml = '';\n\n    // \n    const timeString = new Date(message.timestampISO || message.created_at || message.timestamp).toLocaleTimeString();\n\n    // \n    if (!isOwn) {\n        // \n        messageHtml += `<div class=\"message-header\" style=\"display: flex; justify-content: flex-start; margin-bottom: 5px;\">`;\n        messageHtml += `<span class=\"message-time\" style=\"color: #999; font-size: 12px;\">${timeString}</span>`;\n        messageHtml += `</div>`;\n    } else {\n        // \n        messageHtml += `<div class=\"message-header\" style=\"display: flex; justify-content: flex-end; margin-bottom: 5px;\">`;\n        messageHtml += `<span class=\"message-time\" style=\"color: #999; font-size: 12px;\">${timeString}</span>`;\n        messageHtml += `</div>`;\n    }\n\n    // \n    messageElement.style.minWidth = \"70px\";\n\n    // \n    messageHtml += `<div class=\"message-content\">`;\n\n    // \n    switch (message.messageType) {\n        case 1: // \n            if (message.imageUrl) {\n                // imageUrl\n                const fullImageUrl = message.imageUrl.startsWith('http') ? message.imageUrl : `${SERVER_URL}${message.imageUrl}`;\n                // \n                let widthAttr = '';\n                let heightAttr = '';\n                if (message.width && message.height) {\n                    widthAttr = `width=\"${message.width}\"`;\n                    heightAttr = `height=\"${message.height}\"`;\n                }\n                messageHtml += `<img src=\"${fullImageUrl}\" alt=\"\" ${widthAttr} ${heightAttr} class=\"message-image\" onclick=\"openImagePreview('${fullImageUrl}')\" style=\"max-width: 100%; height: auto; border-radius: 10px; cursor: pointer;\">`;\n            } else {\n                try {\n                    // content\n                    const imageData = JSON.parse(message.content);\n                    if (imageData && imageData.url) {\n                        const fullImageUrl = imageData.url.startsWith('http') ? imageData.url : `${SERVER_URL}${imageData.url}`;\n                        // \n                        let widthAttr = '';\n                        let heightAttr = '';\n                        if (imageData.width && imageData.height) {\n                            widthAttr = `width=\"${imageData.width}\"`;\n                            heightAttr = `height=\"${imageData.height}\"`;\n                        }\n                        messageHtml += `<img src=\"${fullImageUrl}\" alt=\"\" ${widthAttr} ${heightAttr} class=\"message-image\" onclick=\"openImagePreview('${fullImageUrl}')\" style=\"max-width: 100%; height: auto; border-radius: 10px; cursor: pointer;\">`;\n                    }\n                } catch (error) {\n                    // \n                    messageHtml += `<div class=\"message-text\">${escapeHtml(message.content)}</div>`;\n                }\n            }\n            break;\n\n        case 2: // \n            if (message.fileUrl) {\n                // fileUrl\n                const fullFileUrl = message.fileUrl.startsWith('http') ? message.fileUrl : `${SERVER_URL}${message.fileUrl}`;\n                messageHtml += `<div class=\"file-link-container\" style=\"display: flex; align-items: center; gap: 10px; padding: 10px; background: #f5f5f5; border-radius: 8px;\">`;\n                messageHtml += `<span class=\"file-icon\" style=\"font-size: 20px;\"></span>`;\n                messageHtml += `<a href=\"${fullFileUrl}\" target=\"_blank\" class=\"message-link\" style=\"text-decoration: none; color: #0d6efd; word-break: break-all;\">${message.fileName || ''}</a>`;\n                if (message.fileSize) {\n                    messageHtml += `<span class=\"file-size\" style=\"color: #666; font-size: 12px;\">(${formatFileSize(message.fileSize)})</span>`;\n                }\n                messageHtml += `</div>`;\n            } else {\n                try {\n                    // content\n                    const fileData = JSON.parse(message.content);\n                    if (fileData && fileData.url && fileData.name) {\n                        const fullFileUrl = fileData.url.startsWith('http') ? fileData.url : `${SERVER_URL}${fileData.url}`;\n                        messageHtml += `<div class=\"file-link-container\" style=\"display: flex; align-items: center; gap: 10px; padding: 10px; background: #f5f5f5; border-radius: 8px;\">`;\n                        messageHtml += `<span class=\"file-icon\" style=\"font-size: 20px;\"></span>`;\n                        messageHtml += `<a href=\"${fullFileUrl}\" target=\"_blank\" class=\"message-link\" style=\"text-decoration: none; color: #0d6efd; word-break: break-all;\">${fileData.name}</a>`;\n                        if (fileData.size) {\n                            messageHtml += `<span class=\"file-size\" style=\"color: #666; font-size: 12px;\">(${formatFileSize(fileData.size)})</span>`;\n                        }\n                        messageHtml += `</div>`;\n                    }\n                } catch (error) {\n                    // \n                    messageHtml += `<div class=\"message-text\">${escapeHtml(message.content)}</div>`;\n                }\n            }\n            break;\n\n        case 3: // \n            {\n                // \n                try {\n                    const groupCardData = JSON.parse(message.content);\n                    messageHtml += `\n                        <div class=\"group-card-container\" style=\"background-color: #f0f8ff; border: 1px solid #3498db; border-radius: 8px; padding: 10px; cursor: pointer; margin-top: 5px;\">\n                            <div class=\"group-card-header\" style=\"font-weight: bold; color: #3498db; margin-bottom: 5px; display: flex; align-items: center; gap: 8px;\">\n                                ${groupCardData.avatar_url ? `<img src=\"${SERVER_URL}${groupCardData.avatar_url}\" alt=\"${groupCardData.group_name}\" style=\"width: 20px; height: 20px; border-radius: 50%; object-fit: cover; cursor: pointer;\">` : `<div style=\"width: 20px; height: 20px; border-radius: 50%; background-color: #3498db; color: white; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold;\">${groupCardData.group_name.charAt(0).toUpperCase()}</div>`}\n                                ${escapeHtml(groupCardData.group_name)}\n                            </div>\n                            <div class=\"group-card-description\" style=\"color: #666; font-size: 14px; margin-bottom: 5px;\">\n                                ${groupCardData.group_description || ''}\n                            </div>\n                            <div class=\"group-card-footer\" style=\"font-size: 12px; color: #999;\">\n                                \n                            </div>\n                        </div>\n                    `;\n                } catch (error) {\n                    // \n                    messageHtml += `<div class=\"message-text\">${escapeHtml(message.content)}</div>`;\n                }\n            }\n            break;\n\n        default: // \n            {\n                // Markdown\n                let content = message.content || message.text || '';\n                // \n                content = escapeHtml(content);\n                // marked\n                if (window.marked && typeof window.marked.parse === 'function') {\n                    try {\n                        // marked\n                        window.marked.setOptions({\n                            breaks: true,\n                            gfm: true\n                        });\n                        content = window.marked.parse(content);\n                    } catch (e) {\n                        // \n                        content = escapeHtml(content);\n                    }\n                } else {\n                    // marked\n                    content = escapeHtml(content);\n                }\n                messageHtml += `<div class=\"message-text\" style=\"word-break: break-word;\">${content}</div>`;\n            }\n            break;\n    }\n\n    messageHtml += `</div>`;\n\n    // \n    if (isOwn) {\n        messageHtml += `<button class=\"message-action-button withdraw-button\" onclick=\"withdrawPrivateMessage(${message.id})\" style=\"position: absolute; top: 8px; right: 8px; background: transparent; border: none; color: #666; font-size: 16px; cursor: pointer; padding: 0; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; border-radius: 50%; opacity: 1;\"></button>`;\n    }\n\n    messageElement.innerHTML = messageHtml;\n\n    // \n    if (message.messageType === 3) {\n        const groupCardElement = messageElement.querySelector('.group-card-container');\n        if (groupCardElement) {\n            try {\n                const groupCardData = JSON.parse(message.content);\n                groupCardElement.addEventListener('click', function(e) {\n                    e.stopPropagation();\n                    // \n                    showGroupCardPopup(e, groupCardData);\n                });\n            } catch (error) {\n                console.error(':', error);\n            }\n        }\n    }\n\n    if (returnElement) {\n        // \n        return messageElement;\n    } else {\n        // \n        privateMessageContainer.appendChild(messageElement);\n\n        // \n        privateMessageContainer.scrollTop = privateMessageContainer.scrollHeight;\n    }\n}\n\n// \nfunction formatFileSize(bytes) {\n    if (bytes < 1024) {\n        return bytes + ' B';\n    } else if (bytes < 1048576) {\n        return (bytes / 1024).toFixed(2) + ' KB';\n    } else if (bytes < 1073741824) {\n        return (bytes / 1048576).toFixed(2) + ' MB';\n    } else {\n        return (bytes / 1073741824).toFixed(2) + ' GB';\n    }\n}\n\n\n\n//  - HTML\nwindow.withdrawPrivateMessage = function(messageId) {\n    if (!currentUser || !currentSessionToken) return;\n\n    // \n    if (window.chatSocket) {\n        window.chatSocket.emit('withdraw-private-message', {\n            userId: currentUser.id,\n            messageId: messageId,\n            sessionToken: currentSessionToken\n        });\n    }\n}\n\n// \nfunction uploadPrivateImage(file) {\n    if (!currentUser || !currentSessionToken || !currentPrivateChatUserId) return;\n\n    // \n    const isFriend = friendsList.some(friend => String(friend.id) === String(currentPrivateChatUserId));\n    if (!isFriend) {\n        toast.error('');\n        return;\n    }\n\n    const formData = new FormData();\n    formData.append('image', file);\n    formData.append('userId', currentUser.id);\n    formData.append('privateChat', true); // URL\n\n    // \n    const uploadProgress = document.getElementById('privateUploadProgress');\n    const uploadProgressBar = document.getElementById('privateUploadProgressBar');\n    if (uploadProgress && uploadProgressBar) {\n        uploadProgress.style.display = 'block';\n        uploadProgressBar.style.width = '0%';\n    }\n\n    // \n    fetch(`${SERVER_URL}/upload`, {\n        method: 'POST',\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: formData\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                // \n                const messageData = {\n                    userId: currentUser.id,\n                    content: JSON.stringify({ url: data.url, name: file.name }),\n                    receiverId: currentPrivateChatUserId,\n                    sessionToken: currentSessionToken,\n                    messageType: 1 // 1\n                };\n\n                // \n                if (window.chatSocket) {\n                    window.chatSocket.emit('private-message', messageData);\n                }\n            } else {\n                showError(data.message || '');\n            }\n        })\n        .catch(() => {\n            showError('');\n        })\n        .finally(() => {\n            // \n            if (uploadProgress) {\n                uploadProgress.style.display = 'none';\n            }\n            // \n            const privateImageInput = document.getElementById('privateImageInput');\n            if (privateImageInput) {\n                privateImageInput.value = '';\n            }\n        });\n}\n\n// \nfunction uploadPrivateFile(file) {\n    if (!currentUser || !currentSessionToken || !currentPrivateChatUserId) return;\n\n    // \n    const isFriend = friendsList.some(friend => String(friend.id) === String(currentPrivateChatUserId));\n    if (!isFriend) {\n        toast.error('');\n        return;\n    }\n\n    const formData = new FormData();\n    formData.append('image', file); // \n    formData.append('userId', currentUser.id);\n    formData.append('privateChat', true); // URL\n\n    // \n    const uploadProgress = document.getElementById('privateUploadProgress');\n    const uploadProgressBar = document.getElementById('privateUploadProgressBar');\n    if (uploadProgress && uploadProgressBar) {\n        uploadProgress.style.display = 'block';\n        uploadProgressBar.style.width = '0%';\n    }\n\n    // \n    fetch(`${SERVER_URL}/upload`, {\n        method: 'POST',\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: formData\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                // \n                const messageData = {\n                    userId: currentUser.id,\n                    content: JSON.stringify({ url: data.url, name: file.name, size: file.size }),\n                    receiverId: currentPrivateChatUserId,\n                    sessionToken: currentSessionToken,\n                    messageType: 2 // 2\n                };\n\n                // \n                if (window.chatSocket) {\n                    window.chatSocket.emit('private-message', messageData);\n                }\n            } else {\n                showError(data.message || '');\n            }\n        })\n        .catch(() => {\n            showError('');\n        })\n        .finally(() => {\n            // \n            if (uploadProgress) {\n                uploadProgress.style.display = 'none';\n            }\n            // \n            const privateFileInput = document.getElementById('privateFileInput');\n            if (privateFileInput) {\n                privateFileInput.value = '';\n            }\n        });\n}\n\n// \nfunction initializeFriendsListListeners() {\n    // \n    const privateChatSearchInput = document.getElementById('privateChatSearchInput');\n    const clearPrivateChatSearch = document.getElementById('clearPrivateChatSearch');\n\n    if (privateChatSearchInput && clearPrivateChatSearch) {\n        privateChatSearchInput.addEventListener('input', () => {\n            const keyword = privateChatSearchInput.value.toLowerCase();\n            const friendItems = document.querySelectorAll('.friend-item');\n\n            friendItems.forEach(item => {\n                const friendName = item.dataset.userNickname.toLowerCase();\n                if (friendName.includes(keyword)) {\n                    item.style.display = 'flex';\n                } else {\n                    item.style.display = 'none';\n                }\n            });\n\n            // \n            if (keyword) {\n                clearPrivateChatSearch.style.display = 'inline';\n            } else {\n                clearPrivateChatSearch.style.display = 'none';\n            }\n        });\n\n        clearPrivateChatSearch.addEventListener('click', () => {\n            privateChatSearchInput.value = '';\n            clearPrivateChatSearch.style.display = 'none';\n            const friendItems = document.querySelectorAll('.friend-item');\n            friendItems.forEach(item => {\n                item.style.display = 'flex';\n            });\n        });\n    }\n\n    // \n    const searchUserButton = document.getElementById('searchUserButton');\n    if (searchUserButton) {\n        searchUserButton.addEventListener('click', () => {\n            document.getElementById('userSearchModal').style.display = 'flex';\n        });\n    }\n}\n\n// \nexport function initializeUserProfileModal() {\n    // \n    const closeUserProfileModal = document.getElementById('closeUserProfileModal');\n    const closeUserProfileButton = document.getElementById('closeUserProfileButton');\n\n    if (closeUserProfileModal) {\n        closeUserProfileModal.addEventListener('click', () => {\n            document.getElementById('userProfileModal').style.display = 'none';\n        });\n    }\n\n    if (closeUserProfileButton) {\n        closeUserProfileButton.addEventListener('click', () => {\n            document.getElementById('userProfileModal').style.display = 'none';\n        });\n    }\n\n\n}\n\n// \nfunction initializeUserSearch() {\n    // \n    const closeUserSearchModal = document.getElementById('closeUserSearchModal');\n    const cancelUserSearch = document.getElementById('cancelUserSearch');\n\n    if (closeUserSearchModal) {\n        closeUserSearchModal.addEventListener('click', () => {\n            document.getElementById('userSearchModal').style.display = 'none';\n        });\n    }\n\n    if (cancelUserSearch) {\n        cancelUserSearch.addEventListener('click', () => {\n            document.getElementById('userSearchModal').style.display = 'none';\n        });\n    }\n\n    // \n    const confirmUserSearch = document.getElementById('confirmUserSearch');\n    if (confirmUserSearch) {\n        confirmUserSearch.addEventListener('click', () => {\n            const searchKeyword = document.getElementById('searchKeyword').value;\n            if (searchKeyword.trim()) {\n                searchUsers(searchKeyword.trim());\n            }\n        });\n    }\n}\n\n// \nfunction searchUsers(keyword) {\n    if (!currentUser || !currentSessionToken) return;\n\n    // fetch API\n    fetch(`${SERVER_URL}/user/search?keyword=${encodeURIComponent(keyword)}`, {\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                displaySearchResults(data.users);\n            } else {\n                const searchResults = document.getElementById('searchResults');\n                if (searchResults) {\n                    searchResults.innerHTML = '<div class=\"search-result-item\">: ' + data.message + '</div>';\n                }\n            }\n        })\n        .catch(() => {\n            const searchResults = document.getElementById('searchResults');\n            if (searchResults) {\n                searchResults.innerHTML = '<div class=\"search-result-item\">: </div>';\n            }\n        });\n}\n\n// \nfunction displaySearchResults(users) {\n    const searchResults = document.getElementById('searchResults');\n    if (!searchResults) return;\n\n    searchResults.innerHTML = '';\n\n    if (users.length === 0) {\n        searchResults.innerHTML = '<div class=\"search-result-item\"></div>';\n        return;\n    }\n\n    users.forEach(user => {\n        const resultItem = document.createElement('div');\n        resultItem.className = 'search-result-item';\n\n        // URL\n        let avatarUrl = '';\n        if (user.avatarUrl && typeof user.avatarUrl === 'string') {\n            avatarUrl = user.avatarUrl.trim();\n        } else if (user.avatar_url && typeof user.avatar_url === 'string') {\n            avatarUrl = user.avatar_url.trim();\n        } else if (user.avatar && typeof user.avatar === 'string') {\n            avatarUrl = user.avatar.trim();\n        }\n\n        // avatarUrlURL\n        if (avatarUrl) {\n            const imageExtensions = /\\.(jpg|jpeg|png|gif|webp|bmp)$/i;\n            if (!avatarUrl.match(imageExtensions) && !avatarUrl.includes('/avatar/') && !avatarUrl.includes('/upload/')) {\n                // URL\n                avatarUrl = '';\n            }\n        }\n\n        // avatarUrlURL\n        if (avatarUrl) {\n            const imageExtensions = /\\.(jpg|jpeg|png|gif|webp|bmp)$/i;\n            if (!avatarUrl.match(imageExtensions) && !avatarUrl.includes('/avatar/') && !avatarUrl.includes('/upload/')) {\n                // URL\n                avatarUrl = '';\n            }\n        }\n\n        // URLSVGXSS\n        // const isSvgAvatar = /\\.svg$/i.test(avatarUrl);\n\n        // \n        let avatarHtml = '';\n        if (avatarUrl) {\n            const isSvgAvatar = /\\.svg$/i.test(avatarUrl);\n            if (isSvgAvatar) {\n                const initials = user.nickname ? user.nickname.charAt(0).toUpperCase() : 'U';\n                avatarHtml = `<span class=\"user-avatar\">${initials}</span>`;\n            } else {\n                const fullAvatarUrl = `${SERVER_URL}${avatarUrl}`;\n                avatarHtml = `<span class=\"user-avatar\"><img src=\"${fullAvatarUrl}\" alt=\"${user.nickname}\"></span>`;\n            }\n        } else {\n            const initials = user.nickname ? user.nickname.charAt(0).toUpperCase() : 'U';\n            avatarHtml = `<span class=\"user-avatar\">${initials}</span>`;\n        }\n\n        // HTML\n        resultItem.innerHTML = `\n            ${avatarHtml}\n            <div class=\"search-result-info\">\n                <div class=\"search-result-nickname\">${user.nickname}</div>\n                <div class=\"search-result-username\">@${user.username}</div>\n            </div>\n            <button class=\"add-friend-btn\" data-user-id=\"${user.id}\" data-user-nickname=\"${user.nickname}\" data-user-avatar=\"${avatarUrl}\">+</button>\n        `;\n\n        // \n        const addFriendBtn = resultItem.querySelector('.add-friend-btn');\n        addFriendBtn.addEventListener('click', () => {\n            addFriend(user.id);\n        });\n\n        // \n        const resultAvatar = resultItem.querySelector('.user-avatar');\n        resultAvatar.addEventListener('click', (e) => {\n            e.stopPropagation();\n            showUserAvatarPopup(e, user);\n        });\n\n        // \n        resultItem.addEventListener('click', (e) => {\n            if (!e.target.classList.contains('add-friend-btn') && !e.target.closest('.user-avatar')) {\n                showUserProfile(user);\n            }\n        });\n\n        searchResults.appendChild(resultItem);\n    });\n}\n\n// \nfunction showUserProfile(user) {\n    const userProfileModal = document.getElementById('userProfileModal');\n    const modalUserAvatar = document.getElementById('modalUserAvatar');\n    const modalUserInitials = document.getElementById('modalUserInitials');\n    const modalUserNickname = document.getElementById('modalUserNickname');\n    const modalUsername = document.getElementById('modalUsername');\n    const modalUserId = document.getElementById('modalUserId');\n    const modalUserStatus = document.getElementById('modalUserStatus');\n\n    if (!userProfileModal || !modalUserAvatar || !modalUserInitials || !modalUserNickname || !modalUsername || !modalUserId || !modalUserStatus) return;\n\n    // URL\n    let avatarUrl = '';\n    if (user.avatarUrl && typeof user.avatarUrl === 'string') {\n        avatarUrl = user.avatarUrl.trim();\n    } else if (user.avatar_url && typeof user.avatar_url === 'string') {\n        avatarUrl = user.avatar_url.trim();\n    } else if (user.avatar && typeof user.avatar === 'string') {\n        avatarUrl = user.avatar.trim();\n    }\n\n    // avatarUrlURL\n    if (avatarUrl) {\n        const imageExtensions = /\\.(jpg|jpeg|png|gif|webp|bmp)$/i;\n        if (!avatarUrl.match(imageExtensions) && !avatarUrl.includes('/avatar/') && !avatarUrl.includes('/upload/')) {\n            // URL\n            avatarUrl = '';\n        }\n    }\n\n    // URLSVGXSS\n    const isSvgAvatar = /\\.svg$/i.test(avatarUrl);\n\n    // \n    if (avatarUrl && !isSvgAvatar) {\n        let fullAvatarUrl = '';\n        // URLSERVER_URL\n        if (avatarUrl.startsWith('http://') || avatarUrl.startsWith('https://')) {\n            fullAvatarUrl = avatarUrl;\n        } else {\n            fullAvatarUrl = `${SERVER_URL}${avatarUrl}`;\n        }\n        modalUserAvatar.src = fullAvatarUrl;\n        modalUserAvatar.style.display = 'block';\n        modalUserAvatar.style.width = '120px'; // \n        modalUserAvatar.style.height = '120px'; // \n        modalUserAvatar.style.visibility = 'visible'; // \n        modalUserInitials.style.display = 'none';\n        modalUserInitials.style.visibility = 'hidden'; // \n    } else {\n        // \n        const initials = user.nickname ? user.nickname.charAt(0).toUpperCase() : 'U';\n        modalUserInitials.textContent = initials;\n        modalUserInitials.style.display = 'flex';\n        modalUserInitials.style.alignItems = 'center';\n        modalUserInitials.style.justifyContent = 'center';\n        modalUserInitials.style.width = '80px'; // \n        modalUserInitials.style.height = '80px'; // \n        modalUserInitials.style.fontSize = '32px'; // \n        modalUserInitials.style.borderRadius = '50%'; // \n        modalUserInitials.style.backgroundColor = '#f0f0f0'; // \n        modalUserInitials.style.color = '#333'; // \n        modalUserInitials.style.border = '2px solid #e0e0e0'; // \n        modalUserInitials.style.visibility = 'visible'; // \n        modalUserInitials.style.position = 'relative'; // \n        modalUserInitials.style.zIndex = '1'; // \n\n        // \n        modalUserAvatar.style.display = 'none';\n        modalUserAvatar.style.visibility = 'hidden'; // \n        modalUserAvatar.src = ''; // srcalt\n    }\n\n    // \n    modalUserNickname.textContent = user.nickname ? unescapeHtml(user.nickname) : '';\n    // modalUsername\n    const username = user.username || user.name || '';\n    modalUsername.textContent = typeof username === 'string' ? unescapeHtml(username) : username;\n    modalUserId.textContent = user.id;\n\n    // \n    const isOnline = onlineUsersList.some(onlineUser => String(onlineUser.id) === String(user.id));\n    modalUserStatus.textContent = isOnline ? '' : '';\n\n    // \n    userProfileModal.style.display = 'flex';\n\n    // \n    const modalContent = userProfileModal.querySelector('.modal-content');\n    if (modalContent) {\n        modalContent.addEventListener('click', (e) => {\n            e.stopPropagation();\n        });\n    }\n\n    // \n    userProfileModal.addEventListener('click', () => {\n        userProfileModal.style.display = 'none';\n    });\n}\n\n// \nfunction showUserAvatarPopup(event, user) {\n    event.stopPropagation();\n\n    const popup = document.getElementById('userAvatarPopup');\n    const popupAvatarImg = document.getElementById('popupAvatarImg');\n    const popupInitials = document.getElementById('popupInitials');\n    const popupNickname = document.getElementById('popupNickname');\n    const popupUsername = document.getElementById('popupUsername');\n    const popupAddFriend = document.getElementById('popupAddFriend');\n\n    if (!popup || !popupAvatarImg || !popupInitials || !popupNickname || !popupUsername || !popupAddFriend) return;\n\n    // \n    popup.style.display = 'none';\n\n    // ID\n    popup.dataset.userId = user.id;\n\n    // \n    const isFriend = friendsList.some(friend => String(friend.id) === String(user.id));\n    const isCurrentUser = currentUser && String(currentUser.id) === String(user.id);\n\n    // \n    if (isFriend || isCurrentUser) {\n        popupAddFriend.textContent = '';\n        popupAddFriend.style.backgroundColor = '#ccc';\n        popupAddFriend.style.cursor = 'not-allowed';\n        popupAddFriend.disabled = true;\n        popupAddFriend.onclick = null;\n    } else {\n        popupAddFriend.textContent = '';\n        popupAddFriend.style.backgroundColor = '#3498db';\n        popupAddFriend.style.cursor = 'pointer';\n        popupAddFriend.disabled = false;\n        popupAddFriend.onclick = function() {\n            addFriend(user.id);\n            hideUserAvatarPopup();\n        };\n    }\n\n    // \n    const fetchUserInfo = () => {\n        return fetch(`${SERVER_URL}/user/${user.id}`, {\n            headers: {\n                'user-id': currentUser.id,\n                'session-token': currentSessionToken\n            }\n        })\n            .then(response => response.json())\n            .then(data => {\n                if (data.status === 'success') {\n                    return data.user;\n                }\n                throw new Error('');\n            })\n            .catch(error => {\n                console.error(':', error);\n                return null;\n            });\n    };\n\n    // \n    if (user.id && user.username) {\n        // \n        displayPopup(user);\n    } else {\n        // \n        fetchUserInfo().then(fullUser => {\n            if (fullUser) {\n                displayPopup(fullUser);\n            } else {\n                // \n                displayPopup(user);\n            }\n        });\n    }\n\n    // \n    function displayPopup(displayUser) {\n        // \n        popupNickname.textContent = displayUser.nickname || '';\n\n        if (displayUser.username) {\n            popupUsername.textContent = displayUser.username;\n            popupUsername.style.display = 'block';\n        } else {\n            popupUsername.textContent = '';\n            popupUsername.style.display = 'none';\n        }\n\n        // URL\n        let avatarUrl = '';\n        if (displayUser.avatarUrl && typeof displayUser.avatarUrl === 'string') {\n            avatarUrl = displayUser.avatarUrl.trim();\n        } else if (displayUser.avatar_url && typeof displayUser.avatar_url === 'string') {\n            avatarUrl = displayUser.avatar_url.trim();\n        } else if (displayUser.avatar && typeof displayUser.avatar === 'string') {\n            avatarUrl = displayUser.avatar.trim();\n        }\n\n        // \n        if (avatarUrl) {\n            const fullAvatarUrl = `${SERVER_URL}${avatarUrl}`;\n            popupAvatarImg.src = fullAvatarUrl;\n            popupAvatarImg.style.display = 'block';\n            popupAvatarImg.style.cursor = 'pointer';\n            popupAvatarImg.addEventListener('click', function() {\n                openImagePreview(popupAvatarImg.src);\n            });\n            popupInitials.style.display = 'none';\n        } else {\n            const initials = displayUser.nickname ? displayUser.nickname.charAt(0).toUpperCase() : 'U';\n            popupInitials.textContent = initials;\n            popupInitials.style.display = 'block';\n            popupAvatarImg.style.display = 'none';\n        }\n\n        // \n        popup.style.display = 'block';\n\n        // \n        const popupRect = popup.getBoundingClientRect();\n        const popupWidth = popupRect.width;\n        const popupHeight = popupRect.height;\n\n        // \n        let left = event.clientX + window.scrollX;\n        let top = event.clientY + window.scrollY;\n\n        // \n        if (left + popupWidth > window.innerWidth + window.scrollX) {\n            left = window.innerWidth + window.scrollX - popupWidth - 10;\n        }\n\n        // \n        if (top + popupHeight > window.innerHeight + window.scrollY) {\n            top = window.innerHeight + window.scrollY - popupHeight - 10;\n        }\n\n        // \n        if (left < window.scrollX) {\n            left = window.scrollX + 10;\n        }\n\n        // \n        if (top < window.scrollY) {\n            top = window.scrollY + 10;\n        }\n\n        // \n        popup.style.left = `${left}px`;\n        popup.style.top = `${top}px`;\n\n        // \n        setTimeout(() => {\n            document.addEventListener('click', hideUserAvatarPopup);\n        }, 0);\n    }\n}\n\n// \nfunction hideUserAvatarPopup() {\n    const popup = document.getElementById('userAvatarPopup');\n    if (popup) {\n        popup.style.display = 'none';\n    }\n\n    // \n    document.removeEventListener('click', hideUserAvatarPopup);\n}\n\n// \nfunction addAvatarClickListeners() {\n\n    // \n    const friendAvatars = document.querySelectorAll('.friend-item .user-avatar');\n    friendAvatars.forEach((avatar, index) => {\n        avatar.addEventListener('click', (event) => {\n            const friend = friendsList[index];\n            if (friend) {\n                showUserAvatarPopup(event, friend);\n            }\n        });\n    });\n\n    // \n    const onlineUserAvatars = document.querySelectorAll('#userList .user-avatar');\n    onlineUserAvatars.forEach((avatar, index) => {\n        avatar.addEventListener('click', (event) => {\n            const user = onlineUsersList[index];\n            if (user) {\n                showUserAvatarPopup(event, user);\n            }\n        });\n    });\n\n    // \n    const offlineUserAvatars = document.querySelectorAll('#offlineUserList .user-avatar');\n    offlineUserAvatars.forEach((avatar, index) => {\n        // \n        const offlineUserList = document.querySelectorAll('#offlineUserList .user-item');\n        const userNickname = offlineUserList[index].querySelector('.user-name').textContent;\n\n        // \n        const user = {\n            id: offlineUserList[index].dataset.userId || '',\n            nickname: userNickname,\n            avatarUrl: ''\n        };\n\n        avatar.addEventListener('click', (event) => {\n            showUserAvatarPopup(event, user);\n        });\n    });\n}\n\n// \nfunction addFriend(userId) {\n    if (!currentUser || !currentSessionToken) return;\n\n    // fetch API\n    fetch(`${SERVER_URL}/user/add-friend`, {\n        method: 'POST',\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken,\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ friendId: userId })\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                // \n                loadFriendsList();\n                toast.success('');\n            } else {\n                toast.error(': ' + data.message);\n            }\n        })\n        .catch(error => {\n            toast.error(': ');\n        });\n}\n\n// \nexport function initializePrivateMessageSending() {\n    // \n    const sendPrivateMessageButton = document.getElementById('sendPrivateMessage');\n    if (sendPrivateMessageButton) {\n        sendPrivateMessageButton.addEventListener('click', () => {\n            sendPrivateMessage();\n        });\n    }\n\n    // \n    const privateMessageInput = document.getElementById('privateMessageInput');\n    if (privateMessageInput) {\n        privateMessageInput.addEventListener('keydown', (e) => {\n            // Enter\n            if (e.key === 'Enter' && !e.shiftKey && !e.ctrlKey) {\n                e.preventDefault();\n                sendPrivateMessage();\n            }\n            // Ctrl+Enter\n            else if (e.key === 'Enter' && e.ctrlKey && !e.shiftKey) {\n                e.preventDefault();\n                \n                // \n                if (privateMessageInput.tagName === 'DIV' && privateMessageInput.isContentEditable) {\n                    // divSelection API\n                    const selection = window.getSelection();\n                    const range = selection.getRangeAt(0);\n                    \n                    // \n                    const br = document.createElement('br');\n                    \n                    // \n                    range.deleteContents();\n                    \n                    // \n                    range.insertNode(br);\n                    \n                    // \n                    range.setStartAfter(br);\n                    range.setEndAfter(br);\n                    \n                    // \n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                } else {\n                    // textarea\n                    const start = privateMessageInput.selectionStart;\n                    const end = privateMessageInput.selectionEnd;\n                    \n                    // \n                    const value = privateMessageInput.value;\n                    privateMessageInput.value = value.substring(0, start) + '\\n' + value.substring(end);\n                    \n                    // \n                    const newPosition = start + 1;\n                    privateMessageInput.setSelectionRange(newPosition, newPosition);\n                    \n                    // \n                    privateMessageInput.focus();\n                }\n            }\n            // Shift+Enter\n            else if (e.key === 'Enter' && e.shiftKey && !e.ctrlKey) {\n                // \n            }\n        });\n    }\n\n    // Markdown\n    const markdownToolbar = document.getElementById('privateMarkdownToolbar');\n    if (markdownToolbar) {\n        const markdownButtons = markdownToolbar.querySelectorAll('.markdown-btn');\n        markdownButtons.forEach(button => {\n            button.addEventListener('click', function(e) {\n                // \n                e.stopPropagation();\n\n                const prefix = button.getAttribute('data-prefix') || '';\n                const suffix = button.getAttribute('data-suffix') || '';\n                const sample = button.getAttribute('data-sample') || '';\n\n                // Markdown\n                insertMarkdownFormat(prefix, suffix, sample);\n            });\n        });\n    }\n\n    // \n    const privateImageUploadButton = document.getElementById('privateImageUploadButton');\n    const privateImageInput = document.getElementById('privateImageInput');\n    if (privateImageUploadButton && privateImageInput) {\n        // \n        privateImageUploadButton.onclick = null;\n        privateImageInput.onchange = null;\n\n        privateImageUploadButton.onclick = () => {\n            privateImageInput.click();\n        };\n\n        privateImageInput.onchange = function() {\n            if (this.files && this.files[0]) {\n                uploadPrivateImage(this.files[0]);\n            }\n        };\n    }\n\n    // \n    const privateFileUploadButton = document.getElementById('privateFileUploadButton');\n    const privateFileInput = document.getElementById('privateFileInput');\n    if (privateFileUploadButton && privateFileInput) {\n        // \n        privateFileUploadButton.onclick = null;\n        privateFileInput.onchange = null;\n\n        privateFileUploadButton.onclick = () => {\n            privateFileInput.click();\n        };\n\n        privateFileInput.onchange = function() {\n            if (this.files && this.files[0]) {\n                // \n                if (this.files[0].type.startsWith('image/')) {\n                    uploadPrivateImage(this.files[0]);\n                } else {\n                    uploadPrivateFile(this.files[0]);\n                }\n            }\n        };\n    }\n\n    // \n    // const privateMessageInput = document.getElementById('privateMessageInput');\n    if (privateMessageInput) {\n        privateMessageInput.addEventListener('paste', function(e) {\n            const items = e.clipboardData.items;\n            for (const item of items) {\n                if (item.type.startsWith('image/')) {\n                    e.preventDefault();\n                    const file = item.getAsFile();\n                    if (file) {\n                        uploadPrivateImage(file);\n                    }\n                    break;\n                } else if (item.type === 'application/octet-stream') {\n                    e.preventDefault();\n                    const file = item.getAsFile();\n                    if (file) {\n                        uploadPrivateFile(file);\n                    }\n                    break;\n                }\n            }\n        });\n    }\n}\n\n// Markdown\nfunction insertMarkdownFormat(prefix, suffix, sample) {\n    // \n    let activeInput = null;\n\n    // \n    const activeChatContent = document.querySelector('.chat-content.active');\n    if (activeChatContent) {\n        const contentType = activeChatContent.getAttribute('data-content');\n        switch (contentType) {\n            case 'public-chat':\n                activeInput = document.getElementById('messageInput');\n                break;\n            case 'group-chat':\n                activeInput = document.getElementById('groupMessageInput');\n                break;\n            case 'private-chat':\n                activeInput = document.getElementById('privateMessageInput');\n                break;\n            default:\n                // \n                activeInput = document.activeElement;\n        }\n    } else {\n        // \n        activeInput = document.activeElement;\n    }\n\n    // \n    if (!activeInput || !activeInput.isContentEditable) {\n        // \n        const editableInputs = document.querySelectorAll('.editable-div, [contenteditable=\"true\"]');\n        for (let i = 0; i < editableInputs.length; i++) {\n            if (editableInputs[i].offsetParent !== null) { // \n                activeInput = editableInputs[i];\n                break;\n            }\n        }\n\n        if (!activeInput || !activeInput.isContentEditable) {\n            return;\n        }\n    }\n\n    // \n    let selectedText = '';\n    if (window.getSelection) {\n        const selection = window.getSelection();\n        selectedText = selection.toString();\n    } else if (document.selection && document.selection.type !== 'Control') {\n        selectedText = document.selection.createRange().text;\n    }\n\n    // \n    if (!selectedText) {\n        selectedText = sample;\n    }\n\n    // \n    activeInput.focus();\n\n    // Markdown\n    const newText = prefix + selectedText + suffix;\n\n    // \n    document.execCommand('insertText', false, newText);\n}\n\n// \nfunction sendPrivateMessage() {\n    if (!currentUser || !currentSessionToken || !currentPrivateChatUserId) return;\n\n    const privateMessageInput = document.getElementById('privateMessageInput');\n    if (!privateMessageInput) return;\n\n    // div\n    const content = privateMessageInput.innerText.trim();\n    if (!content) return;\n\n    // \n    const isFriend = friendsList.some(friend => String(friend.id) === String(currentPrivateChatUserId));\n    if (!isFriend) {\n        toast.error('');\n        return;\n    }\n\n    // \n    const messageData = {\n        userId: currentUser.id,\n        content: content,\n        receiverId: currentPrivateChatUserId,\n        sessionToken: currentSessionToken\n    };\n\n    // \n    if (window.chatSocket) {\n        window.chatSocket.emit('private-message', messageData);\n    }\n\n    // \n    privateMessageInput.innerHTML = '';\n}\n\n// \nexport function initializePrivateChatInterface() {\n    // \n    const deleteFriendButton = document.getElementById('deleteFriendButton');\n    if (deleteFriendButton) {\n        // \n        deleteFriendButton.onclick = null;\n        deleteFriendButton.onclick = () => {\n            if (currentPrivateChatUserId) {\n                deleteFriend(currentPrivateChatUserId);\n            }\n        };\n    }\n\n    // \n    const privateUserInfoButton = document.getElementById('privateUserInfoButton');\n    if (privateUserInfoButton) {\n        // \n        privateUserInfoButton.onclick = null;\n        privateUserInfoButton.onclick = () => {\n            // \n            if (currentPrivateChatUserId && currentPrivateChatUsername) {\n                // URL\n                const privateUserAvatar = document.getElementById('privateUserAvatar');\n                let avatarUrl = '';\n                if (privateUserAvatar && privateUserAvatar.src && privateUserAvatar.src !== '') {\n                    // srcSERVER_URL\n                    if (privateUserAvatar.src.startsWith(SERVER_URL)) {\n                        avatarUrl = privateUserAvatar.src.replace(SERVER_URL, '');\n                    } else if (privateUserAvatar.src.startsWith('http')) {\n                        // URL\n                        avatarUrl = privateUserAvatar.src;\n                    }\n                }\n\n                // \n                const user = {\n                    id: currentPrivateChatUserId,\n                    nickname: currentPrivateChatNickname,\n                    avatarUrl: avatarUrl,\n                    username: currentPrivateChatUsername // \n                };\n                showUserProfile(user);\n            }\n        };\n    }\n\n    // \n    const privateMoreButton = document.getElementById('privateMoreButton');\n    if (privateMoreButton) {\n        // \n        privateMoreButton.onclick = null;\n        privateMoreButton.onclick = (e) => {\n            e.stopPropagation();\n            const privateMoreFunctions = document.getElementById('privateMoreFunctions');\n            if (privateMoreFunctions) {\n                privateMoreFunctions.classList.toggle('show');\n            }\n        };\n    }\n\n    // Markdown\n    const togglePrivateMarkdownToolbar = document.getElementById('togglePrivateMarkdownToolbar');\n    if (togglePrivateMarkdownToolbar) {\n        togglePrivateMarkdownToolbar.addEventListener('click', () => {\n            const privateMarkdownToolbar = document.getElementById('privateMarkdownToolbar');\n            if (privateMarkdownToolbar) {\n                privateMarkdownToolbar.style.display = privateMarkdownToolbar.style.display === 'flex' ? 'none' : 'flex';\n\n                // \n                const icon = togglePrivateMarkdownToolbar.querySelector('i');\n                if (icon) {\n                    icon.style.transform = privateMarkdownToolbar.style.display === 'flex' ? 'rotate(180deg)' : 'rotate(0deg)';\n                }\n            }\n        });\n    }\n\n    //  - initializePrivateMessageSending\n\n    // \n    const privateChatInterface = document.getElementById('privateChatInterface');\n    if (privateChatInterface) {\n        privateChatInterface.addEventListener('click', function() {\n            if (currentPrivateChatUserId) {\n                // \n                delete unreadMessages.private[currentPrivateChatUserId];\n                updateUnreadCountsDisplay();\n                updateTitleWithUnreadCount();\n\n                // \n                if (window.chatSocket) {\n                    window.chatSocket.emit('join-private-chat', {\n                        userId: currentUser.id,\n                        friendId: currentPrivateChatUserId,\n                        sessionToken: currentSessionToken,\n                        onlyClearUnread: true\n                    });\n                }\n            }\n        });\n    }\n}\n\n// \nfunction deleteFriend(userId) {\n    if (!currentUser || !currentSessionToken) return;\n\n    if (confirm('')) {\n        // fetch API\n        fetch(`${SERVER_URL}/user/remove-friend`, {\n            method: 'POST',\n            headers: {\n                'user-id': currentUser.id,\n                'session-token': currentSessionToken,\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ friendId: userId })\n        })\n            .then(response => response.json())\n            .then(data => {\n                if (data.status === 'success') {\n                    // \n                    loadFriendsList();\n\n                    // \n                    if (currentPrivateChatUserId === userId) {\n                        const privateChatInterface = document.getElementById('privateChatInterface');\n                        const privateEmptyState = document.getElementById('privateEmptyState');\n                        if (privateChatInterface && privateEmptyState) {\n                            privateChatInterface.style.display = 'none';\n                            privateEmptyState.style.display = 'flex';\n                            currentPrivateChatUserId = null;\n                            currentPrivateChatUsername = '';\n                        }\n                    }\n\n                    toast.success('');\n                } else {\n                    toast.error(': ' + data.message);\n                }\n            })\n            .catch(error => {\n                toast.error(': ');\n            });\n    }\n}\n\n// \nfunction logout() {\n\n    // WebSocket\n    if (window.chatSocket) {\n        window.chatSocket.disconnect();\n        window.chatSocket = null;\n    }\n\n    // localStorage\n    localStorage.removeItem('currentUser');\n    localStorage.removeItem('currentSessionToken');\n    localStorage.removeItem('chatUserId');\n    localStorage.removeItem('chatUserNickname');\n    localStorage.removeItem('chatSessionToken');\n    localStorage.removeItem('chatUserAvatar');\n    localStorage.removeItem('userId');\n    localStorage.removeItem('nickname');\n    localStorage.removeItem('avatarUrl');\n    localStorage.removeItem('sessionToken');\n\n    // \n    sessionStore = {\n        currentGroupId: null,\n        currentGroupName: '',\n        currentPrivateChatUserId: null,\n        currentPrivateChatUsername: '',\n        currentPrivateChatNickname: '',\n        currentPrivateChatAvatarUrl: '',\n        currentActiveChat: 'main',\n        currentSendChatType: 'main',\n        selectedGroupIdForCard: null\n    };\n\n    // \n    currentUser = null;\n    currentSessionToken = null;\n    isConnected = false;\n    currentGroupId = null;\n    currentGroupName = '';\n    currentPrivateChatUserId = null;\n    currentPrivateChatUsername = '';\n    currentPrivateChatNickname = '';\n    currentActiveChat = 'main';\n    currentSendChatType = 'main';\n    selectedGroupIdForCard = null;\n    onlineUsersList = [];\n    friendsList = [];\n    hasReceivedHistory = false;\n    hasReceivedGroupHistory = false;\n    hasReceivedPrivateHistory = false;\n    unreadMessages = { global: 0, groups: {}, private: {} };\n\n    // \n    setTimeout(() => {\n        window.location.hash = '#/login';\n        // \n        setTimeout(() => {\n            window.location.reload();\n        }, 100);\n    }, 100);\n}\n\n// \n// export function checkLoginStatus2() {\n//     let savedUser = localStorage.getItem('currentUser');\n//     let savedToken = localStorage.getItem('currentSessionToken');\n//\n//     // localStorageUI\n//     if (!savedUser || !savedToken) {\n//         const chatUserId = localStorage.getItem('chatUserId');\n//         const chatUserNickname = localStorage.getItem('chatUserNickname');\n//         const chatSessionToken = localStorage.getItem('chatSessionToken');\n//         const chatUserAvatar = localStorage.getItem('chatUserAvatar');\n//\n//         if (chatUserId && chatSessionToken) {\n//             // \n//             savedUser = JSON.stringify({\n//                 id: chatUserId,\n//                 nickname: chatUserNickname || '',\n//                 avatarUrl: chatUserAvatar || null\n//             });\n//             savedToken = chatSessionToken;\n//\n//             // localStorage\n//             localStorage.setItem('currentUser', savedUser);\n//             localStorage.setItem('currentSessionToken', savedToken);\n//         }\n//     }\n//\n//     if (savedUser && savedToken) {\n//         currentUser = JSON.parse(savedUser);\n//         currentSessionToken = savedToken;\n//\n//         // \n//         updateUserAvatar();\n//\n//         initializeChatInternal();\n//     } else {\n//         // \n//         window.location.hash = '#/login';\n//     }\n// }\n\n// \nfunction initializeChatInternal() {\n    // DOMContentLoaded\n    // \n    // initializeMessageSending();\n\n    // \n    initializeGroupFunctions();\n\n    // \n    initializePrivateChatFunctions();\n\n    // \n    // initializeSettingsFunctions();\n\n    // \n    initializeFocusListeners();\n\n    // \n    // initializeMoreButtons();\n\n    // \n    enableMessageSending();\n\n    // \n    initAllFunctions();\n\n    // \n    loadUserList();\n\n    // \n    loadOfflineUsers();\n\n    // \n    loadGroupList();\n\n    // \n    loadFriendsList();\n\n    // WebSocket\n    initializeWebSocket();\n}\n\n// IP\nfunction checkUserAndIPStatus(callback) {\n    fetch(`${SERVER_URL}/check-status`, {\n        method: 'GET',\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    })\n        .then(response => {\n            if (!response.ok) {\n                throw new Error(`HTTP! : ${response.status}`);\n            }\n            return response.json();\n        })\n        .then(data => {\n\n            // IPisBanned\n            if (data.isBanned) {\n                const message = `IP${data.message || ''}`;\n                toast.error(message);\n                logout();\n                callback(false);\n                return;\n            }\n\n            // \n            if (currentUser && !data.userExists) {\n                toast.error('');\n                logout();\n                callback(false);\n                return;\n            }\n\n            // \n            callback(true);\n        })\n        .catch(error => {\n            // \n            callback(true);\n        });\n}\n\n// WebSocket\nfunction initializeWebSocket() {\n    // WebSocket - Socket.io\n\n    // Socket.io\n    const socket = io(SERVER_URL, {\n        transports: ['websocket', 'polling'],\n        reconnection: true,\n        reconnectionAttempts: Infinity,\n        reconnectionDelay: 1000,\n        reconnectionDelayMax: 5000,\n        timeout: 20000,\n        autoConnect: true\n    });\n\n    // \n    let onlineUsersTimer = null;\n\n    // \n    socket.on('connect', () => {\n        isConnected = true;\n\n        // IP\n        if (currentUser && currentSessionToken) {\n\n            checkUserAndIPStatus((canProceed) => {\n                if (canProceed) {\n                    // user-joined\n                    // avatarUrl\n                    // userIdundefined\n                    // URLavatarUrlavatar_urlavatar\n                    let avatarUrl = '';\n                    if (currentUser.avatarUrl && typeof currentUser.avatarUrl === 'string') {\n                        avatarUrl = currentUser.avatarUrl.trim();\n                    } else if (currentUser.avatar_url && typeof currentUser.avatar_url === 'string') {\n                        avatarUrl = currentUser.avatar_url.trim();\n                    } else if (currentUser.avatar && typeof currentUser.avatar === 'string') {\n                        avatarUrl = currentUser.avatar.trim();\n                    }\n\n                    const joinedData = {\n                        userId: currentUser.id ? String(currentUser.id) : null,\n                        nickname: currentUser.nickname,\n                        avatarUrl: avatarUrl || null,\n                        sessionToken: currentSessionToken\n                    };\n                    socket.emit('user-joined', joinedData);\n\n                    // \n                    socket.emit('get-online-users');\n\n                    // \n                    if (currentGroupId) {\n                        // console.log(`  - ID: ${currentGroupId}, ID: ${currentUser.id}`);\n\n                        // \n                        socket.emit('join-group', {\n                            groupId: currentGroupId,\n                            sessionToken: currentSessionToken,\n                            userId: currentUser.id\n                        });\n\n                        // WebSocket\n                        const historyRequest = {\n                            groupId: currentGroupId,\n                            userId: currentUser.id,\n                            sessionToken: currentSessionToken,\n                            limit: 20\n                        };\n                        // console.log(`  - : get-group-chat-history, :`, historyRequest);\n                        socket.emit('get-group-chat-history', historyRequest);\n                    }\n\n                    // \n                    enableMessageSending();\n\n                    // 30IP\n                    if (!onlineUsersTimer) {\n                        onlineUsersTimer = setInterval(() => {\n                            if (isConnected && currentUser && currentSessionToken) {\n                                socket.emit('get-online-users');\n                            }\n                        }, 30000); // 30\n                    }\n                }\n            });\n        }\n    });\n\n    // \n    socket.on('reconnect', (attemptNumber) => {\n        isConnected = true;\n\n        // IP\n        if (currentUser && currentSessionToken) {\n\n            checkUserAndIPStatus((canProceed) => {\n                if (canProceed) {\n                    // user-joined\n                    // avatarUrl\n                    // userIdundefined\n                    // URLavatarUrlavatar_urlavatar\n                    let avatarUrl = '';\n                    if (currentUser.avatarUrl && typeof currentUser.avatarUrl === 'string') {\n                        avatarUrl = currentUser.avatarUrl.trim();\n                    } else if (currentUser.avatar_url && typeof currentUser.avatar_url === 'string') {\n                        avatarUrl = currentUser.avatar_url.trim();\n                    } else if (currentUser.avatar && typeof currentUser.avatar === 'string') {\n                        avatarUrl = currentUser.avatar.trim();\n                    }\n\n                    const joinedData = {\n                        userId: currentUser.id ? String(currentUser.id) : null,\n                        nickname: currentUser.nickname,\n                        avatarUrl: avatarUrl || null,\n                        sessionToken: currentSessionToken\n                    };\n                    socket.emit('user-joined', joinedData);\n\n                    // \n                    socket.emit('get-online-users');\n\n                    // \n                    if (currentGroupId) {\n                        // console.log(`  - ID: ${currentGroupId}, ID: ${currentUser.id}`);\n\n                        // \n                        socket.emit('join-group', {\n                            groupId: currentGroupId,\n                            sessionToken: currentSessionToken,\n                            userId: currentUser.id\n                        });\n\n                        // WebSocket\n                        const historyRequest = {\n                            groupId: currentGroupId,\n                            userId: currentUser.id,\n                            sessionToken: currentSessionToken,\n                            limit: 20\n                        };\n                        // console.log(`  - : get-group-chat-history, :`, historyRequest);\n                        socket.emit('get-group-chat-history', historyRequest);\n                    }\n\n                    // \n                    enableMessageSending();\n\n                    // \n                    if (!onlineUsersTimer) {\n                        onlineUsersTimer = setInterval(() => {\n                            if (isConnected && currentUser && currentSessionToken) {\n                                socket.emit('get-online-users');\n                            }\n                        }, 30000); // 30\n                    }\n                }\n            });\n        }\n    });\n\n    // \n    socket.on('disconnect', () => {\n        isConnected = false;\n        // \n        disableMessageSending();\n        // \n        if (onlineUsersTimer) {\n            clearInterval(onlineUsersTimer);\n            onlineUsersTimer = null;\n        }\n    });\n\n    // \n    socket.on('message-received', (message) => {\n        // \n        if (message.sessionToken) {\n            // \n            currentSessionToken = message.sessionToken;\n            localStorage.setItem('currentSessionToken', currentSessionToken);\n        }\n\n        // ID\n        if (message.groupId) {\n            // isHistorytimestamp\n            // group-chat-history\n            const now = Date.now();\n            const messageTime = message.timestamp ? new Date(message.timestamp).getTime() : now;\n            const isRecentMessage = now - messageTime < 10000; // 10\n            message.isHistory = message.isHistory || !isRecentMessage;\n            // ID\n            handleNewMessage(message, true, message.groupId);\n            displayGroupMessage(message);\n        } else {\n            // \n            handleNewMessage(message, false);\n            displayMessage(message);\n        }\n    });\n\n    // \n    socket.on('message-sent', (data) => {\n        // \n        if (data.message) {\n            const message = data.message;\n            // \n            message.isHistory = false;\n\n            // ID\n            if (message.groupId) {\n                // \n                displayGroupMessage(message);\n            } else {\n                // \n                displayMessage(message);\n            }\n        }\n    });\n\n    //  - \n    socket.on('group-message-received', (message) => {\n        // \n        if (message.sessionToken) {\n            // \n            currentSessionToken = message.sessionToken;\n            localStorage.setItem('currentSessionToken', currentSessionToken);\n        }\n\n        // isHistorytimestamp\n        // group-chat-history\n        const now = Date.now();\n        const messageTime = message.timestamp ? new Date(message.timestamp).getTime() : now;\n        const isRecentMessage = now - messageTime < 10000; // 10\n        message.isHistory = message.isHistory || !isRecentMessage;\n        // message-received\n        displayGroupMessage(message);\n    });\n\n    // \n    socket.on('online-users', (users) => {\n        updateUserList(users);\n    });\n\n    // \n    socket.on('users-updated', (users) => {\n        updateUserList(users);\n        // \n        loadFriendsList();\n    });\n\n    // \n    socket.on('group-list', (groups) => {\n        updateGroupList(groups);\n    });\n\n    // \n    socket.on('group-created', () => {\n        const groupList = document.getElementById('groupList');\n        if (groupList) {\n            loadGroupList();\n        }\n    });\n\n    // \n    socket.on('group-deleted', () => {\n        const groupList = document.getElementById('groupList');\n        if (groupList) {\n            loadGroupList();\n        }\n    });\n\n    // \n    socket.on('group-dissolved', () => {\n        const groupList = document.getElementById('groupList');\n        if (groupList) {\n            loadGroupList();\n        }\n    });\n\n    // \n    socket.on('friend-removed', () => {\n        // \n        loadFriendsList();\n    });\n\n    // \n    socket.on('avatar-updated', (data) => {\n        // \n        if (data.userId && data.avatarUrl) {\n            // \n            loadFriendsList();\n            // \n            loadGroupList();\n            // \n            if (currentPrivateChatUserId) {\n                // \n                const privateUserAvatar = document.querySelector('#privateChatInterface .chat-avatar img');\n                if (privateUserAvatar && currentPrivateChatUserId === data.userId) {\n                    privateUserAvatar.src = `${SERVER_URL}${data.avatarUrl}`;\n                }\n            }\n        }\n    });\n\n    // \n    socket.on('chat-history', (data) => {\n        // \n        if (data.sessionToken) {\n            // \n            currentSessionToken = data.sessionToken;\n            localStorage.setItem('currentSessionToken', currentSessionToken);\n        }\n\n        // \n        let processedUnreadMessages = {\n            global: 0,\n            groups: {},\n            private: {}\n        };\n\n        // \n        if (data.unreadMessages) {\n            if (data.unreadMessages && typeof data.unreadMessages === 'object' && !data.unreadMessages.hasOwnProperty('global')) {\n                // globalgroups\n                processedUnreadMessages.groups = data.unreadMessages;\n            } else {\n                processedUnreadMessages.groups = data.unreadMessages.groups || {};\n                processedUnreadMessages.global = data.unreadMessages.global || 0;\n            }\n        }\n\n        // \n        if (data.unreadPrivateMessages) {\n            processedUnreadMessages.private = data.unreadPrivateMessages;\n        }\n\n        // \n        unreadMessages = processedUnreadMessages;\n\n        // \n        const mutedGroups = getMutedGroups();\n        for (const groupId in unreadMessages.groups) {\n            if (unreadMessages.groups.hasOwnProperty(groupId)) {\n                // \n                if (mutedGroups.includes(groupId)) {\n                    // \n                    unreadMessages.groups[groupId] = 0;\n\n                    // WebSocket\n                    if (window.chatSocket) {\n                        window.chatSocket.emit('join-group', {\n                            groupId: groupId,\n                            sessionToken: currentSessionToken,\n                            userId: currentUser.id\n                        });\n                    }\n                }\n            }\n        }\n\n        // \n        updateUnreadCountsDisplay();\n        updateTitleWithUnreadCount();\n\n        const messageContainer = document.getElementById('messageContainer');\n        if (!messageContainer) return;\n\n        const emptyState = messageContainer.querySelector('.empty-state');\n\n        // \n        if (currentUser && currentSessionToken) {\n            // \n            if (!hasReceivedHistory) {\n                messageContainer.innerHTML = '';\n                hasReceivedHistory = true;\n            }\n\n            if (!data.messages || !Array.isArray(data.messages) || data.messages.length === 0) {\n                if (emptyState) {\n                    emptyState.style.display = 'block';\n                }\n                // \n                if (window.resetLoadingState) {\n                    window.resetLoadingState();\n                }\n                return;\n            }\n\n            if (emptyState) {\n                emptyState.style.display = 'none';\n            }\n\n            // sequence\n            const sortedMessages = [...data.messages].sort((a, b) => {\n                if (a.sequence !== undefined && b.sequence !== undefined) {\n                    return b.sequence - a.sequence; // \n                }\n                return b.timestamp - a.timestamp;\n            });\n\n            // \n            // \n            const messagesToRender = data.loadMore ? sortedMessages : sortedMessages.reverse();\n\n            // ID\n            const processedMessageIds = new Set();\n\n            // ID\n            const existingMessages = messageContainer.querySelectorAll('[data-id]');\n            existingMessages.forEach(msg => {\n                processedMessageIds.add(msg.getAttribute('data-id'));\n            });\n\n            // \n            let prevScrollHeight, prevScrollTop;\n            if (data.loadMore) {\n                prevScrollHeight = messageContainer.scrollHeight;\n                prevScrollTop = messageContainer.scrollTop;\n            }\n\n            // \n            messagesToRender.forEach(message => {\n                // \n                if (!message || !message.id) {\n                    return;\n                }\n\n                // ID\n                if (processedMessageIds.has(String(message.id))) {\n                    return;\n                }\n\n                // \n                processedMessageIds.add(String(message.id));\n\n                // \n                if (data.loadMore) {\n                    const messageElement = displayMessage(message, true);\n                    if (messageElement) {\n                        messageContainer.insertBefore(messageElement, messageContainer.firstChild);\n                    }\n                } else {\n                    // \n                    displayMessage(message);\n                }\n            });\n\n            // \n            if (data.loadMore && prevScrollHeight !== undefined && prevScrollTop !== undefined) {\n                const newScrollHeight = messageContainer.scrollHeight;\n                const heightDifference = newScrollHeight - prevScrollHeight;\n                messageContainer.scrollTop = prevScrollTop + heightDifference;\n            } else if (!data.loadMore) {\n                // \n                messageContainer.scrollTop = messageContainer.scrollHeight;\n            }\n        }\n\n        // \n        if (window.resetLoadingState) {\n            window.resetLoadingState();\n        }\n    });\n\n    // \n    socket.on('group-chat-history', (data) => {\n        // console.log(`  - ID: ${data.groupId || currentGroupId}, : ${data.messages ? data.messages.length : 0}, : ${data.loadMore ? '' : ''}`);\n\n        // \n        if (data.sessionToken) {\n            // console.log(`  - `);\n            // \n            currentSessionToken = data.sessionToken;\n            localStorage.setItem('currentSessionToken', currentSessionToken);\n        }\n\n        // \n        if (data.unreadMessages) {\n            // \n            let processedUnreadMessages = data.unreadMessages;\n            if (processedUnreadMessages && typeof processedUnreadMessages === 'object' && !processedUnreadMessages.hasOwnProperty('global')) {\n                // globalgroups\n                processedUnreadMessages = {\n                    global: 0,\n                    groups: processedUnreadMessages\n                };\n            }\n            // groupsprivate\n            unreadMessages = {\n                global: processedUnreadMessages.global || 0,\n                groups: processedUnreadMessages.groups || {},\n                private: processedUnreadMessages.private || {}\n            };\n\n            // \n            const mutedGroups = getMutedGroups();\n            for (const groupId in unreadMessages.groups) {\n                if (unreadMessages.groups.hasOwnProperty(groupId)) {\n                    // \n                    if (mutedGroups.includes(groupId)) {\n                        // \n                        unreadMessages.groups[groupId] = 0;\n\n                        // WebSocket\n                        if (window.chatSocket) {\n                            window.chatSocket.emit('join-group', {\n                                groupId: groupId,\n                                sessionToken: currentSessionToken,\n                                userId: currentUser.id\n                            });\n                        }\n                    }\n                }\n            }\n\n            // \n            updateTitleWithUnreadCount();\n        }\n\n        const groupMessageContainer = document.getElementById('groupMessageContainer');\n        if (!groupMessageContainer) {\n            // console.error('  - ');\n            // \n            if (window.resetLoadingState) {\n                window.resetLoadingState();\n            }\n            return;\n        }\n\n        const groupEmptyState = groupMessageContainer.querySelector('.empty-state');\n\n        // \n        if (currentUser && currentSessionToken) {\n            // \n            if (!hasReceivedGroupHistory) {\n                groupMessageContainer.innerHTML = '';\n                hasReceivedGroupHistory = true;\n            }\n\n            // 0\n            if (data.loadMore && (!data.messages || !Array.isArray(data.messages) || data.messages.length === 0)) {\n                // console.log(` 0 - `);\n                // \n                if (window.resetLoadingState) {\n                    window.resetLoadingState();\n                }\n                return;\n            }\n\n            if (!data.messages || !Array.isArray(data.messages) || data.messages.length === 0) {\n                // \n                groupMessageContainer.innerHTML = `\n                    <div class=\"empty-state\">\n                        <h3></h3>\n                        <p>!</p>\n                    </div>\n                `;\n                // \n                if (window.resetLoadingState) {\n                    window.resetLoadingState();\n                }\n                return;\n            }\n\n            if (groupEmptyState) {\n                groupEmptyState.style.display = 'none';\n            }\n\n            // sequence\n            const sortedMessages = [...data.messages].sort((a, b) => {\n                if (a.sequence !== undefined && b.sequence !== undefined) {\n                    return b.sequence - a.sequence; // \n                }\n                return b.timestamp - a.timestamp;\n            });\n\n            // \n            // \n            const messagesToRender = data.loadMore ? sortedMessages : sortedMessages.reverse();\n\n            // ID\n            const processedMessageIds = new Set();\n\n            // ID\n            const existingMessages = groupMessageContainer.querySelectorAll('[data-id]');\n            existingMessages.forEach(msg => {\n                processedMessageIds.add(msg.getAttribute('data-id'));\n            });\n\n            // \n            let prevScrollHeight, prevScrollTop;\n            if (data.loadMore) {\n                prevScrollHeight = groupMessageContainer.scrollHeight;\n                prevScrollTop = groupMessageContainer.scrollTop;\n            }\n\n            // \n            if (data.loadMore) {\n                // \n                messagesToRender.forEach(message => {\n                    // \n                    if (!message || !message.id) {\n                        return;\n                    }\n\n                    // ID\n                    if (processedMessageIds.has(String(message.id))) {\n                        return;\n                    }\n\n                    // \n                    processedMessageIds.add(String(message.id));\n\n                    // \n                    message.isHistory = true;\n                    const messageElement = displayGroupMessage(message, true);\n                    if (messageElement) {\n                        groupMessageContainer.insertBefore(messageElement, groupMessageContainer.firstChild);\n                    }\n                });\n            } else {\n                // \n                // messagesToRender\n                messagesToRender.forEach(message => {\n                    // \n                    if (!message || !message.id) {\n                        return;\n                    }\n\n                    // ID\n                    if (processedMessageIds.has(String(message.id))) {\n                        return;\n                    }\n\n                    // \n                    processedMessageIds.add(String(message.id));\n\n                    // \n                    message.isHistory = true;\n                    // \n                    displayGroupMessage(message);\n                });\n            }\n\n            // \n            if (data.loadMore && prevScrollHeight !== undefined && prevScrollTop !== undefined) {\n                // \n                const newScrollHeight = groupMessageContainer.scrollHeight;\n                const heightDifference = newScrollHeight - prevScrollHeight;\n                groupMessageContainer.scrollTop = heightDifference;\n            } else {\n                // \n                setTimeout(() => {\n                    groupMessageContainer.scrollTop = groupMessageContainer.scrollHeight;\n                }, 0);\n            }\n        }\n\n        // \n        if (window.resetLoadingState) {\n            window.resetLoadingState();\n        }\n    });\n\n    // \n    socket.on('user-joined-response', (data) => {\n        // \n        if (data.sessionToken) {\n            // \n            currentSessionToken = data.sessionToken;\n            localStorage.setItem('currentSessionToken', currentSessionToken);\n        }\n\n        // \n        if (data.unreadMessages) {\n            // \n            let processedUnreadMessages = data.unreadMessages;\n            if (processedUnreadMessages && typeof processedUnreadMessages === 'object' && !processedUnreadMessages.hasOwnProperty('global')) {\n                // globalgroups\n                processedUnreadMessages = {\n                    global: 0,\n                    groups: processedUnreadMessages\n                };\n            }\n            // groupsprivate\n            unreadMessages = {\n                global: processedUnreadMessages.global || 0,\n                groups: processedUnreadMessages.groups || {},\n                private: processedUnreadMessages.private || {}\n            };\n\n            // \n            const mutedGroups = getMutedGroups();\n            for (const groupId in unreadMessages.groups) {\n                if (unreadMessages.groups.hasOwnProperty(groupId)) {\n                    // \n                    if (mutedGroups.includes(groupId)) {\n                        // \n                        unreadMessages.groups[groupId] = 0;\n\n                        // WebSocket\n                        if (window.chatSocket) {\n                            window.chatSocket.emit('join-group', {\n                                groupId: groupId,\n                                sessionToken: currentSessionToken,\n                                userId: currentUser.id\n                            });\n                        }\n                    }\n                }\n            }\n\n            // \n            updateTitleWithUnreadCount();\n        }\n    });\n\n    // \n    socket.on('login-success', (data) => {\n        // \n        if (data.sessionToken) {\n            // \n            currentSessionToken = data.sessionToken;\n            localStorage.setItem('currentSessionToken', currentSessionToken);\n        }\n    });\n\n    // \n    socket.on('disconnect', () => {\n        isConnected = false;\n        // \n        disableMessageSending();\n    });\n\n    // \n    socket.on('error', (error) => {\n        isConnected = false;\n        disableMessageSending();\n    });\n\n    // WebSocket\n    // [\"session-expired\"]\n    socket.on('message', (data) => {\n        // \n        if (Array.isArray(data) && data[0] === 'session-expired') {\n            toast.error('');\n            logout();\n        }\n    });\n\n    // \n    socket.on('session-expired', () => {\n        toast.error('');\n        logout();\n    });\n\n    // \n    socket.on('account-banned', (data) => {\n        const message = `IP${data.message || ''}`;\n        toast.error(message);\n        logout();\n    });\n\n    //  - \n    socket.on('message-deleted', (data) => {\n        const { messageId } = data;\n        if (messageId) {\n            // \n            const messageElement = document.querySelector(`#messageContainer [data-id=\"${messageId}\"]`);\n            if (messageElement) {\n                messageElement.remove();\n            }\n\n            // \n            const groupMessageElement = document.querySelector(`#groupMessageContainer [data-id=\"${messageId}\"]`);\n            if (groupMessageElement) {\n                groupMessageElement.remove();\n            }\n\n            // chatHistoryHTML\n            if (chatHistory) {\n                if (chatHistory.nodeType === 11) { // 11 \n                    // \n                    const messages = chatHistory.querySelectorAll(`[data-id=\"${messageId}\"]`);\n                    messages.forEach(messageElement => {\n                        if (messageElement.parentNode === chatHistory) {\n                            chatHistory.removeChild(messageElement);\n                        }\n                    });\n                } else if (typeof chatHistory === 'string') {\n                    // chatHistory\n                    const messageRegex = new RegExp(`<div[^>]*data-id=\"${messageId}\"[^>]*>.*?</div>`, 's');\n                    chatHistory = chatHistory.replace(messageRegex, '');\n                }\n            }\n        }\n    });\n\n    // \n    socket.on('group-name-updated', (data) => {\n        // \n        if (currentUser && currentSessionToken) {\n            loadGroupList();\n        }\n    });\n\n    // \n    socket.on('group-description-updated', (data) => {\n        // \n        if (currentUser && currentSessionToken) {\n            loadGroupList();\n\n            // \n            const modal = document.getElementById('groupInfoModal');\n            if (modal && modal.style.display === 'flex') {\n                const modalGroupNoticeValue = document.getElementById('modalGroupNoticeValue');\n                if (modalGroupNoticeValue) {\n                    modalGroupNoticeValue.textContent = data.newDescription ? unescapeHtml(data.newDescription) : '';\n                }\n            }\n        }\n    });\n\n    // \n    socket.on('private-message-sent', (data) => {\n        // \n        if (data.message) {\n            const message = data.message;\n            // \n            message.isHistory = false;\n            // \n            renderPrivateMessage(message);\n        }\n    });\n\n    // \n    socket.on('private-message-received', (message) => {\n        // \n        if (message.sessionToken) {\n            // \n            currentSessionToken = message.sessionToken;\n            localStorage.setItem('currentSessionToken', currentSessionToken);\n        }\n\n        // \n        if (message.senderId === currentUser.id || message.userId === currentUser.id) {\n            return;\n        }\n\n        // \n        message.isHistory = false;\n\n        // \n        const msgSenderId = String(message.senderId);\n        const msgReceiverId = String(message.receiverId);\n\n        // \n        renderPrivateMessage(message);\n\n        // \n        // \n        const isInCurrentPrivateChat = currentActiveChat === `private_${msgSenderId}`;\n        if (!isPageVisible || !isInCurrentPrivateChat) {\n            // ID\n            const targetUserId = String(currentUser.id) === msgReceiverId ? msgSenderId : msgReceiverId;\n\n            // \n            unreadMessages.private[targetUserId] = (unreadMessages.private[targetUserId] || 0) + 1;\n            updateUnreadCountsDisplay();\n            updateTitleWithUnreadCount();\n        }\n    });\n\n    // \n    socket.on('friend-list-updated', (data) => {\n        // \n        loadFriendsList();\n    });\n\n    // \n    socket.on('private-message-withdrawn', (data) => {\n        if (!data || !data.messageId) return;\n\n        // \n        const messageElement = document.querySelector(`#privateMessageContainer [data-id=\"${data.messageId}\"]`);\n        if (messageElement) {\n            messageElement.remove();\n        }\n    });\n\n    // \n    socket.on('private-chat-history', (data) => {\n        // \n        if (data.sessionToken) {\n            // \n            currentSessionToken = data.sessionToken;\n            localStorage.setItem('currentSessionToken', currentSessionToken);\n        }\n\n        const privateMessageContainer = document.getElementById('privateMessageContainer');\n        if (!privateMessageContainer) {\n            // \n            if (window.resetLoadingState) {\n                window.resetLoadingState();\n            }\n            return;\n        }\n\n        // \n        if (currentUser && currentSessionToken) {\n            // \n            if (!hasReceivedPrivateHistory || !data.loadMore) {\n                privateMessageContainer.innerHTML = '';\n                hasReceivedPrivateHistory = true;\n            }\n\n            // 0\n            if (data.loadMore && (!data.messages || !Array.isArray(data.messages) || data.messages.length === 0)) {\n                // \n                if (window.resetLoadingState) {\n                    window.resetLoadingState();\n                }\n                return;\n            }\n\n            // \n            if (data.messages && Array.isArray(data.messages)) {\n                if (data.messages.length === 0) {\n                    // \n                    privateMessageContainer.innerHTML = `\n                        <div class=\"empty-state\">\n                            <div class=\"empty-icon\"></div>\n                            <h3></h3>\n                            <p>!</p>\n                        </div>\n                    `;\n                } else {\n                    // \n                    const emptyElement = privateMessageContainer.querySelector('.empty-state');\n                    if (emptyElement) {\n                        emptyElement.remove();\n                    }\n\n                    // sequence\n                    const sortedMessages = [...data.messages].sort((a, b) => {\n                        if (a.sequence !== undefined && b.sequence !== undefined) {\n                            return b.sequence - a.sequence; // \n                        }\n                        return new Date(b.timestampISO || b.created_at || b.timestamp) - new Date(a.timestampISO || a.created_at || a.timestamp);\n                    });\n\n                    // \n                    // \n                    const messagesToRender = data.loadMore ? sortedMessages : sortedMessages.reverse();\n\n                    // ID\n                    const processedMessageIds = new Set();\n\n                    // ID\n                    const existingMessages = privateMessageContainer.querySelectorAll('[data-id]');\n                    existingMessages.forEach(msg => {\n                        processedMessageIds.add(msg.getAttribute('data-id'));\n                    });\n\n                    // \n                    let prevScrollHeight, prevScrollTop;\n                    if (data.loadMore) {\n                        prevScrollHeight = privateMessageContainer.scrollHeight;\n                        prevScrollTop = privateMessageContainer.scrollTop;\n                    }\n\n                    // \n                    if (data.loadMore) {\n                        // \n                        messagesToRender.forEach(message => {\n                            // \n                            if (!message || !message.id) {\n                                return;\n                            }\n\n                            // ID\n                            if (processedMessageIds.has(String(message.id))) {\n                                return;\n                            }\n\n                            // \n                            processedMessageIds.add(String(message.id));\n\n                            // \n                            message.isHistory = true;\n                            const messageElement = renderPrivateMessage(message, true);\n                            if (messageElement) {\n                                privateMessageContainer.insertBefore(messageElement, privateMessageContainer.firstChild);\n                            }\n                        });\n                    } else {\n                        // \n                        messagesToRender.forEach(message => {\n                            // \n                            if (!message || !message.id) {\n                                return;\n                            }\n\n                            // ID\n                            if (processedMessageIds.has(String(message.id))) {\n                                return;\n                            }\n\n                            // \n                            processedMessageIds.add(String(message.id));\n\n                            // \n                            message.isHistory = true;\n                            // \n                            renderPrivateMessage(message);\n                        });\n                    }\n\n                    // \n                    if (data.loadMore && prevScrollHeight !== undefined && prevScrollTop !== undefined) {\n                        // \n                        const newScrollHeight = privateMessageContainer.scrollHeight;\n                        const heightDifference = newScrollHeight - prevScrollHeight;\n                        privateMessageContainer.scrollTop = prevScrollTop + heightDifference;\n                    } else if (!data.loadMore) {\n                        // \n                        privateMessageContainer.scrollTop = privateMessageContainer.scrollHeight;\n                    }\n                }\n            } else {\n                // \n                privateMessageContainer.innerHTML = `\n                    <div class=\"empty-state\">\n                        <div class=\"empty-icon\"></div>\n                        <h3></h3>\n                        <p>!</p>\n                    </div>\n                `;\n            }\n        }\n\n        // \n        if (window.resetLoadingState) {\n            window.resetLoadingState();\n        }\n    });\n\n    // socket\n    window.chatSocket = socket;\n\n    // \n    window.getChatHistory = function(options = {}) {\n        if (!window.chatSocket) return;\n\n        window.chatSocket.emit('get-chat-history', {\n            userId: currentUser.id,\n            sessionToken: currentSessionToken,\n            loadMore: options.loadMore || false,\n            olderThan: options.olderThan || null,\n            limit: options.limit || 20\n        });\n    };\n\n    // \n    window.getGroupChatHistory = function(groupId, options = {}) {\n        if (!window.chatSocket || !groupId) {\n            console.warn('   - WebSocketID');\n            return;\n        }\n\n        const historyOptions = {\n            userId: currentUser.id,\n            sessionToken: currentSessionToken,\n            groupId: groupId,\n            loadMore: options.loadMore || false,\n            olderThan: options.olderThan || null,\n            limit: options.limit || 20\n        };\n\n        if (historyOptions.loadMore) {\n            // console.log(`  - ID: ${groupId}, : ${historyOptions.limit}, : ${historyOptions.olderThan || ''}`);\n        } else {\n            // console.log(`  - ID: ${groupId}, : ${historyOptions.limit}`);\n        }\n\n        window.chatSocket.emit('get-group-chat-history', historyOptions);\n    };\n\n    // \n    const ModalManager = {\n        // \n        init: function() {\n            this.initCreateGroupModal();\n            this.initGroupInfoModal();\n            this.initAddGroupMemberModal();\n        },\n\n        // \n        showModal: function(modalId) {\n            const modal = document.getElementById(modalId);\n            if (modal) {\n                modal.style.display = 'flex';\n                modal.style.justifyContent = 'center';\n                modal.style.alignItems = 'center';\n                modal.style.zIndex = '1000';\n                document.body.style.overflow = 'hidden';\n\n                // \n                if (modalId === 'createGroupModal') {\n\n                    this.loadAvailableMembers();\n                }\n            }\n        },\n\n        // \n        hideModal: function(modalId) {\n            const modal = document.getElementById(modalId);\n            if (modal) {\n                modal.style.display = 'none';\n                document.body.style.overflow = '';\n            }\n        },\n\n        // \n        initCreateGroupModal: function() {\n            const modalId = 'createGroupModal';\n            const closeButtons = [\n                document.getElementById('closeCreateGroupModal'),\n                document.getElementById('cancelCreateGroup')\n            ];\n\n            // \n            closeButtons.forEach(button => {\n                if (button) {\n                    button.addEventListener('click', () => {\n                        this.hideModal(modalId);\n                    });\n                }\n            });\n\n            // \n            const modal = document.getElementById(modalId);\n            if (modal) {\n                modal.addEventListener('click', (e) => {\n                    if (e.target === modal) {\n                        this.hideModal(modalId);\n                    }\n                });\n            }\n\n            // \n            const createGroupButton = document.getElementById('createGroupButton');\n            if (createGroupButton) {\n                createGroupButton.addEventListener('click', () => {\n\n                    this.showModal(modalId);\n                    this.loadAvailableMembers();\n                });\n            }\n\n            // \n            if (modal) {\n                modal.addEventListener('show', () => {\n\n                    this.loadAvailableMembers();\n                });\n            }\n\n            // \n            this.bindCreateGroupSubmit();\n        },\n\n        // \n        initGroupInfoModal: function() {\n            const modalId = 'groupInfoModal';\n            const closeButtons = [\n                document.getElementById('closeGroupInfoModal'),\n                document.getElementById('modalCloseButton')\n            ];\n\n            // \n            closeButtons.forEach(button => {\n                if (button) {\n                    button.addEventListener('click', () => {\n                        this.hideModal(modalId);\n                    });\n                }\n            });\n\n            // \n            const modal = document.getElementById(modalId);\n            if (modal) {\n                modal.addEventListener('click', (e) => {\n                    if (e.target === modal) {\n                        this.hideModal(modalId);\n                    }\n                });\n            }\n        },\n\n        // \n        initAddGroupMemberModal: function() {\n            const modalId = 'addGroupMemberModal';\n            const closeButtons = [\n                document.getElementById('closeAddGroupMemberModal'),\n                document.getElementById('cancelAddMembers')\n            ];\n\n            // \n            closeButtons.forEach(button => {\n                if (button) {\n                    button.addEventListener('click', () => {\n                        this.hideModal(modalId);\n                        hideAddGroupMemberModal();\n                    });\n                }\n            });\n\n            // \n            const modal = document.getElementById(modalId);\n            if (modal) {\n                modal.addEventListener('click', (e) => {\n                    if (e.target === modal) {\n                        this.hideModal(modalId);\n                        hideAddGroupMemberModal();\n                    }\n                });\n            }\n\n            // \n            const confirmAddMembersBtn = document.getElementById('confirmAddMembers');\n            if (confirmAddMembersBtn) {\n                confirmAddMembersBtn.addEventListener('click', confirmAddGroupMembers);\n            }\n        },\n\n        // \n        loadAvailableMembers: function() {\n            const groupMembersList = document.getElementById('groupMembersList');\n            if (!groupMembersList) return;\n\n            // \n            groupMembersList.innerHTML = '<div class=\"loading-members\">...</div>';\n\n            // \n            if (!currentUser || !currentSessionToken) {\n                groupMembersList.innerHTML = '<div class=\"loading-members\"></div>';\n                return;\n            }\n\n            // \n            fetch(`${SERVER_URL}/user/friends`, {\n                headers: {\n                    'user-id': currentUser.id,\n                    'session-token': currentSessionToken\n                }\n            })\n                .then(response => response.json())\n                .then(data => {\n                    let friends = [];\n                    if (data.status === 'success' && data.friends) {\n                        friends = data.friends;\n                    } else {\n                        console.error('Failed to get friends:', data.message || 'Unknown error');\n                    }\n\n                    // \n                    const availableMembers = friends.filter(friend => friend.id !== currentUser.id);\n\n                    // \n                    if (availableMembers.length === 0) {\n                        groupMembersList.innerHTML = '<div class=\"loading-members\"></div>';\n                    } else {\n                        groupMembersList.innerHTML = availableMembers.map(friend => `\n                        <div class=\"member-item\">\n                            <input type=\"checkbox\" class=\"member-checkbox\" id=\"member-${friend.id}\" value=\"${friend.id}\">\n                            <label for=\"member-${friend.id}\" class=\"member-nickname\">${friend.nickname || friend.username}</label>\n                        </div>\n                    `).join('');\n                    }\n                })\n                .catch(error => {\n                    console.error('Error loading friends:', error);\n                    groupMembersList.innerHTML = '<div class=\"loading-members\"></div>';\n                });\n        },\n\n        // \n        bindCreateGroupSubmit: function() {\n            const submitButton = document.getElementById('submitCreateGroup');\n            if (submitButton) {\n                submitButton.addEventListener('click', () => {\n                    this.handleCreateGroupSubmit();\n                });\n            }\n        },\n\n        // \n        handleCreateGroupSubmit: function() {\n            const newGroupNameInput = document.getElementById('newGroupName');\n            const newGroupDescriptionInput = document.getElementById('newGroupDescription');\n            const createGroupMessage = document.getElementById('createGroupMessage');\n\n            const groupName = newGroupNameInput.value.trim();\n            const groupDescription = newGroupDescriptionInput.value.trim();\n\n            // ID\n            const selectedMemberCheckboxes = document.querySelectorAll('.member-checkbox:checked');\n            const selectedMemberIds = Array.from(selectedMemberCheckboxes).map(checkbox => checkbox.value);\n\n            // \n            if (!groupName) {\n                if (createGroupMessage) {\n                    createGroupMessage.textContent = '';\n                    createGroupMessage.className = 'create-group-message error';\n                }\n                return;\n            }\n\n            // 1\n            if (selectedMemberIds.length < 0) {\n                if (createGroupMessage) {\n                    createGroupMessage.textContent = '';\n                    createGroupMessage.className = 'create-group-message error';\n                }\n                return;\n            }\n\n            // \n            if (createGroupMessage) {\n                createGroupMessage.textContent = '';\n                createGroupMessage.className = 'create-group-message';\n            }\n\n            // fetch API\n            fetch(`${SERVER_URL}/create-group`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'user-id': currentUser.id,\n                    'session-token': currentSessionToken\n                },\n                body: JSON.stringify({\n                    userId: currentUser.id,\n                    groupName: groupName,\n                    description: groupDescription,\n                    memberIds: selectedMemberIds\n                })\n            })\n                .then(response => response.json())\n                .then(data => {\n                    if (data.status === 'success') {\n                        if (createGroupMessage) {\n                            createGroupMessage.textContent = '';\n                            createGroupMessage.className = 'create-group-message success';\n                        }\n\n                        // \n                        loadGroupList();\n\n                        // 1\n                        setTimeout(() => {\n                            this.hideModal('createGroupModal');\n                        }, 1000);\n                    } else {\n                        if (createGroupMessage) {\n                            createGroupMessage.textContent = data.message || '';\n                            createGroupMessage.className = 'create-group-message error';\n                        }\n                    }\n                })\n                .catch(error => {\n                    if (createGroupMessage) {\n                        createGroupMessage.textContent = '';\n                        createGroupMessage.className = 'create-group-message error';\n                    }\n                });\n        }\n    };\n\n    // \n    ModalManager.init();\n    // ModalManagerwindow\n    window.ModalManager = ModalManager;\n\n    // \n    window.openImagePreview = function(imageUrl) {\n        const modal = document.getElementById('imagePreviewModal');\n        const imgElement = document.getElementById('previewImgElement');\n        const closeBtn = document.getElementById('closeImagePreviewModal');\n\n        if (modal && imgElement) {\n            // \n            if (modal.style.display === 'flex') {\n                closeImagePreviewModal();\n            }\n\n            imgElement.src = imageUrl;\n            modal.style.display = 'flex';\n            document.body.style.overflow = 'hidden';\n        }\n\n        // \n        if (closeBtn) {\n            // \n            closeBtn.removeEventListener('click', closeImagePreviewModal);\n            closeBtn.addEventListener('click', closeImagePreviewModal);\n        } else {\n            // \n            if (modal) {\n                const closeBtnContainer = document.createElement('div');\n                closeBtnContainer.id = 'closeImagePreviewModal';\n                closeBtnContainer.style.position = 'absolute';\n                closeBtnContainer.style.top = '10px';\n                closeBtnContainer.style.right = '10px';\n                closeBtnContainer.style.width = '30px';\n                closeBtnContainer.style.height = '30px';\n                closeBtnContainer.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';\n                closeBtnContainer.style.color = 'white';\n                closeBtnContainer.style.borderRadius = '50%';\n                closeBtnContainer.style.display = 'flex';\n                closeBtnContainer.style.justifyContent = 'center';\n                closeBtnContainer.style.alignItems = 'center';\n                closeBtnContainer.style.cursor = 'pointer';\n                closeBtnContainer.style.zIndex = '1001';\n                closeBtnContainer.textContent = '';\n                closeBtnContainer.style.fontSize = '20px';\n                closeBtnContainer.style.fontWeight = 'bold';\n                \n                // \n                const existingCloseBtn = modal.querySelector('#closeImagePreviewModal');\n                if (!existingCloseBtn) {\n                    modal.appendChild(closeBtnContainer);\n                }\n                \n                // \n                closeBtnContainer.addEventListener('click', closeImagePreviewModal);\n            }\n        }\n\n        // \n        if (modal) {\n            // \n            modal.removeEventListener('click', handleModalBackgroundClick);\n            modal.addEventListener('click', handleModalBackgroundClick);\n        }\n    };\n\n    // \n    function closeImagePreviewModal() {\n        const modal = document.getElementById('imagePreviewModal');\n        if (modal) {\n            modal.style.display = 'none';\n            document.body.style.overflow = '';\n        }\n    }\n\n    // \n    function handleModalBackgroundClick(e) {\n        const modal = document.getElementById('imagePreviewModal');\n        if (e.target === modal) {\n            closeImagePreviewModal();\n        }\n    }\n\n    // openImagePreview\n    const closeBtn = document.getElementById('closeImagePreviewModal');\n    if (closeBtn) {\n        closeBtn.addEventListener('click', closeImagePreviewModal);\n    }\n\n    // \n    const imagePreviewModal = document.getElementById('imagePreviewModal');\n    if (imagePreviewModal) {\n        imagePreviewModal.addEventListener('click', handleModalBackgroundClick);\n    }\n\n    // \n    function addImageClickEvents() {\n        const images = document.querySelectorAll('.message-image');\n        images.forEach(img => {\n            if (!img.hasAttribute('data-click-added')) {\n                img.addEventListener('click', () => {\n                    const src = img.getAttribute('src');\n                    if (src) {\n                        openImagePreview(src);\n                    }\n                });\n                img.setAttribute('data-click-added', 'true');\n            }\n        });\n    }\n\n    // \n    function addCopyButtonEvents() {\n        const copyButtons = document.querySelectorAll('.copy-button');\n        copyButtons.forEach(button => {\n            if (!button.hasAttribute('data-click-added')) {\n                button.addEventListener('click', () => {\n                    const code = decodeURIComponent(button.getAttribute('data-code'));\n                    navigator.clipboard.writeText(code).then(() => {\n                        // \n                        const copyNotice = button.parentElement.querySelector('.copy-notice');\n                        if (copyNotice) {\n                            copyNotice.textContent = '';\n                            copyNotice.style.color = '#4CAF50';\n                            setTimeout(() => {\n                                copyNotice.textContent = '';\n                            }, 2000);\n                        }\n                    }).catch(err => {\n                        console.error(':', err);\n                    });\n                });\n                button.setAttribute('data-click-added', 'true');\n            }\n        });\n    }\n\n    // \n    addImageClickEvents();\n    addCopyButtonEvents();\n\n    // \n    const messageContainer = document.getElementById('messageContainer');\n    if (messageContainer) {\n        const observer = new MutationObserver(() => {\n            addImageClickEvents();\n            addCopyButtonEvents();\n        });\n        observer.observe(messageContainer, { childList: true, subtree: true });\n    }\n\n    // \n    const groupMessageContainer = document.getElementById('groupMessageContainer');\n    if (groupMessageContainer) {\n        const groupObserver = new MutationObserver(() => {\n            addImageClickEvents();\n            addCopyButtonEvents();\n        });\n        groupObserver.observe(groupMessageContainer, { childList: true, subtree: true });\n    }\n\n    // \n    const privateMessageContainer = document.getElementById('privateMessageContainer');\n    if (privateMessageContainer) {\n        const privateObserver = new MutationObserver(() => {\n            addImageClickEvents();\n            addCopyButtonEvents();\n        });\n        privateObserver.observe(privateMessageContainer, { childList: true, subtree: true });\n    }\n\n    // \n    window.updateAllMessagesNickname = function updateAllMessagesNickname(userId, newNickname) {\n        // \n        if (!userId || typeof userId !== 'string' || !newNickname || typeof newNickname !== 'string') {\n            return;\n        }\n\n        // \n        const messages = document.querySelectorAll('.message');\n        messages.forEach(message => {\n            const messageHeader = message.querySelector('.message-header');\n            if (messageHeader) {\n                // \n                const isOwn = message.classList.contains('own-message');\n                if (isOwn && currentUser && String(currentUser.id) === String(userId)) {\n                    // \n                    const senderNickname = messageHeader.querySelector('.message-sender');\n                    if (senderNickname) {\n                        senderNickname.textContent = newNickname;\n                    }\n                } else {\n                    // \n                    // \n                    // data-user-id\n                    const messageUserId = message.getAttribute('data-user-id');\n                    if (messageUserId && String(messageUserId) === String(userId)) {\n                        const senderNickname = messageHeader.querySelector('.message-sender');\n                        if (senderNickname) {\n                            senderNickname.textContent = newNickname;\n                        }\n                    }\n                }\n            }\n        });\n    };\n}\n\n// \nfunction enableMessageSending() {\n    const messageInput = document.getElementById('messageInput');\n    const sendButton = document.getElementById('sendButton');\n    const imageUploadButton = document.getElementById('imageUploadButton');\n    const fileUploadButton = document.getElementById('fileUploadButton');\n\n    if (messageInput) {\n        messageInput.removeAttribute('disabled');\n        messageInput.placeholder = '...';\n    }\n\n    if (sendButton) {\n        sendButton.removeAttribute('disabled');\n    }\n\n    if (imageUploadButton) {\n        imageUploadButton.removeAttribute('disabled');\n    }\n\n    if (fileUploadButton) {\n        fileUploadButton.removeAttribute('disabled');\n    }\n\n    // \n    const groupMessageInput = document.getElementById('groupMessageInput');\n    const sendGroupMessageBtn = document.getElementById('sendGroupMessage');\n    const groupImageUploadButton = document.getElementById('groupImageUploadButton');\n    const groupFileUploadButton = document.getElementById('groupFileUploadButton');\n\n    if (groupMessageInput) {\n        groupMessageInput.removeAttribute('disabled');\n        groupMessageInput.placeholder = '...';\n    }\n\n    if (sendGroupMessageBtn) {\n        sendGroupMessageBtn.removeAttribute('disabled');\n    }\n\n    if (groupImageUploadButton) {\n        groupImageUploadButton.removeAttribute('disabled');\n    }\n\n    if (groupFileUploadButton) {\n        groupFileUploadButton.removeAttribute('disabled');\n    }\n}\n\n// \nfunction disableMessageSending() {\n    // \n    // WebSocket\n    if (!currentUser || !currentSessionToken) {\n        const messageInput = document.getElementById('messageInput');\n        const sendButton = document.getElementById('sendButton');\n        const imageUploadButton = document.getElementById('imageUploadButton');\n        const fileUploadButton = document.getElementById('fileUploadButton');\n\n        if (messageInput) {\n            messageInput.setAttribute('disabled', 'disabled');\n            messageInput.placeholder = '';\n        }\n\n        if (sendButton) {\n            sendButton.setAttribute('disabled', 'disabled');\n        }\n\n        if (imageUploadButton) {\n            imageUploadButton.setAttribute('disabled', 'disabled');\n        }\n\n        if (fileUploadButton) {\n            fileUploadButton.setAttribute('disabled', 'disabled');\n        }\n\n        // \n        const groupMessageInput = document.getElementById('groupMessageInput');\n        const sendGroupMessageBtn = document.getElementById('sendGroupMessage');\n        const groupImageUploadButton = document.getElementById('groupImageUploadButton');\n        const groupFileUploadButton = document.getElementById('groupFileUploadButton');\n\n        if (groupMessageInput) {\n            groupMessageInput.setAttribute('disabled', 'disabled');\n            groupMessageInput.placeholder = '';\n        }\n\n        if (sendGroupMessageBtn) {\n            sendGroupMessageBtn.setAttribute('disabled', 'disabled');\n        }\n\n        if (groupImageUploadButton) {\n            groupImageUploadButton.setAttribute('disabled', 'disabled');\n        }\n\n        if (groupFileUploadButton) {\n            groupFileUploadButton.setAttribute('disabled', 'disabled');\n        }\n    }\n}\n\n// \nfunction loadOfflineUsers() {\n    if (!currentUser || !currentSessionToken) return;\n\n    fetch(`${SERVER_URL}/offline-users`, {\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                updateOfflineUserList(data.users);\n            }\n        })\n        .catch(error => {\n        });\n}\n\n// \nfunction updateOfflineUserList(users) {\n    const offlineUserList = document.getElementById('offlineUserList');\n    if (!offlineUserList) return;\n\n    offlineUserList.innerHTML = '';\n\n    if (!users || users.length === 0) {\n        offlineUserList.innerHTML = '<li></li>';\n        return;\n    }\n\n    // \n    const filteredOfflineUsers = users.filter(offlineUser => {\n        return !onlineUsersList.some(onlineUser => onlineUser.id == offlineUser.id);\n    });\n\n    if (filteredOfflineUsers.length === 0) {\n        offlineUserList.innerHTML = '<li></li>';\n        return;\n    }\n\n    filteredOfflineUsers.forEach(user => {\n        const li = document.createElement('li');\n\n        // URLUI\n        let avatarUrl = '';\n        if (user.avatarUrl && typeof user.avatarUrl === 'string') {\n            avatarUrl = user.avatarUrl.trim();\n        } else if (user.avatar_url && typeof user.avatar_url === 'string') {\n            avatarUrl = user.avatar_url.trim();\n        } else if (user.avatar && typeof user.avatar === 'string') {\n            avatarUrl = user.avatar.trim();\n        }\n\n        // \n        let avatarHtml = '';\n        // URLSVG\n        const isSvgAvatar = avatarUrl && /\\.svg$/i.test(avatarUrl);\n        if (avatarUrl && !isSvgAvatar) {\n            avatarHtml = `<span class=\"user-avatar\"><img src=\"${SERVER_URL}${avatarUrl}\" alt=\"${user.nickname}\"></span>`;\n        } else {\n            const initials = user.nickname.charAt(0).toUpperCase();\n            avatarHtml = `<span class=\"user-avatar\">${initials}</span>`;\n        }\n\n        // data-user-id\n        li.setAttribute('data-user-id', user.id);\n\n        li.innerHTML = `\n            ${avatarHtml}\n            <span class=\"user-name\">${user.nickname}</span>\n            <span class=\"user-status offline\"></span>\n        `;\n\n        // \n        li.style.padding = '8px 0';\n        li.style.borderBottom = '1px solid #f1f1f1';\n        li.style.display = 'flex';\n        li.style.alignItems = 'center';\n        li.className = 'user-item';\n\n        offlineUserList.appendChild(li);\n    });\n\n    // \n    addAvatarClickListeners();\n}\n\n// handleReceivedMessageSocket.io\n\n// \nfunction displayMessage(message, returnElement = false) {\n    const messageContainer = document.getElementById('messageContainer');\n    \n    // \n    if (!message) {\n        return;\n    }\n\n    // ID\n    if (messageContainer && document.querySelector(`#messageContainer [data-id=\"${message.id}\"]`)) {\n        return;\n    }\n\n    // messageContainerchatHistory\n    if (!messageContainer && !chatHistory) {\n        return;\n    }\n\n    // contentnull\n    // messageType0=1=2=\n    if (!message.messageType && !message.content && !message.imageUrl && !message.fileUrl && !message.text) {\n        return;\n    }\n\n    // userIdnickname\n    const messageUser = message.user || {\n        id: message.userId,\n        nickname: message.nickname,\n        avatarUrl: message.avatarUrl\n    };\n\n    // \n    const senderId = messageUser.id;\n    const senderNickname = messageUser.nickname || '';\n    const senderAvatarUrl = messageUser.avatarUrl;\n    const isOwn = currentUser && String(currentUser.id) === String(senderId);\n\n    const messageElement = document.createElement('div');\n    // \n    messageElement.className = `message ${isOwn ? 'own-message' : 'other-message'}`;\n    messageElement.setAttribute('data-id', message.id);\n\n    // sequence\n    if (message.sequence !== undefined) {\n        messageElement.setAttribute('data-sequence', message.sequence);\n    }\n\n    // \n    if (isOwn) {\n        messageElement.style.marginLeft = '20%';\n        messageElement.style.marginRight = '10px';\n        messageElement.style.backgroundColor = '#E8F5E8';\n        messageElement.style.borderRadius = '18px';\n        messageElement.style.padding = '10px 15px';\n        messageElement.style.maxWidth = '80%';\n        messageElement.style.minWidth = '70px'; // \n        messageElement.style.alignSelf = 'flex-end';\n    } else {\n        messageElement.style.marginLeft = '10px';\n        messageElement.style.marginRight = '20%';\n        messageElement.style.backgroundColor = '#FFFFFF';\n        messageElement.style.borderRadius = '18px';\n        messageElement.style.padding = '10px 15px';\n        messageElement.style.maxWidth = '80%';\n        messageElement.style.minWidth = '70px'; // \n        messageElement.style.alignSelf = 'flex-start';\n        messageElement.style.border = '1px solid #E0E0E0';\n    }\n    messageElement.style.display = 'flex';\n    messageElement.style.flexDirection = 'column';\n    messageElement.style.marginBottom = '10px';\n\n    // HTMLXSS\n    function escapeHtml(text) {\n        if (typeof text !== 'string') return text;\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n\n    // Markdown\n    let parsedContent = message.content || '';\n    if (typeof marked !== 'undefined') {\n        try {\n            // marked\n            const renderer = new marked.Renderer();\n\n            // codehighlightfigure\n            renderer.code = function({text, lang, escaped}) {\n                const language = lang || 'code';\n                const code = text;\n\n                // \n                const lines = code.split('\\n');\n                // brCSS\n                const lineNumbers = lines.map((_, index) => `<span class=\"line\">${index + 1}</span>`).join('');\n\n                // code\n                const encodedCode = encodeURIComponent(code);\n\n                // UIHTML\n                const html = `<figure class=\"highlight\">\n            <div class=\"highlight-tools\">\n                <div class=\"macStyle\">\n                    <div class=\"mac-close\"></div>\n                    <div class=\"mac-minimize\"></div>\n                    <div class=\"mac-maximize\"></div>\n                </div>\n                <div class=\"code-lang\">${language}</div>\n                <div class=\"copy-notice\"></div>\n                <i class=\"fas fa-paste copy-button\" data-code=\"${encodedCode}\"></i>\n                <i class=\"fa-solid fa-up-right-and-down-left-from-center fullpage-button\"></i>\n            </div>\n            <table>\n                <tbody>\n                    <tr>\n                        <td class=\"gutter\">\n                            <pre>${lineNumbers}</pre>\n                        </td>\n                        <td class=\"code\">\n                            <pre><code>${code}</code></pre>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </figure>`;\n\n                // HTML\n\n\n                return html;\n            };\n\n            marked.setOptions({\n                breaks: true, // <br>\n                gfm: true, // GitHub Flavored Markdown\n                renderer: renderer\n            });\n\n            // \n            let contentToParse = message.content || '';\n\n            // HTMLXSS\n            contentToParse = escapeHtml(contentToParse);\n\n            // URL\n            // URLURL\n            if (SERVER_URL) {\n                // URL\n                contentToParse = contentToParse.replace(/!\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (match, alt, url) => {\n                    // URL\n                    const trimmedUrl = url.trim();\n                    // URL\n                    if (trimmedUrl && !trimmedUrl.startsWith('http') && !trimmedUrl.startsWith('//')) {\n                        return `![${alt}](${SERVER_URL}${trimmedUrl})`;\n                    }\n                    return match;\n                });\n\n                // URL\n                contentToParse = contentToParse.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (match, text, url) => {\n                    // URL\n                    const trimmedUrl = url.trim();\n                    // URLURL\n                    if (trimmedUrl && !trimmedUrl.startsWith('http') && !trimmedUrl.startsWith('//')) {\n                        // URL\n                        if (/^[a-zA-Z0-9-]+\\.[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})?(:\\d+)?/.test(trimmedUrl)) {\n                            // URLhttps://\n                            return `[${text}](https://${trimmedUrl})`;\n                        } else {\n                            // \n                            return `[${text}](${SERVER_URL}${trimmedUrl})`;\n                        }\n                    }\n                    return match;\n                });\n\n                // URLMarkdownURL\n                // URL\n                // MarkdownURLURLURL\n                const urlRegex = /(?<!\\]\\()(?<!\\[)(?<!https?:\\/\\/[^?&\"'<>\\s]+\\?.*)(?<!https?:\\/\\/[^?&\"'<>\\s]+&.*)(https?:\\/\\/(?:[^\\s\"'<>]+))/g;\n                // URL\"\"\n                contentToParse = contentToParse.replace(urlRegex, '[$1]($1)');\n            }\n\n            parsedContent = marked.parse(contentToParse).trim();\n\n            // SVGXSS\n            parsedContent = parsedContent.replace(/<svg[^>]*>.*?<\\/svg>/gi, '[SVG]');\n\n            // HTML\n            // figure, table, tbody, tr, td, i\n            parsedContent = parsedContent.replace(/<(?!\\/?(a|img|div|span|br|p|h[1-6]|strong|em|code|pre|ul|ol|li|blockquote|figure|table|tbody|tr|td|i)\\b)[^>]*>/gi, '');\n\n\n\n            // \n            // \n            parsedContent = parsedContent.replace(/<a([^>]*)(href=\"([^\"]*)\")([^>]*)>([^<]*)<\\/a>/g, (match, attr1, hrefAttr, href, attr2, text) => {\n                // \n                const hasDownloadAttr = match.includes('download');\n                const isHttpLink = /^https?:\\/\\//i.test(href);\n                const isImageLink = /\\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(href);\n\n                // \n                const fileExtensions = /\\.(pdf|doc|docx|txt|rtf|xls|xlsx|csv|zip|rar|7z|tar|gz|mp3|wav|ogg|flac|mp4|avi|mov|wmv|flv|exe|dll|bat|sh|ppt|pptx|js|ts|html|css|php|py|java|c|cpp|cs|go|rb|swift|kt|svg)$/i;\n                const hasFileExtension = fileExtensions.test(href);\n\n                // \n                if (isImageLink) {\n                    return match;\n                }\n\n                // \n                if (hasDownloadAttr || (!isHttpLink && hasFileExtension)) {\n                    // \n                    const fileExtension = href.split('.').pop().toLowerCase();\n\n                    // \n                    let fileIcon = ''; // \n                    if (/^(pdf|doc|docx|txt|rtf)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    } else if (/^(xls|xlsx|csv)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    } else if (/^(zip|rar|7z|tar|gz)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    } else if (/^(jpg|jpeg|png|gif|bmp|webp)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    } else if (/^(mp3|wav|ogg|flac)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    } else if (/^(mp4|avi|mov|wmv|flv)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    } else if (/^(exe|dll|bat|sh)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    } else if (/^(ppt|pptx)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    } else if (/^(js|ts|html|css|php|py|java|c|cpp|cs|go|rb|swift|kt)$/i.test(fileExtension)) {\n                        fileIcon = '';\n                    }\n\n                    // \n                    return `<div class=\"file-link-container\"><a${attr1} ${hrefAttr}${attr2} target=\"_blank\"><span class=\"file-icon\">${fileIcon}</span><span>${text}</span></a></div>`;\n                }\n\n                return match;\n            });\n        } catch (error) {\n            // \n            parsedContent = escapeHtml(message.content);\n        }\n    } else {\n        // marked\n        parsedContent = escapeHtml(message.content);\n    }\n\n    // \n    parsedContent = parsedContent.replace(/<img/g, '<img class=\"message-image\" style=\"max-width: 100%; height: auto; cursor: pointer;\"');\n\n    // \n    parsedContent = parsedContent.replace(/<a/g, '<a class=\"message-link\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #3498db; text-decoration: none;\"');\n\n    // \n    // \n    parsedContent = parsedContent.replace(/<a([^>]*)(href=\"([^\"]*)\")([^>]*)>([^<]*)<\\/a>/g, (match, attr1, hrefAttr, href, attr2, text) => {\n        // \n        const hasDownloadAttr = match.includes('download');\n        const isHttpLink = /^https?:\\/\\//i.test(href);\n        const isImageLink = /\\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(href);\n\n        // \n        const fileExtensions = /\\.(pdf|doc|docx|txt|rtf|xls|xlsx|csv|zip|rar|7z|tar|gz|mp3|wav|ogg|flac|mp4|avi|mov|wmv|flv|exe|dll|bat|sh|ppt|pptx|js|ts|html|css|php|py|java|c|cpp|cs|go|rb|swift|kt|svg)$/i;\n        const hasFileExtension = fileExtensions.test(href);\n\n        // \n        if (isImageLink) {\n            return match;\n        }\n\n        // \n        if (hasDownloadAttr || (!isHttpLink && hasFileExtension)) {\n            // \n            const fileExtension = href.split('.').pop().toLowerCase();\n\n            // \n            let fileIcon = ''; // \n            if (/^(pdf|doc|docx|txt|rtf)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(xls|xlsx|csv)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(zip|rar|7z|tar|gz)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(jpg|jpeg|png|gif|bmp|webp)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(mp3|wav|ogg|flac)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(mp4|avi|mov|wmv|flv)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(exe|dll|bat|sh)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(ppt|pptx)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(js|ts|html|css|php|py|java|c|cpp|cs|go|rb|swift|kt)$/i.test(fileExtension)) {\n                fileIcon = '';\n            }\n\n            // \n            return `<div class=\"file-link-container\"><a${attr1} ${hrefAttr}${attr2} class=\"file-link\" target=\"_blank\"><span class=\"file-icon\">${fileIcon}</span><span>${text}</span></a></div>`;\n        }\n\n        // \n        return match;\n    });\n\n    // \n    // URL\n    if (message.filename && !message.fileUrl && !message.imageUrl && (!message.content || !message.content.includes(message.filename))) {\n        parsedContent += `<div class=\"message-filename\" style=\"margin-top: 5px; color: #666; font-size: 12px;\">${escapeHtml(message.filename)}</div>`;\n    }\n\n\n    // URLSVGXSS\n    let fullAvatarUrl = '';\n    // URLSVG\n    const isSvgAvatar = senderAvatarUrl &&\n        (typeof senderAvatarUrl === 'string' && /\\.svg$/i.test(senderAvatarUrl) ||\n            senderAvatarUrl.includes('.svg'));\n\n    if (senderAvatarUrl && !isSvgAvatar) {\n        fullAvatarUrl = `${SERVER_URL}${senderAvatarUrl}`;\n    }\n\n    // \n    const avatarHtml = fullAvatarUrl ?\n        `<img src=\"${fullAvatarUrl}\" alt=\"${senderNickname}\" class=\"user-avatar\" style=\"width: 32px; height: 32px; border-radius: 50%; margin-right: 10px;\">` :\n        `<div class=\"user-avatar default-avatar\" style=\"width: 32px; height: 32px; border-radius: 50%; margin-right: 10px; background-color: #e0e0e0; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #666;\">${senderNickname.charAt(0).toUpperCase()}</div>`;\n\n    // Markdown\n    let messageContent = '';\n\n    // \n    let imageUrl = message.imageUrl;\n    let fileUrl = message.fileUrl;\n    let filename = message.filename;\n    let textContent = message.content;\n    let groupCardData = null;\n\n    // \n    if (message.messageType !== undefined) {\n        switch (message.messageType) {\n            case 1: // \n                try {\n                    const imageData = JSON.parse(message.content);\n                    imageUrl = imageData.url;\n                    filename = imageData.filename;\n                    // \n                    if (imageData.width && imageData.height) {\n                        message.width = imageData.width;\n                        message.height = imageData.height;\n                    }\n                } catch (error) {\n                    console.error('JSON:', error);\n                    // \n                }\n                break;\n            case 2: // \n                try {\n                    const fileData = JSON.parse(message.content);\n                    fileUrl = fileData.url;\n                    filename = fileData.filename;\n                } catch (error) {\n                    console.error('JSON:', error);\n                }\n                break;\n            case 3: // \n                try {\n                    groupCardData = JSON.parse(message.content);\n                    // \n                    if (groupCardData.type === 'group_card' && groupCardData.group_id) {\n                        // \n                    } else {\n                        groupCardData = null;\n                    }\n                } catch (error) {\n                    console.error('JSON:', error);\n                    groupCardData = null;\n                }\n                break;\n            default: // \n                textContent = message.content;\n                break;\n        }\n    }\n\n    // \n    if (imageUrl && imageUrl !== null && imageUrl !== '') {\n        const imgSrc = imageUrl.startsWith('http') ? imageUrl : `${SERVER_URL}${imageUrl}`;\n\n        // \n        // \n        let widthAttr = '';\n        let heightAttr = '';\n        if (message.width && message.height) {\n            // \n            widthAttr = `width=\"${message.width}\"`;\n            heightAttr = `height=\"${message.height}\"`;\n        }\n\n        messageContent += `<img src=\"${escapeHtml(imgSrc)}\" alt=\"${escapeHtml(filename || '')}\" ${widthAttr} ${heightAttr} class=\"message-image\" style=\"max-width: 100%; height: auto; cursor: pointer;\">`;\n    }\n\n    // \n    if (fileUrl && fileUrl !== null && fileUrl !== '') {\n        const fullFileUrl = fileUrl.startsWith('http') ? fileUrl : `${SERVER_URL}${fileUrl}`;\n        const displayFilename = filename || '';\n        const fileExtension = displayFilename.split('.').pop().toLowerCase();\n\n        // \n        let fileIcon = '';\n        if (/^(pdf|doc|docx|txt|rtf)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(xls|xlsx|csv)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(zip|rar|7z|tar|gz)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(jpg|jpeg|png|gif|bmp|webp)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(mp3|wav|ogg|flac)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(mp4|avi|mov|wmv|flv)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(exe|dll|bat|sh)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(ppt|pptx)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(js|ts|html|css|php|py|java|c|cpp|cs|go|rb|swift|kt)$/i.test(fileExtension)) {\n            fileIcon = '';\n        }\n\n        messageContent += `<div class=\"file-link-container\"><a href=\"${escapeHtml(fullFileUrl)}\" class=\"file-link\" target=\"_blank\" style=\"color: #3498db; text-decoration: none;\"><span class=\"file-icon\">${fileIcon}</span><span>${escapeHtml(displayFilename)}</span></a></div>`;\n    }\n\n    // \n    if (groupCardData) {\n        messageContent += `\n            <div class=\"group-card-container\" style=\"background-color: #f0f8ff; border: 1px solid #3498db; border-radius: 8px; padding: 10px; cursor: pointer; margin-top: 5px;\">\n                <div class=\"group-card-header\" style=\"font-weight: bold; color: #3498db; margin-bottom: 5px; display: flex; align-items: center; gap: 8px;\">\n                    ${groupCardData.avatar_url ? `<img src=\"${SERVER_URL}${groupCardData.avatar_url}\" alt=\"${groupCardData.group_name}\" style=\"width: 20px; height: 20px; border-radius: 50%; object-fit: cover; cursor: pointer;\" onclick=\"openImagePreview('${SERVER_URL}${groupCardData.avatar_url}')\">` : `<div style=\"width: 20px; height: 20px; border-radius: 50%; background-color: #3498db; color: white; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold;\">${groupCardData.group_name.charAt(0).toUpperCase()}</div>`}\n                    ${groupCardData.group_name}\n                </div>\n                <div class=\"group-card-description\" style=\"color: #666; font-size: 14px; margin-bottom: 5px;\">\n                    ${groupCardData.group_description || ''}\n                </div>\n                <div class=\"group-card-footer\" style=\"font-size: 12px; color: #999;\">\n                    \n                </div>\n            </div>\n        `;\n    }\n\n    // \n    if ((parsedContent && parsedContent.trim() !== '') && !(fileUrl || imageUrl || groupCardData)) {\n        messageContent += parsedContent;\n    }\n\n    messageElement.innerHTML = `\n        <div class=\"message-header\" style=\"display: flex; align-items: center; margin-bottom: 5px;\">\n            ${avatarHtml}\n            <div style=\"flex: 1;\">\n                <span class=\"message-sender\" style=\"font-weight: bold;\">${senderNickname}</span>\n                <span class=\"message-time\" style=\"float: right; color: #999; font-size: 12px;\">${message.timestamp ? new Date(message.timestamp).toLocaleTimeString() : new Date().toLocaleTimeString()}</span>\n            </div>\n            ${isOwn ? `<button class=\"delete-button\" data-id=\"${message.id}\" title=\"\" style=\"background: none; border: none; color: #999; font-size: 16px; cursor: pointer; margin-left: 10px;\"></button>` : ''}\n        </div>\n        <div class=\"message-content\">${messageContent}</div>\n    `;\n\n    // \n    if (isOwn) {\n        const deleteButton = messageElement.querySelector('.delete-button');\n        if (deleteButton) {\n            deleteButton.addEventListener('click', function(e) {\n                e.stopPropagation();\n                const messageId = this.getAttribute('data-id');\n\n                // ID\n                if (messageId) {\n                    window.chatSocket.emit('delete-message', {\n                        messageId: messageId, // messageId\n                        sessionToken: currentSessionToken,\n                        userId: currentUser.id\n                    });\n                }\n            });\n        }\n    }\n\n    // \n    if (groupCardData) {\n        const groupCardElement = messageElement.querySelector('.group-card-container');\n        if (groupCardElement) {\n            groupCardElement.addEventListener('click', function(e) {\n                e.stopPropagation();\n                showGroupCardPopup(e, groupCardData);\n            });\n        }\n    }\n\n    // \n    const messageAvatar = messageElement.querySelector('.user-avatar');\n    if (messageAvatar) {\n        messageAvatar.addEventListener('click', (e) => {\n            e.stopPropagation();\n            showUserAvatarPopup(e, messageUser);\n        });\n    }\n\n    if (returnElement) {\n        // \n        return messageElement;\n    }\n\n    if (messageContainer) {\n        // \n        if (typeof renderMathInElement !== 'undefined') {\n            renderMathInElement(messageElement, {\n                delimiters: [\n                    {left: \"$$\", right: \"$$\", display: true},\n                    {left: \"$\" , right: \"$\" , display: false}\n                ]\n            });\n        }\n\n        // \n        const emptyState = messageContainer.querySelector('.empty-state');\n        if (emptyState) {\n            emptyState.style.display = 'none';\n        }\n\n        messageContainer.appendChild(messageElement);\n\n        // 150px\n        const distanceToBottom = messageContainer.scrollHeight - messageContainer.scrollTop - messageContainer.clientHeight;\n        const isAtBottom = distanceToBottom <= 150;\n        if (isAtBottom || isOwn) {\n            // setTimeoutDOM\n            setTimeout(() => {\n                messageContainer.scrollTop = messageContainer.scrollHeight;\n            }, 0);\n        }\n    } else if (chatHistory) {\n        // messageContainerchatHistorychatHistory\n        if (chatHistory.nodeType === 11) { // 11 \n            chatHistory.appendChild(messageElement.cloneNode(true));\n        } else if (typeof chatHistory === 'string') {\n            // chatHistory\n            chatHistory += messageElement.outerHTML;\n        }\n    }\n}\n\n// \nfunction displayGroupMessage(message, returnElement = false) {\n    const groupMessageContainer = document.getElementById('groupMessageContainer');\n    \n    // groupMessageContainerchatHistory\n    if (!groupMessageContainer && !chatHistory) {\n        return;\n    }\n\n    // \n    if (!message) {\n        return;\n    }\n\n    // IDID\n    // \n    // message.id\n    const messageGroupId = message.groupId;\n    // returnElement\n    const isHistoryMessage = returnElement || message.isHistory || false;\n    // \n    const currentChatId = String(currentActiveChat);\n    const msgGroupId = String(messageGroupId);\n\n    // IDID\n    if (messageGroupId && currentActiveChat && msgGroupId !== currentChatId && !isHistoryMessage) {\n        // \n        if (!groupMessageCache[msgGroupId]) {\n            groupMessageCache[msgGroupId] = [];\n        }\n        // \n        const isDuplicate = groupMessageCache[msgGroupId].some(m => m.id === message.id);\n        if (!isDuplicate) {\n            groupMessageCache[msgGroupId].push(message);\n        }\n        return;\n    }\n\n    // \n    // message.identifier\n    // CSS\n    function generateMessageHash(message) {\n        const content = message.content || message.text || 'empty';\n        const sender = message.userId || message.senderId || 'unknown';\n        const time = message.timestamp || message.createdAt || 'unknown';\n        const data = `${sender}-${time}-${JSON.stringify(content)}`;\n\n        // \n        let hash = 0;\n        for (let i = 0; i < data.length; i++) {\n            const char = data.charCodeAt(i);\n            hash = ((hash << 5) - hash) + char;\n            hash = hash & hash; // 32\n        }\n        return Math.abs(hash).toString(16);\n    }\n\n    const messageIdentifier = message.identifier || generateMessageHash(message);\n    if (document.querySelector(`#groupMessageContainer [data-identifier=\"${messageIdentifier}\"]`)) {\n        return;\n    }\n\n    // contentnull\n    // messageType0=1=2=\n    // \n    if (!message.messageType && !message.content && !message.imageUrl && !message.fileUrl && !message.text) {\n        return;\n    }\n\n    // userIdnickname\n    const messageUser = message.user || {\n        id: message.userId,\n        nickname: message.nickname,\n        avatarUrl: message.avatarUrl\n    };\n\n    // \n    const senderId = messageUser.id;\n    const senderNickname = messageUser.nickname || '';\n    const senderAvatarUrl = messageUser.avatarUrl;\n    const isOwn = currentUser && String(currentUser.id) === String(senderId);\n\n    const messageElement = document.createElement('div');\n    // \n    messageElement.className = `message ${isOwn ? 'own-message' : 'other-message'}`;\n    if (message.id) {\n        messageElement.setAttribute('data-id', message.id);\n    }\n    // \n    messageElement.setAttribute('data-identifier', messageIdentifier);\n\n    // sequence\n    if (message.sequence !== undefined) {\n        messageElement.setAttribute('data-sequence', message.sequence);\n    }\n\n    // \n    if (isOwn) {\n        messageElement.style.marginLeft = '20%';\n        messageElement.style.marginRight = '10px';\n        messageElement.style.backgroundColor = '#E8F5E8';\n        messageElement.style.borderRadius = '18px';\n        messageElement.style.padding = '10px 15px';\n        messageElement.style.maxWidth = '80%';\n        messageElement.style.alignSelf = 'flex-end';\n    } else {\n        messageElement.style.marginLeft = '10px';\n        messageElement.style.marginRight = '20%';\n        messageElement.style.backgroundColor = '#FFFFFF';\n        messageElement.style.borderRadius = '18px';\n        messageElement.style.padding = '10px 15px';\n        messageElement.style.maxWidth = '80%';\n        messageElement.style.alignSelf = 'flex-start';\n        messageElement.style.border = '1px solid #E0E0E0';\n    }\n    messageElement.style.display = 'flex';\n    messageElement.style.flexDirection = 'column';\n    messageElement.style.marginBottom = '10px';\n\n    // HTMLXSS\n    function escapeHtml(text) {\n        if (typeof text !== 'string') return text;\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n\n    // Markdown\n    let parsedContent = message.content || '';\n    if (typeof marked !== 'undefined') {\n        try {\n            // marked\n            const renderer = new marked.Renderer();\n\n            // codehighlightfigure\n            renderer.code = function({text, lang, escaped}) {\n                const language = lang || 'code';\n                const code = text;\n\n                // \n                const lines = code.split('\\n');\n                // brCSS\n                const lineNumbers = lines.map((_, index) => `<span class=\"line\">${index + 1}</span>`).join('');\n\n                // code\n                const encodedCode = encodeURIComponent(code);\n\n                // UIHTML\n                const html = `<figure class=\"highlight\">\n            <div class=\"highlight-tools\">\n                <div class=\"macStyle\">\n                    <div class=\"mac-close\"></div>\n                    <div class=\"mac-minimize\"></div>\n                    <div class=\"mac-maximize\"></div>\n                </div>\n                <div class=\"code-lang\">${language}</div>\n                <div class=\"copy-notice\"></div>\n                <i class=\"fas fa-paste copy-button\" data-code=\"${encodedCode}\"></i>\n                <i class=\"fa-solid fa-up-right-and-down-left-from-center fullpage-button\"></i>\n            </div>\n            <table>\n                <tbody>\n                    <tr>\n                        <td class=\"gutter\">\n                            <pre>${lineNumbers}</pre>\n                        </td>\n                        <td class=\"code\">\n                            <pre><code>${code}</code></pre>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </figure>`;\n\n                // HTML\n\n\n                return html;\n            };\n\n            marked.setOptions({\n                breaks: true, // <br>\n                gfm: true, // GitHub Flavored Markdown\n                renderer: renderer\n            });\n\n            // \n            let contentToParse = message.content || '';\n\n            // HTMLXSS\n            contentToParse = escapeHtml(contentToParse);\n\n            // URL\n            // URLURL\n            if (SERVER_URL) {\n                // URL\n                contentToParse = contentToParse.replace(/!\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (match, alt, url) => {\n                    // URL\n                    const trimmedUrl = url.trim();\n                    // URL\n                    if (trimmedUrl && !trimmedUrl.startsWith('http') && !trimmedUrl.startsWith('//')) {\n                        return `![${alt}](${SERVER_URL}${trimmedUrl})`;\n                    }\n                    return match;\n                });\n\n                // URL\n                contentToParse = contentToParse.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (match, text, url) => {\n                    // URL\n                    const trimmedUrl = url.trim();\n                    // URLURL\n                    if (trimmedUrl && !trimmedUrl.startsWith('http') && !trimmedUrl.startsWith('//')) {\n                        // URL\n                        if (/^[a-zA-Z0-9-]+\\.[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})?(:\\d+)?/.test(trimmedUrl)) {\n                            // URLhttps://\n                            return `[${text}](https://${trimmedUrl})`;\n                        } else {\n                            // \n                            return `[${text}](${SERVER_URL}${trimmedUrl})`;\n                        }\n                    }\n                    return match;\n                });\n\n                // URLMarkdownURL\n                // URL\n                // MarkdownURLURLURL\n                const urlRegex = /(?<!\\]\\()(?<!\\[)(?<!https?:\\/\\/[^?&\"'<>\\s]+\\?.*)(?<!https?:\\/\\/[^?&\"'<>\\s]+&.*)(https?:\\/\\/(?:[^\\s\"'<>]+))/g;\n                // URL\"\"\n                contentToParse = contentToParse.replace(urlRegex, '[$1]($1)');\n            }\n\n            parsedContent = marked.parse(contentToParse).trim();\n\n            // SVGXSS\n            parsedContent = parsedContent.replace(/<svg[^>]*>.*?<\\/svg>/gi, '[SVG]');\n\n            // HTML\n            // figure, table, tbody, tr, td, i\n            parsedContent = parsedContent.replace(/<(?!\\/?(a|img|div|span|br|p|h[1-6]|strong|em|code|pre|ul|ol|li|blockquote|figure|table|tbody|tr|td|i)\\b)[^>]*>/gi, '');\n        } catch (error) {\n            // \n            parsedContent = escapeHtml(message.content);\n        }\n    } else {\n        // marked\n        parsedContent = escapeHtml(message.content);\n    }\n\n    // \n    parsedContent = parsedContent.replace(/<img/g, '<img class=\"message-image\" style=\"max-width: 100%; height: auto; cursor: pointer;\"');\n\n    // \n    parsedContent = parsedContent.replace(/<a/g, '<a class=\"message-link\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #3498db; text-decoration: none;\"');\n\n    // \n    // \n    parsedContent = parsedContent.replace(/<a([^>]*)(href=\"([^\"]*)\")([^>]*)>([^<]*)<\\/a>/g, (match, attr1, hrefAttr, href, attr2, text) => {\n        // \n        const hasDownloadAttr = match.includes('download');\n        const isHttpLink = /^https?:\\/\\//i.test(href);\n        const isImageLink = /\\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(href);\n\n        // \n        const fileExtensions = /\\.(pdf|doc|docx|txt|rtf|xls|xlsx|csv|zip|rar|7z|tar|gz|mp3|wav|ogg|flac|mp4|avi|mov|wmv|flv|exe|dll|bat|sh|ppt|pptx|js|ts|html|css|php|py|java|c|cpp|cs|go|rb|swift|kt|svg)$/i;\n        const hasFileExtension = fileExtensions.test(href);\n\n        // \n        if (isImageLink) {\n            return match;\n        }\n\n        // \n        if (hasDownloadAttr || (!isHttpLink && hasFileExtension)) {\n            // \n            const fileExtension = href.split('.').pop().toLowerCase();\n\n            // \n            let fileIcon = ''; // \n            if (/^(pdf|doc|docx|txt|rtf)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(xls|xlsx|csv)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(zip|rar|7z|tar|gz)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(jpg|jpeg|png|gif|bmp|webp)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(mp3|wav|ogg|flac)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(mp4|avi|mov|wmv|flv)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(exe|dll|bat|sh)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(ppt|pptx)$/i.test(fileExtension)) {\n                fileIcon = '';\n            } else if (/^(js|ts|html|css|php|py|java|c|cpp|cs|go|rb|swift|kt)$/i.test(fileExtension)) {\n                fileIcon = '';\n            }\n\n            // \n            return `<div class=\"file-link-container\"><a${attr1} ${hrefAttr}${attr2} class=\"file-link\" target=\"_blank\"><span class=\"file-icon\">${fileIcon}</span><span>${text}</span></a></div>`;\n        }\n\n        // \n        return match;\n    });\n\n    // \n    // URL\n    if (message.filename && !message.fileUrl && !message.imageUrl && (!message.content || !message.content.includes(message.filename))) {\n        parsedContent += `<div class=\"message-filename\" style=\"margin-top: 5px; color: #666; font-size: 12px;\">${escapeHtml(message.filename)}</div>`;\n    }\n\n\n    // URLSVGXSS\n    let fullAvatarUrl = '';\n    // URLSVG\n    const isSvgAvatar = senderAvatarUrl &&\n        (typeof senderAvatarUrl === 'string' && /\\.svg$/i.test(senderAvatarUrl) ||\n            senderAvatarUrl.includes('.svg'));\n\n    if (senderAvatarUrl && !isSvgAvatar) {\n        fullAvatarUrl = `${SERVER_URL}${senderAvatarUrl}`;\n    }\n\n    // \n    const avatarHtml = fullAvatarUrl ?\n        `<img src=\"${fullAvatarUrl}\" alt=\"${senderNickname}\" class=\"user-avatar\" style=\"width: 32px; height: 32px; border-radius: 50%; margin-right: 10px;\">` :\n        `<div class=\"user-avatar default-avatar\" style=\"width: 32px; height: 32px; border-radius: 50%; margin-right: 10px; background-color: #e0e0e0; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #666;\">${senderNickname.charAt(0).toUpperCase()}</div>`;\n\n    // Markdown\n    let messageContent = '';\n\n    // \n    let imageUrl = message.imageUrl;\n    let fileUrl = message.fileUrl;\n    let filename = message.filename;\n    let textContent = message.content;\n    let groupCardData = null;\n\n    // \n    if (message.messageType !== undefined) {\n        switch (message.messageType) {\n            case 1: // \n                try {\n                    const imageData = JSON.parse(message.content);\n                    imageUrl = imageData.url;\n                    filename = imageData.filename;\n                } catch (error) {\n                    console.error('JSON:', error);\n                }\n                break;\n            case 2: // \n                try {\n                    const fileData = JSON.parse(message.content);\n                    fileUrl = fileData.url;\n                    filename = fileData.filename;\n                } catch (error) {\n                    console.error('JSON:', error);\n                }\n                break;\n            case 3: // \n                try {\n                    groupCardData = JSON.parse(message.content);\n                    // \n                    if (groupCardData.type === 'group_card' && groupCardData.group_id) {\n                        // \n                    } else {\n                        groupCardData = null;\n                    }\n                } catch (error) {\n                    console.error('JSON:', error);\n                    groupCardData = null;\n                }\n                break;\n            default: // \n                textContent = message.content;\n                break;\n        }\n    }\n\n    // \n    if (imageUrl && imageUrl !== null && imageUrl !== '') {\n        const imgSrc = imageUrl.startsWith('http') ? imageUrl : `${SERVER_URL}${imageUrl}`;\n        messageContent += `<img src=\"${escapeHtml(imgSrc)}\" alt=\"${escapeHtml(filename || '')}\" class=\"message-image\" style=\"max-width: 100%; height: auto; cursor: pointer;\">`;\n    }\n\n    // \n    if (fileUrl && fileUrl !== null && fileUrl !== '') {\n        const fileFullUrl = fileUrl.startsWith('http') ? fileUrl : `${SERVER_URL}${fileUrl}`;\n        const displayFilename = filename || '';\n        const fileExtension = displayFilename.split('.').pop().toLowerCase();\n\n        // \n        let fileIcon = '';\n        if (/^(pdf|doc|docx|txt|rtf)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(xls|xlsx|csv)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(zip|rar|7z|tar|gz)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(jpg|jpeg|png|gif|bmp|webp)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(mp3|wav|ogg|flac)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(mp4|avi|mov|wmv|flv)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(exe|dll|bat|sh)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(ppt|pptx)$/i.test(fileExtension)) {\n            fileIcon = '';\n        } else if (/^(js|ts|html|css|php|py|java|c|cpp|cs|go|rb|swift|kt)$/i.test(fileExtension)) {\n            fileIcon = '';\n        }\n\n        messageContent += `<div class=\"file-link-container\"><a href=\"${escapeHtml(fileFullUrl)}\" class=\"file-link\" target=\"_blank\" style=\"color: #3498db; text-decoration: none;\"><span class=\"file-icon\">${fileIcon}</span><span>${escapeHtml(displayFilename)}</span></a></div>`;\n    }\n\n    // \n    if (groupCardData) {\n        messageContent += `\n            <div class=\"group-card-container\" style=\"background-color: #f0f8ff; border: 1px solid #3498db; border-radius: 8px; padding: 10px; cursor: pointer; margin-top: 5px;\">\n                <div class=\"group-card-header\" style=\"font-weight: bold; color: #3498db; margin-bottom: 5px; display: flex; align-items: center; gap: 8px;\">\n                    ${groupCardData.avatar_url ? `<img src=\"${SERVER_URL}${groupCardData.avatar_url}\" alt=\"${groupCardData.group_name}\" style=\"width: 20px; height: 20px; border-radius: 50%; object-fit: cover; cursor: pointer;\" onclick=\"openImagePreview('${SERVER_URL}${groupCardData.avatar_url}')\">` : `<div style=\"width: 20px; height: 20px; border-radius: 50%; background-color: #3498db; color: white; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold;\">${groupCardData.group_name.charAt(0).toUpperCase()}</div>`}\n                    ${groupCardData.group_name}\n                </div>\n                <div class=\"group-card-description\" style=\"color: #666; font-size: 14px; margin-bottom: 5px;\">\n                    ${groupCardData.group_description || ''}\n                </div>\n                <div class=\"group-card-footer\" style=\"font-size: 12px; color: #999;\">\n                    \n                </div>\n            </div>\n        `;\n    }\n\n    // \n    if ((parsedContent && parsedContent.trim() !== '') && !(fileUrl || imageUrl || groupCardData)) {\n        messageContent += parsedContent;\n    }\n\n    messageElement.innerHTML = `\n        <div class=\"message-header\" style=\"display: flex; align-items: center; margin-bottom: 5px;\">\n            ${avatarHtml}\n            <div style=\"flex: 1;\">\n                <span class=\"message-sender\" style=\"font-weight: bold;\">${senderNickname}</span>\n                <span class=\"message-time\" style=\"float: right; color: #999; font-size: 12px;\">${message.timestamp ? new Date(message.timestamp).toLocaleTimeString() : new Date().toLocaleTimeString()}</span>\n            </div>\n            ${isOwn ? `<button class=\"delete-button\" data-id=\"${message.id}\" title=\"\" style=\"background: none; border: none; color: #999; font-size: 16px; cursor: pointer; margin-left: 10px;\"></button>` : ''}\n        </div>\n        <div class=\"message-content\">${messageContent}</div>\n    `;\n\n    // \n    if (isOwn) {\n        const deleteButton = messageElement.querySelector('.delete-button');\n        if (deleteButton) {\n            deleteButton.addEventListener('click', function(e) {\n                e.stopPropagation();\n                const messageId = this.getAttribute('data-id');\n\n                // IDUI\n                if (messageId) {\n                    window.chatSocket.emit('delete-message', {\n                        messageId: messageId, // messageId\n                        sessionToken: currentSessionToken,\n                        userId: currentUser.id\n                    });\n                }\n            });\n        }\n    }\n\n    // \n    if (groupCardData) {\n        const groupCardElement = messageElement.querySelector('.group-card-container');\n        if (groupCardElement) {\n            groupCardElement.addEventListener('click', function(e) {\n                e.stopPropagation();\n                showGroupCardPopup(e, groupCardData);\n            });\n        }\n    }\n\n    // \n    const groupMessageAvatar = messageElement.querySelector('.user-avatar');\n    if (groupMessageAvatar) {\n        groupMessageAvatar.addEventListener('click', (e) => {\n            e.stopPropagation();\n            showUserAvatarPopup(e, messageUser);\n        });\n    }\n\n    if (returnElement) {\n        // \n        return messageElement;\n    }\n\n    if (groupMessageContainer) {\n        // \n        if (typeof renderMathInElement !== 'undefined') {\n            renderMathInElement(messageElement, {\n                delimiters: [\n                    {left: \"$$\", right: \"$$\", display: true},\n                    {left: \"$\" , right: \"$\" , display: false}\n                ]\n            });\n        }\n\n        // \n        const groupEmptyState = groupMessageContainer.querySelector('.empty-state');\n        if (groupEmptyState) {\n            groupEmptyState.style.display = 'none';\n        }\n\n        groupMessageContainer.appendChild(messageElement);\n\n        // group-chat-history\n        // \n    } else if (chatHistory) {\n        // groupMessageContainerchatHistorychatHistory\n        if (chatHistory.nodeType === 11) { // 11 \n            chatHistory.appendChild(messageElement.cloneNode(true));\n        } else if (typeof chatHistory === 'string') {\n            // chatHistory\n            chatHistory += messageElement.outerHTML;\n        }\n    }\n}\n\n// \nfunction initializeFocusListeners() {\n    // \n    document.addEventListener('visibilitychange', handlePageVisibilityChange);\n\n    // \n    window.addEventListener('focus', handleFocusChange);\n    window.addEventListener('blur', handleFocusChange);\n}\n\n// \nexport function initializeMoreButtons() {\n    // \n    const moreButton = document.getElementById('moreButton');\n    const mainMoreFunctions = document.getElementById('mainMoreFunctions');\n    const mainInputContainer = document.getElementById('mainInputContainer');\n\n    if (moreButton && mainMoreFunctions && mainInputContainer) {\n        // \n        const newMoreButton = moreButton.cloneNode(true);\n        moreButton.parentNode.replaceChild(newMoreButton, moreButton);\n        // \n        newMoreButton.addEventListener('click', function() {\n            mainMoreFunctions.classList.toggle('show');\n            mainInputContainer.classList.toggle('lifted');\n        });\n    }\n\n    // \n    const groupMoreButton = document.getElementById('groupMoreButton');\n    const groupMoreFunctions = document.getElementById('groupMoreFunctions');\n    const groupInputContainer = document.getElementById('groupInputContainer');\n\n    if (groupMoreButton && groupMoreFunctions && groupInputContainer) {\n        // \n        const newGroupMoreButton = groupMoreButton.cloneNode(true);\n        groupMoreButton.parentNode.replaceChild(newGroupMoreButton, groupMoreButton);\n        // \n        newGroupMoreButton.addEventListener('click', function() {\n            groupMoreFunctions.classList.toggle('show');\n            groupInputContainer.classList.toggle('lifted');\n        });\n    }\n\n    // \n    const privateMoreButton = document.getElementById('privateMoreButton');\n    const privateMoreFunctions = document.getElementById('privateMoreFunctions');\n    const privateInputContainer = document.getElementById('privateInputContainer');\n\n    if (privateMoreButton && privateMoreFunctions && privateInputContainer) {\n        // \n        const newPrivateMoreButton = privateMoreButton.cloneNode(true);\n        privateMoreButton.parentNode.replaceChild(newPrivateMoreButton, privateMoreButton);\n        // \n        newPrivateMoreButton.addEventListener('click', function() {\n            privateMoreFunctions.classList.toggle('show');\n            privateInputContainer.classList.toggle('lifted');\n        });\n    }\n\n    // \n    const sendGroupCardButton = document.getElementById('sendGroupCardButton');\n    const sendGroupCardButtonGroup = document.getElementById('sendGroupCardButtonGroup');\n    const privateSendGroupCardButton = document.getElementById('privateSendGroupCardButton');\n\n    // console.log(' :', { sendGroupCardButton, sendGroupCardButtonGroup, privateSendGroupCardButton });\n\n    if (sendGroupCardButton) {\n        // \n        const newSendGroupCardButton = sendGroupCardButton.cloneNode(true);\n        sendGroupCardButton.parentNode.replaceChild(newSendGroupCardButton, sendGroupCardButton);\n        // \n        newSendGroupCardButton.addEventListener('click', function() {\n            // console.log('  ');\n            showSendGroupCardModal('main');\n        });\n    }\n\n    if (sendGroupCardButtonGroup) {\n        // \n        const newSendGroupCardButtonGroup = sendGroupCardButtonGroup.cloneNode(true);\n        sendGroupCardButtonGroup.parentNode.replaceChild(newSendGroupCardButtonGroup, sendGroupCardButtonGroup);\n        // \n        newSendGroupCardButtonGroup.addEventListener('click', function() {\n            // console.log('  ');\n            showSendGroupCardModal('group');\n        });\n    }\n\n    if (privateSendGroupCardButton) {\n        // \n        const newPrivateSendGroupCardButton = privateSendGroupCardButton.cloneNode(true);\n        privateSendGroupCardButton.parentNode.replaceChild(newPrivateSendGroupCardButton, privateSendGroupCardButton);\n        // \n        newPrivateSendGroupCardButton.addEventListener('click', function() {\n            // console.log('  ');\n            showSendGroupCardModal('private');\n        });\n    }\n\n    // \n    const closeSendGroupCardModal = document.getElementById('closeSendGroupCardModal');\n    const cancelSendGroupCard = document.getElementById('cancelSendGroupCard');\n    const confirmSendGroupCard = document.getElementById('confirmSendGroupCard');\n\n    // console.log(' :', { closeSendGroupCardModal, cancelSendGroupCard, confirmSendGroupCard });\n\n    if (closeSendGroupCardModal) {\n        // \n        const newCloseSendGroupCardModal = closeSendGroupCardModal.cloneNode(true);\n        closeSendGroupCardModal.parentNode.replaceChild(newCloseSendGroupCardModal, closeSendGroupCardModal);\n        // \n        newCloseSendGroupCardModal.addEventListener('click', function() {\n            const modal = document.getElementById('sendGroupCardModal');\n            if (modal) {\n                modal.style.display = 'none';\n                document.body.style.overflow = '';\n            }\n        });\n    }\n\n    if (cancelSendGroupCard) {\n        // \n        const newCancelSendGroupCard = cancelSendGroupCard.cloneNode(true);\n        cancelSendGroupCard.parentNode.replaceChild(newCancelSendGroupCard, cancelSendGroupCard);\n        // \n        newCancelSendGroupCard.addEventListener('click', function() {\n            const modal = document.getElementById('sendGroupCardModal');\n            if (modal) {\n                modal.style.display = 'none';\n                document.body.style.overflow = '';\n            }\n        });\n    }\n\n    if (confirmSendGroupCard) {\n        // \n        const newConfirmSendGroupCard = confirmSendGroupCard.cloneNode(true);\n        confirmSendGroupCard.parentNode.replaceChild(newConfirmSendGroupCard, confirmSendGroupCard);\n        // \n        newConfirmSendGroupCard.addEventListener('click', function() {\n            sendGroupCard();\n        });\n    }\n\n\n}\n\n// \n\n// \nfunction showSendGroupCardModal(chatType) {\n    currentSendChatType = chatType;\n    selectedGroupIdForCard = null;\n\n    const modal = document.getElementById('sendGroupCardModal');\n    const sendGroupCardList = document.getElementById('sendGroupCardList');\n\n    if (!modal) {\n        return;\n    }\n\n    // \n    modal.style.display = 'flex';\n    modal.style.justifyContent = 'center';\n    modal.style.alignItems = 'center';\n    modal.style.zIndex = '1000';\n    document.body.style.overflow = 'hidden';\n\n    // \n    sendGroupCardList.innerHTML = '';\n\n    // \n    fetch(`${SERVER_URL}/user-groups/${currentUser.id}`, {\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                const groups = data.groups;\n\n                if (groups.length === 0) {\n                    sendGroupCardList.innerHTML = '<div style=\"text-align: center; color: #666; padding: 20px;\"></div>';\n                } else {\n                    groups.forEach(group => {\n                        const groupItem = document.createElement('div');\n                        groupItem.className = 'send-group-card-item';\n                        groupItem.style.display = 'flex';\n                        groupItem.style.alignItems = 'center';\n                        groupItem.style.margin = '10px 0';\n                        groupItem.style.padding = '10px';\n                        groupItem.style.borderRadius = '5px';\n                        groupItem.style.cursor = 'pointer';\n                        groupItem.style.border = '1px solid #ddd';\n                        groupItem.style.transition = 'background-color 0.3s';\n\n                        // textContentXSS\n                        const label = document.createElement('label');\n                        label.setAttribute('for', `group-${group.id}`);\n                        label.style.marginLeft = '10px';\n                        label.style.cursor = 'pointer';\n                        label.style.flex = '1';\n                        // \n                        const originalGroupName = unescapeHtml(group.group_name || group.name || '');\n                        label.textContent = originalGroupName;\n\n                        // \n                        const radio = document.createElement('input');\n                        radio.setAttribute('type', 'radio');\n                        radio.setAttribute('name', 'selectedGroup');\n                        radio.setAttribute('value', group.id);\n                        radio.setAttribute('id', `group-${group.id}`);\n                        radio.className = 'send-group-card-radio';\n\n                        // \n                        groupItem.innerHTML = '';\n                        groupItem.appendChild(radio);\n                        groupItem.appendChild(label);\n\n                        // \n                        groupItem.addEventListener('click', function() {\n                            // \n                            document.querySelectorAll('.send-group-card-item').forEach(item => {\n                                item.style.backgroundColor = '';\n                                item.style.borderColor = '#ddd';\n                            });\n                            // \n                            this.style.backgroundColor = '#e8f5e8';\n                            this.style.borderColor = '#3498db';\n                            // ID\n                            selectedGroupIdForCard = group.id;\n                            // \n                            document.getElementById('confirmSendGroupCard').disabled = false;\n                        });\n\n                        sendGroupCardList.appendChild(groupItem);\n                    });\n                }\n            }\n        })\n        .catch(error => {\n            sendGroupCardList.innerHTML = '<div style=\"text-align: center; color: #e74c3c; padding: 20px;\"></div>';\n        });\n\n    // \n    modal.style.display = 'flex';\n}\n\n// \nfunction sendGroupCard() {\n    if (!selectedGroupIdForCard) {\n        return;\n    }\n\n    // Token\n    fetch(`${SERVER_URL}/generate-group-token`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: JSON.stringify({ groupId: selectedGroupIdForCard })\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                const token = data.token;\n\n                // \n                fetch(`${SERVER_URL}/group-info/${selectedGroupIdForCard}`, {\n                    headers: {\n                        'user-id': currentUser.id,\n                        'session-token': currentSessionToken\n                    }\n                })\n                    .then(response => response.json())\n                    .then(groupData => {\n                        if (groupData.status === 'success') {\n                            const group = groupData.group;\n\n                            // \n                            const groupCardContent = JSON.stringify({\n                                type: 'group_card',\n                                group_id: group.id,\n                                group_name: group.name,\n                                group_description: group.description || '',\n                                invite_token: token,\n                                avatar_url: group.avatar_url || group.avatarUrl || ''\n                            });\n\n                            // \n                            if (currentSendChatType === 'main') {\n                                // \n                                window.chatSocket.emit('send-message', {\n                                    content: groupCardContent,\n                                    messageType: 3, // \n                                    sessionToken: currentSessionToken,\n                                    userId: currentUser.id\n                                });\n                            } else if (currentSendChatType === 'group') {\n                                // \n                                window.chatSocket.emit('send-message', {\n                                    content: groupCardContent,\n                                    messageType: 3, // \n                                    groupId: currentGroupId,\n                                    sessionToken: currentSessionToken,\n                                    userId: currentUser.id\n                                });\n                            } else if (currentSendChatType === 'private') {\n                                // \n                                window.chatSocket.emit('private-message', {\n                                    content: groupCardContent,\n                                    messageType: 3, // \n                                    receiverId: currentPrivateChatUserId,\n                                    sessionToken: currentSessionToken,\n                                    userId: currentUser.id\n                                });\n                            }\n\n                            // \n                            const modal = document.getElementById('sendGroupCardModal');\n                            if (modal) {\n                                modal.style.display = 'none';\n                                document.body.style.overflow = '';\n                            }\n                        }\n                    });\n            } else {\n                toast.error('Token: ' + (data.message || ''));\n            }\n        })\n        .catch(error => {\n            console.error(':', error);\n            toast.error('');\n        });\n}\n\n// \nexport function initializeMessageSending() {\n    const messageInput = document.getElementById('messageInput');\n    const sendButton = document.getElementById('sendButton');\n    const imageUploadButton = document.getElementById('imageUploadButton');\n    const fileUploadButton = document.getElementById('fileUploadButton');\n    const imageInput = document.getElementById('imageInput');\n    const fileInput = document.getElementById('fileInput');\n    const markdownToolbar = document.getElementById('markdownToolbar');\n\n    // \n    if (messageInput) {\n        messageInput.removeAttribute('disabled');\n        messageInput.placeholder = '...';\n    }\n    if (sendButton) {\n        sendButton.removeAttribute('disabled');\n    }\n    if (imageUploadButton) {\n        imageUploadButton.removeAttribute('disabled');\n    }\n    if (fileUploadButton) {\n        fileUploadButton.removeAttribute('disabled');\n    }\n\n    if (messageInput && sendButton) {\n        sendButton.addEventListener('click', function() {\n            sendMessage();\n        });\n\n        // \n        messageInput.addEventListener('paste', function(e) {\n            const items = e.clipboardData.items;\n            for (const item of items) {\n                if (item.type.startsWith('image/')) {\n                    e.preventDefault();\n                    const file = item.getAsFile();\n                    if (file) {\n                        uploadImage(file);\n                    }\n                    break;\n                } else if (item.type === 'application/octet-stream') {\n                    e.preventDefault();\n                    const file = item.getAsFile();\n                    if (file) {\n                        uploadFile(file);\n                    }\n                    break;\n                }\n            }\n        });\n\n        messageInput.addEventListener('keydown', function(e) {\n            // Enter\n            if (e.key === 'Enter' && !e.shiftKey && !e.ctrlKey) {\n                e.preventDefault(); // \n                sendMessage();\n            }\n            // Ctrl+EnterUI\n            else if (e.key === 'Enter' && e.ctrlKey && !e.shiftKey) {\n                e.preventDefault();\n                \n                // \n                if (messageInput.tagName === 'DIV' && messageInput.isContentEditable) {\n                    // divSelection API\n                    try {\n                        const selection = window.getSelection();\n                        const range = selection.getRangeAt(0);\n\n                        // \n                        const br = document.createElement('br');\n\n                        // \n                        range.deleteContents();\n\n                        // \n                        range.insertNode(br);\n\n                        // \n                        range.setStartAfter(br);\n                        range.setEndAfter(br);\n\n                        // \n                        selection.removeAllRanges();\n                        selection.addRange(range);\n                    } catch (error) {\n                        // Selection API\n                        messageInput.innerHTML += '<br>';\n                        messageInput.focus();\n                    }\n                } else {\n                    // textarea\n                    const start = messageInput.selectionStart;\n                    const end = messageInput.selectionEnd;\n                    \n                    // \n                    const value = messageInput.value;\n                    messageInput.value = value.substring(0, start) + '\\n' + value.substring(end);\n                    \n                    // \n                    const newPosition = start + 1;\n                    messageInput.setSelectionRange(newPosition, newPosition);\n                    \n                    // \n                    messageInput.focus();\n                }\n            }\n            // Shift+Enter\n            else if (e.key === 'Enter' && e.shiftKey && !e.ctrlKey) {\n                // \n            }\n        });\n    }\n\n    // Markdown\n    const toggleMarkdownToolbarBtn = document.getElementById('toggleMarkdownToolbar');\n\n    if (toggleMarkdownToolbarBtn && markdownToolbar) {\n        // \n        markdownToolbar.style.display = 'none';\n\n        // \n        adjustChatLayout();\n\n        toggleMarkdownToolbarBtn.addEventListener('click', function() {\n            if (markdownToolbar.style.display === 'none') {\n                // \n                markdownToolbar.style.display = 'flex';\n                this.innerHTML = '<i class=\"fas fa-chevron-up\"></i> Markdown';\n            } else {\n                // \n                markdownToolbar.style.display = 'none';\n                this.innerHTML = '<i class=\"fas fa-chevron-down\"></i> MD';\n            }\n\n            // \n            adjustChatLayout();\n        });\n    }\n\n    // \n    adjustChatLayout();\n\n    // Markdown\n    if (markdownToolbar) {\n        const markdownButtons = markdownToolbar.querySelectorAll('.markdown-btn');\n        markdownButtons.forEach(button => {\n            button.addEventListener('click', function(e) {\n                // \n                e.stopPropagation();\n\n                const prefix = this.getAttribute('data-prefix') || '';\n                const suffix = this.getAttribute('data-suffix') || '';\n                const sample = this.getAttribute('data-sample') || '';\n\n                try {\n                    // \n                    messageInput.focus();\n\n                    // Selection APIdiv\n                    const selection = window.getSelection();\n                    const range = selection.getRangeAt(0);\n\n                    // \n                    if (messageInput.contains(range.commonAncestorContainer)) {\n                        // \n                        const selectedText = range.toString();\n\n                        // \n                        const newText = prefix + (selectedText || sample) + suffix;\n                        const textNode = document.createTextNode(newText);\n\n                        // \n                        range.deleteContents();\n                        range.insertNode(textNode);\n\n                        // \n                        const newCursorStart = prefix.length;\n                        const newCursorEnd = (selectedText ? prefix.length + selectedText.length : prefix.length + sample.length);\n\n                        range.setStart(textNode, newCursorStart);\n                        range.setEnd(textNode, newCursorEnd);\n\n                        // \n                        selection.removeAllRanges();\n                        selection.addRange(range);\n                    } else {\n                        // \n                        messageInput.innerHTML += prefix + sample + suffix;\n                        // \n                        messageInput.focus();\n                        const selection = window.getSelection();\n                        const range = document.createRange();\n                        range.selectNodeContents(messageInput);\n                        range.collapse(false);\n                        selection.removeAllRanges();\n                        selection.addRange(range);\n                    }\n                } catch (error) {\n                    // \n                    messageInput.innerHTML += prefix + sample + suffix;\n                    // \n                    messageInput.focus();\n                    const selection = window.getSelection();\n                    const range = document.createRange();\n                    range.selectNodeContents(messageInput);\n                    range.collapse(false);\n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                }\n            });\n        });\n    }\n\n    // Markdown\n    const toggleGroupMarkdownToolbarBtn = document.getElementById('toggleGroupMarkdownToolbar');\n    const groupMarkdownToolbar = document.getElementById('groupMarkdownToolbar');\n    const groupMessageInput = document.getElementById('groupMessageInput');\n\n    if (toggleGroupMarkdownToolbarBtn && groupMarkdownToolbar) {\n        // \n        groupMarkdownToolbar.style.display = 'none';\n\n        // \n        adjustChatLayout();\n\n        toggleGroupMarkdownToolbarBtn.addEventListener('click', function() {\n            if (groupMarkdownToolbar.style.display === 'none') {\n                // \n                groupMarkdownToolbar.style.display = 'flex';\n                this.innerHTML = '<i class=\"fas fa-chevron-up\"></i> Markdown';\n            } else {\n                // \n                groupMarkdownToolbar.style.display = 'none';\n                this.innerHTML = '<i class=\"fas fa-chevron-down\"></i> MD';\n            }\n\n            // \n        });\n\n        // Markdown\n        const groupMarkdownButtons = groupMarkdownToolbar.querySelectorAll('.markdown-btn');\n        groupMarkdownButtons.forEach(button => {\n            button.addEventListener('click', function() {\n                const prefix = this.getAttribute('data-prefix') || '';\n                const suffix = this.getAttribute('data-suffix') || '';\n                const sample = this.getAttribute('data-sample') || '';\n\n                // textarea\n                const groupMessageInput = document.getElementById('groupMessageInput');\n                if (groupMessageInput) {\n                    // \n                    const startPos = groupMessageInput.selectionStart;\n                    const endPos = groupMessageInput.selectionEnd;\n                    const selectedText = groupMessageInput.value.substring(startPos, endPos);\n\n                    // \n                    const newText = prefix + (selectedText || sample) + suffix;\n\n                    // \n                    groupMessageInput.value = groupMessageInput.value.substring(0, startPos) + newText + groupMessageInput.value.substring(endPos);\n\n                    // \n                    const newCursorStart = startPos + prefix.length;\n                    const newCursorEnd = (selectedText ? startPos + prefix.length + selectedText.length : startPos + prefix.length + sample.length);\n                    groupMessageInput.setSelectionRange(newCursorStart, newCursorEnd);\n\n                    // \n                    groupMessageInput.focus();\n                }\n            });\n        });\n    }\n\n\n\n    // \n    if (imageUploadButton && imageInput) {\n        imageUploadButton.addEventListener('click', function() {\n            imageInput.click();\n        });\n\n        imageInput.addEventListener('change', function() {\n            if (this.files && this.files[0]) {\n                uploadImage(this.files[0]);\n            }\n        });\n    }\n\n    // \n    if (fileUploadButton && fileInput) {\n        fileUploadButton.addEventListener('click', function() {\n            fileInput.click();\n        });\n\n        fileInput.addEventListener('change', function() {\n            if (this.files && this.files[0]) {\n                uploadFile(this.files[0]);\n            }\n        });\n    }\n\n    function sendMessage() {\n        const messageInput = document.getElementById('messageInput');\n        // \n        const content = messageInput.textContent.trim() || messageInput.innerHTML.trim();\n\n        if (content && isConnected && window.chatSocket) {\n            // Socket.io\n            const messageData = {\n                content: content,\n                groupId: currentActiveChat === 'main' ? null : currentActiveChat, // groupId\n                sessionToken: currentSessionToken,\n                userId: currentUser.id\n            };\n            window.chatSocket.emit('send-message', messageData);\n\n            // \n            messageInput.innerHTML = '';\n        }\n    }\n\n}\n\n//  - \nfunction adjustChatLayout() {\n    const chatContent = document.querySelector('.chat-content.active');\n    if (chatContent) {\n        // \n        chatContent.style.marginBottom = '0';\n        chatContent.style.paddingBottom = '0';\n        chatContent.style.height = '100%';\n        chatContent.style.overflow = 'hidden';\n\n        // padding-top\n        if (chatContent.dataset.content === 'public-chat') {\n            // Markdownpadding-top\n            const markdownToolbar = document.getElementById('markdownToolbar');\n            if (markdownToolbar && markdownToolbar.style.display !== 'none') {\n                // padding-top\n                chatContent.style.paddingTop = '60px';\n            } else {\n                // padding-top\n                chatContent.style.paddingTop = '0';\n            }\n        } else if (chatContent.dataset.content === 'group-chat') {\n            // padding-topgroup-header\n            chatContent.style.paddingTop = '0';\n        } else {\n            // padding-top\n            chatContent.style.paddingTop = '0';\n        }\n\n        // \n        chatContent.style.display = 'none';\n        requestAnimationFrame(() => {\n            chatContent.style.display = 'flex';\n        });\n    }\n}\n\n//  - \nfunction uploadImage(file) {\n    // Image\n    const img = new Image();\n\n    // FileReader\n    const reader = new FileReader();\n    reader.onload = function(e) {\n        img.onload = function() {\n            // \n            const width = img.width;\n            const height = img.height;\n\n            // FormData\n            const formData = new FormData();\n            formData.append('image', file); // UI'image'\n            formData.append('userId', currentUser.id);\n            formData.append('width', width); // \n            formData.append('height', height); // \n\n            // groupId\n            const isGroupChat = currentActiveChat !== 'main' && !currentActiveChat.startsWith('private_');\n            if (isGroupChat) {\n                formData.append('groupId', currentActiveChat);\n            }\n\n            // \n            const uploadProgress = isGroupChat ? document.getElementById('groupUploadProgress') : document.getElementById('uploadProgress');\n            const uploadProgressBar = isGroupChat ? document.getElementById('groupUploadProgressBar') : document.getElementById('uploadProgressBar');\n            if (uploadProgress && uploadProgressBar) {\n                uploadProgress.style.display = 'block';\n                uploadProgressBar.style.width = '0%';\n            }\n\n            // \n            fetch(`${SERVER_URL}/upload`, {\n                method: 'POST',\n                headers: {\n                    'user-id': currentUser.id,\n                    'session-token': currentSessionToken\n                },\n                body: formData\n            })\n                .then(response => {\n                    if (response.status === 413) {\n                        throw new Error('');\n                    }\n                    return response.json();\n                })\n                .then(data => {\n                    if (data.status === 'success') {\n                        // Socket.IO\n\n                    } else {\n                        showError(data.message || '');\n                    }\n                })\n                .catch(error => {\n                    // \"Failed to fetch\"413\n                    if (error.message && error.message.includes('Failed to fetch')) {\n                        showError('');\n                    } else {\n                        showError(error.message || '');\n                    }\n                })\n                .finally(() => {\n                    // \n                    if (uploadProgress) {\n                        uploadProgress.style.display = 'none';\n                    }\n                    // \n                    if (isGroupChat) {\n                        const groupImageInput = document.getElementById('groupImageInput');\n                        if (groupImageInput) {\n                            groupImageInput.value = '';\n                        }\n                    } else {\n                        const imageInput = document.getElementById('imageInput');\n                        if (imageInput) {\n                            imageInput.value = '';\n                        }\n                    }\n                });\n        };\n\n        // \n        img.onerror = function() {\n            // \n            const formData = new FormData();\n            formData.append('image', file);\n            formData.append('userId', currentUser.id);\n\n            const isGroupChat = currentActiveChat !== 'main' && !currentActiveChat.startsWith('private_');\n            if (isGroupChat) {\n                formData.append('groupId', currentActiveChat);\n            }\n\n            fetch(`${SERVER_URL}/upload`, {\n                method: 'POST',\n                headers: {\n                    'user-id': currentUser.id,\n                    'session-token': currentSessionToken\n                },\n                body: formData\n            })\n                .then(response => response.json())\n                .then(data => {\n                    if (data.status !== 'success') {\n                        showError(data.message || '');\n                    }\n                })\n                .catch(error => {\n                    showError('');\n                });\n        };\n\n        // FileReader\n        img.src = e.target.result;\n    };\n\n    // \n    reader.readAsDataURL(file);\n}\n\n//  - \nfunction uploadFile(file) {\n    const formData = new FormData();\n    formData.append('image', file); // UI'image'\n    formData.append('userId', currentUser.id);\n\n// groupId\n    const isGroupChat = currentActiveChat !== 'main' && !currentActiveChat.startsWith('private_');\n    if (isGroupChat) {\n        formData.append('groupId', currentActiveChat);\n    }\n\n// \n    const uploadProgress = isGroupChat ? document.getElementById('groupUploadProgress') : document.getElementById('uploadProgress');\n    const uploadProgressBar = isGroupChat ? document.getElementById('groupUploadProgressBar') : document.getElementById('uploadProgressBar');\n    if (uploadProgress && uploadProgressBar) {\n        uploadProgress.style.display = 'block';\n        uploadProgressBar.style.width = '0%';\n    }\n\n    // \n    fetch(`${SERVER_URL}/upload`, {\n        method: 'POST',\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: formData\n    })\n        .then(response => {\n            if (response.status === 413) {\n                throw new Error('');\n            }\n            return response.json();\n        })\n        .then(data => {\n            if (data.status === 'success') {\n                // Socket.IO\n\n            } else {\n                showError(data.message || '');\n            }\n        })\n        .catch(error => {\n            // \"Failed to fetch\"413\n            if (error.message && error.message.includes('Failed to fetch')) {\n                showError('');\n            } else {\n                showError(error.message || '');\n            }\n        })\n        .finally(() => {\n            // \n            if (uploadProgress) {\n                uploadProgress.style.display = 'none';\n            }\n            // \n            if (isGroupChat) {\n                const groupFileInput = document.getElementById('groupFileInput');\n                if (groupFileInput) {\n                    groupFileInput.value = '';\n                }\n            } else {\n                const fileInput = document.getElementById('fileInput');\n                if (fileInput) {\n                    fileInput.value = '';\n                }\n            }\n        });\n}\n\n// \nexport function initializeGroupFunctions() {\n    // \n\n    // \n    const groupSearchInput = document.getElementById('groupSearchInput');\n    const clearGroupSearch = document.getElementById('clearGroupSearch');\n\n    if (groupSearchInput && clearGroupSearch) {\n        groupSearchInput.addEventListener('input', () => {\n            const keyword = groupSearchInput.value.toLowerCase();\n            const groupItems = document.querySelectorAll('#groupList li[data-group-id]');\n\n            groupItems.forEach(item => {\n                const groupName = item.dataset.groupName.toLowerCase();\n                if (groupName.includes(keyword)) {\n                    item.style.display = 'flex';\n                } else {\n                    item.style.display = 'none';\n                }\n            });\n\n            // \n            if (keyword) {\n                clearGroupSearch.style.display = 'inline';\n            } else {\n                clearGroupSearch.style.display = 'none';\n            }\n        });\n\n        clearGroupSearch.addEventListener('click', () => {\n            groupSearchInput.value = '';\n            clearGroupSearch.style.display = 'none';\n            const groupItems = document.querySelectorAll('#groupList li[data-group-id]');\n            groupItems.forEach(item => {\n                item.style.display = 'flex';\n            });\n        });\n    }\n\n    // \n    const groupMessageInput = document.getElementById('groupMessageInput');\n    const sendGroupMessageBtn = document.getElementById('sendGroupMessage');\n\n    // \n    const groupImageUploadButton = document.getElementById('groupImageUploadButton');\n    const groupFileUploadButton = document.getElementById('groupFileUploadButton');\n    const groupImageInput = document.getElementById('groupImageInput');\n    const groupFileInput = document.getElementById('groupFileInput');\n\n    // \n    const groupChatInterface = document.getElementById('groupChatInterface');\n    if (groupChatInterface) {\n        groupChatInterface.addEventListener('click', function() {\n            if (currentGroupId) {\n                // \n                delete unreadMessages.groups[currentGroupId];\n                updateUnreadCountsDisplay();\n                updateTitleWithUnreadCount();\n\n                // \n                if (window.chatSocket) {\n                    window.chatSocket.emit('join-group', {\n                        groupId: parseInt(currentGroupId),\n                        sessionToken: currentSessionToken,\n                        userId: currentUser.id,\n                        onlyClearUnread: true\n                    });\n                }\n            }\n        });\n    }\n\n    if (groupMessageInput && sendGroupMessageBtn) {\n        sendGroupMessageBtn.addEventListener('click', function() {\n            // console.log(`  - ID: ${currentGroupId}, : ${currentGroupName}`);\n            sendGroupMessage();\n        });\n\n        // \n        groupMessageInput.addEventListener('paste', function(e) {\n            const items = e.clipboardData.items;\n            for (const item of items) {\n                if (item.type.startsWith('image/')) {\n                    e.preventDefault();\n                    const file = item.getAsFile();\n                    if (file) {\n                        uploadImage(file);\n                    }\n                    break;\n                } else if (item.type === 'application/octet-stream') {\n                    e.preventDefault();\n                    const file = item.getAsFile();\n                    if (file) {\n                        uploadFile(file);\n                    }\n                    break;\n                }\n            }\n        });\n\n        groupMessageInput.addEventListener('keydown', function(e) {\n            // Enter\n            if (e.key === 'Enter' && !e.shiftKey && !e.ctrlKey) {\n                e.preventDefault(); // \n                sendGroupMessage();\n            }\n            // Ctrl+Enter\n            else if (e.key === 'Enter' && e.ctrlKey && !e.shiftKey) {\n                e.preventDefault();\n                \n                // \n                if (groupMessageInput.tagName === 'DIV' && groupMessageInput.isContentEditable) {\n                    // divSelection API\n                    try {\n                        const selection = window.getSelection();\n                        const range = selection.getRangeAt(0);\n                        \n                        // \n                        const br = document.createElement('br');\n                        \n                        // \n                        range.deleteContents();\n                        \n                        // \n                        range.insertNode(br);\n                        \n                        // \n                        range.setStartAfter(br);\n                        range.setEndAfter(br);\n                        \n                        // \n                        selection.removeAllRanges();\n                        selection.addRange(range);\n                    } catch (error) {\n                        // Selection API\n                        groupMessageInput.innerHTML += '<br>';\n                        groupMessageInput.focus();\n                    }\n                } else {\n                    // textarea\n                    const textarea = groupMessageInput;\n                    const start = textarea.selectionStart;\n                    const end = textarea.selectionEnd;\n                    \n                    // \n                    const value = textarea.value;\n                    textarea.value = value.substring(0, start) + '\\n' + value.substring(end);\n                    \n                    // \n                    const newPosition = start + 1;\n                    textarea.setSelectionRange(newPosition, newPosition);\n                    \n                    // \n                    textarea.focus();\n                }\n            }\n            // Shift+Enter\n            else if (e.key === 'Enter' && e.shiftKey && !e.ctrlKey) {\n                // \n            }\n        });\n    }\n\n    // \n    if (groupImageUploadButton && groupImageInput) {\n        groupImageUploadButton.addEventListener('click', function() {\n            // console.log(`   - ID: ${currentGroupId}, : ${currentGroupName}`);\n            groupImageInput.click();\n        });\n\n        groupImageInput.addEventListener('change', function() {\n            if (this.files && this.files[0]) {\n                // console.log(`  - : ${this.files[0].name}, : ${this.files[0].size} bytes, ID: ${currentGroupId}`);\n                uploadImage(this.files[0]);\n            }\n        });\n    }\n\n    // \n    if (groupFileUploadButton && groupFileInput) {\n        groupFileUploadButton.addEventListener('click', function() {\n            // console.log(`  - ID: ${currentGroupId}, : ${currentGroupName}`);\n            groupFileInput.click();\n        });\n\n        groupFileInput.addEventListener('change', function() {\n            if (this.files && this.files[0]) {\n                // console.log(`  - : ${this.files[0].name}, : ${this.files[0].size} bytes, ID: ${currentGroupId}`);\n                uploadFile(this.files[0]);\n            }\n        });\n    }\n\n    function sendGroupMessage() {\n        if (!currentGroupId) {\n            console.warn('   - ');\n            return;\n        }\n\n        const groupMessageInput = document.getElementById('groupMessageInput');\n        if (!groupMessageInput) {\n            console.error('  - ');\n            return;\n        }\n\n        // div\n        let content = '';\n        if (groupMessageInput.tagName === 'DIV' && groupMessageInput.isContentEditable) {\n            // div\n            content = groupMessageInput.textContent.trim();\n            // innerHTML\n            if (!content) {\n                const tempDiv = document.createElement('div');\n                tempDiv.innerHTML = groupMessageInput.innerHTML;\n                content = tempDiv.textContent.trim();\n            }\n        } else {\n            // inputtextarea\n            content = groupMessageInput.value || groupMessageInput.innerHTML || '';\n            content = content.trim();\n        }\n\n\n\n        if (content && isConnected && window.chatSocket) {\n            // console.log(`  - : ${content.length} , ID: ${currentGroupId}, ID: ${currentUser.id}`);\n\n            // Socket.ioUIsend-messagegroupId\n            const messageData = {\n                groupId: currentGroupId,\n                content: content,\n                sessionToken: currentSessionToken,\n                userId: currentUser.id\n            };\n\n            // console.log(`  - : send-message, :`, messageData);\n            window.chatSocket.emit('send-message', messageData);\n\n            // \n            groupMessageInput.value = '';\n            // console.log(`  - `);\n        } else {\n            if (!content) {\n                console.warn('   - ');\n            } else if (!isConnected) {\n                console.warn('   - ');\n            } else if (!window.chatSocket) {\n                console.warn('   - WebSocket');\n            }\n        }\n    }\n}\n\n// \ncurrentSharedGroup = null;\n\n// \nfunction displayShareGroupCardModal() {\n    const modal = document.getElementById('shareGroupCardModal');\n    const shareGroupList = document.getElementById('shareGroupList');\n\n    // \n    shareGroupList.innerHTML = '';\n\n    // \n    fetch(`${SERVER_URL}/groups`, {\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                const groups = data.groups;\n                groups.forEach(group => {\n                    // \n                    if (group.id !== currentSharedGroup.id) {\n                        const groupItem = document.createElement('div');\n                        groupItem.className = 'share-target-item';\n                        groupItem.style.display = 'flex';\n                        groupItem.style.alignItems = 'center';\n                        groupItem.style.margin = '10px 0';\n\n                        groupItem.innerHTML = `\n                        <input type=\"checkbox\" id=\"target-group-${group.id}\" value=\"group-${group.id}\" class=\"share-target-checkbox\">\n                        <label for=\"target-group-${group.id}\" style=\"margin-left: 10px; cursor: pointer;\">${unescapeHtml(group.name)}</label>\n                    `;\n\n                        shareGroupList.appendChild(groupItem);\n                    }\n                });\n            }\n        })\n        .catch(error => {\n            console.error(':', error);\n        });\n\n    // \n    modal.style.display = 'flex';\n\n    // \n    const closeBtn = document.getElementById('closeShareGroupCardModal');\n    closeBtn.onclick = function() {\n        modal.style.display = 'none';\n    };\n\n    // \n    const cancelBtn = document.getElementById('cancelShareGroupCard');\n    cancelBtn.onclick = function() {\n        modal.style.display = 'none';\n    };\n\n    // \n    const confirmBtn = document.getElementById('confirmShareGroupCard');\n    confirmBtn.onclick = function() {\n        shareGroupCard();\n    };\n\n    // \n    window.onclick = function(event) {\n        if (event.target == modal) {\n            modal.style.display = 'none';\n        }\n    };\n}\n\n// \nfunction shareGroupCard() {\n    if (!currentSharedGroup) return;\n\n    // \n    const selectedCheckboxes = document.querySelectorAll('.share-target-checkbox:checked');\n    const selectedTargets = Array.from(selectedCheckboxes).map(checkbox => checkbox.value);\n\n    if (selectedTargets.length === 0) {\n        toast.warning('');\n        return;\n    }\n\n    // Token\n    fetch(`${SERVER_URL}/generate-group-token`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: JSON.stringify({ groupId: currentSharedGroup.id })\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                const token = data.token;\n\n                // \n                const groupCardContent = JSON.stringify({\n                    type: 'group_card',\n                    group_id: currentSharedGroup.id,\n                    group_name: currentSharedGroup.name,\n                    group_description: currentSharedGroup.description || '',\n                    invite_token: token,\n                    avatar_url: currentSharedGroup.avatar_url || currentSharedGroup.avatarUrl || ''\n                });\n\n                // \n                selectedTargets.forEach(target => {\n                    if (target === 'main') {\n                        // \n                        window.chatSocket.emit('send-message', {\n                            content: groupCardContent,\n                            messageType: 3, // \n                            sessionToken: currentSessionToken,\n                            userId: currentUser.id\n                        });\n                    } else {\n                        // \n                        const groupId = target.replace('group-', '');\n                        window.chatSocket.emit('send-message', {\n                            content: groupCardContent,\n                            messageType: 3, // \n                            groupId: groupId,\n                            sessionToken: currentSessionToken,\n                            userId: currentUser.id\n                        });\n                    }\n                });\n\n                // \n                const modal = document.getElementById('shareGroupCardModal');\n                modal.style.display = 'none';\n\n                toast.success('');\n            } else {\n                toast.error('Token: ' + (data.message || ''));\n            }\n        })\n        .catch(error => {\n            console.error(':', error);\n            toast.error('');\n        });\n}\n\n// \nfunction showGroupCardPopup(event, groupCardData) {\n    // \n    const existingPopup = document.getElementById('groupCardPopup');\n    if (existingPopup) {\n        existingPopup.remove();\n    }\n\n    // \n    const popup = document.createElement('div');\n    popup.id = 'groupCardPopup';\n    popup.style.position = 'fixed';\n    popup.style.width = '300px';\n    popup.style.backgroundColor = 'white';\n    popup.style.border = '1px solid #3498db';\n    popup.style.borderRadius = '8px';\n    popup.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.15)';\n    popup.style.zIndex = '10000';\n    popup.style.padding = '15px';\n\n    // \n    // DOMinnerHTMLXSS\n    popup.innerHTML = '';\n\n    // \n    const header = document.createElement('div');\n    header.style.display = 'flex';\n    header.style.justifyContent = 'space-between';\n    header.style.alignItems = 'center';\n    header.style.marginBottom = '10px';\n\n    // \n    const titleContainer = document.createElement('div');\n    titleContainer.style.display = 'flex';\n    titleContainer.style.alignItems = 'center';\n    titleContainer.style.gap = '10px';\n\n    // \n    if (groupCardData.avatar_url) {\n        const avatarImg = document.createElement('img');\n        avatarImg.src = `${SERVER_URL}${groupCardData.avatar_url}`;\n        avatarImg.alt = groupCardData.group_name;\n        avatarImg.style.width = '40px';\n        avatarImg.style.height = '40px';\n        avatarImg.style.borderRadius = '50%';\n        avatarImg.style.objectFit = 'cover';\n        avatarImg.style.cursor = 'pointer';\n        avatarImg.addEventListener('click', function() {\n            openImagePreview(avatarImg.src);\n        });\n        titleContainer.appendChild(avatarImg);\n    } else if (groupCardData.avatarUrl) {\n        // avatarUrl\n        const avatarImg = document.createElement('img');\n        avatarImg.src = `${SERVER_URL}${groupCardData.avatarUrl}`;\n        avatarImg.alt = groupCardData.group_name;\n        avatarImg.style.width = '40px';\n        avatarImg.style.height = '40px';\n        avatarImg.style.borderRadius = '50%';\n        avatarImg.style.objectFit = 'cover';\n        avatarImg.style.cursor = 'pointer';\n        avatarImg.addEventListener('click', function() {\n            openImagePreview(avatarImg.src);\n        });\n        titleContainer.appendChild(avatarImg);\n    } else {\n        // \n        const initials = groupCardData.group_name.charAt(0).toUpperCase();\n        const defaultAvatar = document.createElement('div');\n        defaultAvatar.style.width = '40px';\n        defaultAvatar.style.height = '40px';\n        defaultAvatar.style.borderRadius = '50%';\n        defaultAvatar.style.backgroundColor = '#3498db';\n        defaultAvatar.style.color = 'white';\n        defaultAvatar.style.display = 'flex';\n        defaultAvatar.style.alignItems = 'center';\n        defaultAvatar.style.justifyContent = 'center';\n        defaultAvatar.style.fontSize = '18px';\n        defaultAvatar.style.fontWeight = 'bold';\n        defaultAvatar.textContent = initials;\n        titleContainer.appendChild(defaultAvatar);\n    }\n\n    const title = document.createElement('h3');\n    title.style.margin = '0';\n    title.style.color = '#3498db';\n    title.textContent = unescapeHtml(groupCardData.group_name);\n    titleContainer.appendChild(title);\n\n    const closeBtn = document.createElement('button');\n    closeBtn.id = 'closeGroupCardPopup';\n    closeBtn.style.background = 'none';\n    closeBtn.style.border = 'none';\n    closeBtn.style.fontSize = '18px';\n    closeBtn.style.cursor = 'pointer';\n    closeBtn.style.color = '#999';\n    closeBtn.textContent = '';\n\n    header.appendChild(titleContainer);\n    header.appendChild(closeBtn);\n\n    // \n    const content = document.createElement('div');\n    content.style.marginBottom = '15px';\n\n    const groupIdP = document.createElement('p');\n    groupIdP.style.margin = '8px 0';\n    groupIdP.style.color = '#666';\n    groupIdP.innerHTML = `<strong>ID:</strong> ${groupCardData.group_id}`;\n\n    const descP = document.createElement('p');\n    descP.style.margin = '8px 0';\n    descP.style.color = '#666';\n\n    const descStrong = document.createElement('strong');\n    descStrong.textContent = ':';\n    descP.appendChild(descStrong);\n    descP.appendChild(document.createTextNode(` ${unescapeHtml(groupCardData.group_description) || ''}`));\n\n    content.appendChild(groupIdP);\n    content.appendChild(descP);\n\n    // \n    const buttonArea = document.createElement('div');\n    buttonArea.style.display = 'flex';\n    buttonArea.style.gap = '10px';\n\n    const joinBtn = document.createElement('button');\n    joinBtn.id = 'joinGroupButton';\n    joinBtn.className = 'save-btn';\n    joinBtn.style.flex = '1';\n    joinBtn.textContent = '';\n\n    buttonArea.appendChild(joinBtn);\n\n    // \n    popup.appendChild(header);\n    popup.appendChild(content);\n    popup.appendChild(buttonArea);\n\n    // \n    document.body.appendChild(popup);\n\n    // \n    closeBtn.addEventListener('click', function() {\n        popup.remove();\n    });\n\n    // \n    joinBtn.addEventListener('click', function() {\n        joinGroupWithToken(groupCardData.invite_token, groupCardData.group_id, groupCardData.group_name, popup);\n    });\n\n    // \n    document.addEventListener('click', function(e) {\n        if (!popup.contains(e.target) && e.target !== event.currentTarget) {\n            popup.remove();\n        }\n    });\n\n    // \n    const popupRect = popup.getBoundingClientRect();\n    const popupWidth = popupRect.width;\n    const popupHeight = popupRect.height;\n\n    // \n    let left = event.clientX;\n    let top = event.clientY;\n\n    // \n    if (left + popupWidth > window.innerWidth) {\n        left = window.innerWidth - popupWidth - 10;\n    }\n\n    // \n    if (top + popupHeight > window.innerHeight) {\n        top = window.innerHeight - popupHeight - 10;\n    }\n\n    // \n    if (left < 0) {\n        left = 10;\n    }\n\n    // \n    if (top < 0) {\n        top = 10;\n    }\n\n    // \n    popup.style.left = `${left}px`;\n    popup.style.top = `${top}px`;\n}\n\n// Token\nfunction joinGroupWithToken(token, groupId, groupName, popup) {\n    fetch(`${SERVER_URL}/join-group-with-token`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: JSON.stringify({ token: token })\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                toast.success(`: ${groupName}`);\n                // \n                if (popup) {\n                    popup.remove();\n                }\n                // \n                loadGroupList();\n            } else {\n                toast.error(': ' + (data.message || ''));\n            }\n        })\n        .catch(error => {\n            console.error(':', error);\n            toast.error('');\n        });\n}\n\n// \nfunction getPasswordCaptcha() {\n    fetch(`${SERVER_URL}/captcha`)\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                const captchaContainer = document.getElementById('passwordCaptchaContainer');\n                const captchaIdInput = document.getElementById('passwordCaptchaId');\n\n                if (captchaContainer && captchaIdInput) {\n                    // SVG\n                    captchaContainer.innerHTML = data.captchaSvg;\n                    // SVG\n                    const svgElement = captchaContainer.querySelector('svg');\n                    if (svgElement) {\n                        svgElement.style.border = '1px solid #ddd';\n                        svgElement.style.cursor = 'pointer';\n                        svgElement.style.borderRadius = '4px';\n                        svgElement.addEventListener('click', getPasswordCaptcha);\n                    }\n                    captchaIdInput.value = data.captchaId;\n                }\n            }\n        })\n        .catch(error => {\n            console.error(':', error);\n        });\n}\n\n// \nexport function initializeSettingsFunctions() {\n    // settings-form\n    const settingsContainer = document.getElementById('settingsContainer');\n    if (settingsContainer) {\n        const settingsForms = settingsContainer.querySelectorAll('.settings-form');\n\n        settingsForms.forEach(form => {\n            form.addEventListener('submit', function(e) {\n                e.preventDefault();\n                handleSettingsSubmit(this);\n            });\n        });\n    }\n\n    // \n    getPasswordCaptcha();\n\n    // \n    const selectAvatarButton = document.getElementById('selectAvatarButton');\n    const avatarFileInput = document.getElementById('avatarFileInput');\n    const uploadAvatarButton = document.getElementById('uploadAvatarButton');\n    const avatarPreview = document.getElementById('avatarPreview');\n\n    if (selectAvatarButton && avatarFileInput) {\n        // \n        selectAvatarButton.addEventListener('click', function() {\n            avatarFileInput.click();\n        });\n\n        // \n        avatarFileInput.addEventListener('change', function(e) {\n            const file = e.target.files[0];\n            if (file) {\n                // \n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    if (avatarPreview) {\n                        // \n                        avatarPreview.innerHTML = '';\n\n                        // \n                        const img = document.createElement('img');\n                        img.src = e.target.result;\n                        img.style.width = '100%';\n                        img.style.height = '100%';\n                        img.style.objectFit = 'cover';\n                        img.style.borderRadius = '50%';\n\n                        avatarPreview.appendChild(img);\n                    }\n                };\n                reader.readAsDataURL(file);\n\n                // \n                if (uploadAvatarButton) {\n                    uploadAvatarButton.disabled = false;\n                }\n            }\n        });\n    }\n\n    if (uploadAvatarButton) {\n        // \n        uploadAvatarButton.addEventListener('click', function() {\n            const file = avatarFileInput.files[0];\n            if (file) {\n                uploadUserAvatar(file);\n            }\n        });\n    }\n}\n\n// \nfunction uploadUserAvatar(file) {\n    const formData = new FormData();\n    formData.append('avatar', file);\n    formData.append('userId', currentUser.id);\n\n    fetch(`${SERVER_URL}/upload-avatar`, {\n        method: 'POST',\n        headers: {\n            'session-token': currentSessionToken,\n            'user-id': currentUser.id\n        },\n        body: formData\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                showSuccess('');\n\n                // \n                if (data.avatarUrl) {\n                    currentUser.avatarUrl = data.avatarUrl;\n                    localStorage.setItem('currentUser', JSON.stringify(currentUser));\n\n                    // UI\n                    const currentUserAvatar = document.getElementById('currentUserAvatar');\n                    if (currentUserAvatar) {\n                        currentUserAvatar.src = `${SERVER_URL}${data.avatarUrl}`;\n                        currentUserAvatar.style.display = 'block';\n                    }\n\n                    // \n                    const currentAvatarImg = document.getElementById('currentAvatarImg');\n                    if (currentAvatarImg) {\n                        currentAvatarImg.src = `${SERVER_URL}${data.avatarUrl}`;\n                    }\n                }\n\n                // \n                const uploadAvatarButton = document.getElementById('uploadAvatarButton');\n                if (uploadAvatarButton) {\n                    uploadAvatarButton.disabled = true;\n                }\n            } else {\n                showError(data.message || '');\n            }\n        })\n        .catch(error => {\n            showError('');\n        });\n}\n\n// \nfunction handleSettingsSubmit(form) {\n    const settingId = form.closest('.settings-detail').getAttribute('data-setting');\n\n    // \n    const formData = new FormData(form);\n    const data = {};\n    formData.forEach((value, key) => {\n        data[key] = value;\n    });\n\n    // \n    if (settingId === 'change-nickname') {\n        // \n        if (!data.newNickname || data.newNickname.trim() === '') {\n            showError('');\n            return;\n        }\n\n        // WebSocketUI\n        if (window.chatSocket) {\n            // \n            window.chatSocket.emit('update-nickname', {\n                userId: currentUser.id,\n                newNickname: data.newNickname,\n                sessionToken: currentSessionToken\n            });\n\n            // \n            currentUser.nickname = data.newNickname;\n            localStorage.setItem('currentUser', JSON.stringify(currentUser));\n\n            // \n            window.chatSocket.emit('broadcast-nickname-change', {\n                userId: currentUser.id,\n                newNickname: data.newNickname,\n                sessionToken: currentSessionToken\n            });\n\n            // \n            updateAllMessagesNickname(currentUser.id, data.newNickname);\n\n            // \n            showSuccess('');\n        }\n    } else if (settingId === 'change-password') {\n        // \n        const oldPassword = document.getElementById('oldPassword').value;\n        const newPassword = document.getElementById('newPassword').value;\n        const confirmPassword = document.getElementById('confirmPassword').value;\n        const captchaId = document.getElementById('passwordCaptchaId').value;\n        const captchaCode = document.getElementById('passwordCaptchaCode').value;\n\n        // \n        if (!oldPassword || !newPassword || !confirmPassword) {\n            showError('');\n            return;\n        }\n\n        if (newPassword !== confirmPassword) {\n            showError('');\n            return;\n        }\n\n        if (newPassword.length < 6) {\n            showError('6');\n            return;\n        }\n\n        // \n        if (!captchaId || !captchaCode) {\n            showError('');\n            return;\n        }\n\n        // WebSocket\n        if (window.chatSocket) {\n            // \n            window.chatSocket.emit('change-password', {\n                userId: currentUser.id,\n                oldPassword: oldPassword,\n                newPassword: newPassword,\n                captchaId: captchaId,\n                captchaCode: captchaCode,\n                sessionToken: currentSessionToken\n            });\n\n            // \n            window.chatSocket.once('password-change-result', (result) => {\n                if (result.success) {\n                    showSuccess('');\n                    // \n                    form.reset();\n                    // \n                    getPasswordCaptcha();\n                } else {\n                    showError(result.message || '');\n                    // \n                    getPasswordCaptcha();\n                }\n            });\n        } else {\n            showError('WebSocket');\n        }\n    } else {\n        // HTTP\n        let endpoint = '';\n        switch (settingId) {\n            case 'shortcut-settings':\n                endpoint = '/shortcut-settings';\n                break;\n            case 'version-info':\n                endpoint = '/version-info';\n                break;\n            case 'help-center':\n                endpoint = '/help-center';\n                break;\n            default:\n                return;\n        }\n\n        // \n        fetch(`${SERVER_URL}${endpoint}`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'user-id': currentUser.id,\n                'session-token': currentSessionToken\n            },\n            body: JSON.stringify(data)\n        })\n            .then(response => response.json())\n            .then(data => {\n                if (data.status === 'success') {\n                    showSuccess('');\n                } else {\n                    showError(data.message || '');\n                }\n            })\n            .catch(error => {\n                showError('');\n            });\n    }\n}\n\n// \nexport function addGroupButtonListeners() {\n    // \n    const groupInfoButton = document.getElementById('groupInfoButton');\n    const createGroupButton = document.getElementById('createGroupButton');\n    const leaveGroupButton = document.getElementById('leaveGroupButton');\n\n    // \n    setupCreateGroupButton(createGroupButton);\n\n    // \n    setupGroupInfoButton(groupInfoButton);\n\n    // /\n    setupLeaveGroupButton(leaveGroupButton);\n}\n\n// \nfunction setupCreateGroupButton(createGroupButton) {\n    if (!createGroupButton) return;\n\n    // \n    const newCreateGroupButton = createGroupButton.cloneNode(true);\n    createGroupButton.parentNode.replaceChild(newCreateGroupButton, createGroupButton);\n\n    // \n    newCreateGroupButton.addEventListener('click', function() {\n        // ModalManager\n        const modalManager = window.ModalManager;\n        if (modalManager && typeof modalManager.showModal === 'function') {\n            modalManager.showModal('createGroupModal');\n        } else {\n            // \n            const modal = document.getElementById('createGroupModal');\n            const newGroupNameInput = document.getElementById('newGroupName');\n            const newGroupDescriptionInput = document.getElementById('newGroupDescription');\n\n            // \n            newGroupNameInput.value = '';\n            newGroupDescriptionInput.value = '';\n\n            // flex\n            modal.style.display = 'flex';\n\n            // loadAvailableMembers\n            if (window.ModalManager && typeof window.ModalManager.loadAvailableMembers === 'function') {\n                window.ModalManager.loadAvailableMembers();\n            }\n        }\n    });\n}\n\n// \nfunction setupGroupInfoButton(groupInfoButton) {\n    if (!groupInfoButton) return;\n\n    // \n    const newGroupInfoButton = groupInfoButton.cloneNode(true);\n    groupInfoButton.parentNode.replaceChild(newGroupInfoButton, groupInfoButton);\n\n    // \n    newGroupInfoButton.addEventListener('click', function() {\n        if (!currentGroupId) {\n            toast.warning('');\n            return;\n        }\n\n        // fetch API\n        fetch(`${SERVER_URL}/group-info/${currentGroupId}`, {\n            headers: {\n                'user-id': currentUser.id,\n                'session-token': currentSessionToken\n            }\n        })\n            .then(response => {\n                // \n                if (!response.ok) {\n                    throw new Error(`HTTP! : ${response.status}`);\n                }\n                return response.json();\n            })\n            .then(data => {\n                // \n                if (!data) {\n                    throw new Error('');\n                }\n\n                if (data.status === 'success') {\n                    displayGroupInfoModal(data.group, currentGroupId);\n                } else {\n                    toast.error(': ' + (data.message || ''));\n                }\n            })\n            .catch(error => {\n                console.error(':', error);\n                // HTTP\n                if (error.message && error.message.includes('HTTP')) {\n                    toast.error('');\n                } else {\n                    toast.error('');\n                }\n            });\n    });\n}\n\n// \nfunction displayGroupInfoModal(groupData, groupId) {\n    // \n    const modal = document.getElementById('groupInfoModal');\n    const modalGroupName = document.getElementById('modalGroupName');\n    const modalGroupNameValue = document.getElementById('modalGroupNameValue');\n    const modalGroupIdValue = document.getElementById('modalGroupIdValue');\n    const modalGroupMemberCount = document.getElementById('modalGroupMemberCount');\n    const modalGroupOwner = document.getElementById('modalGroupOwner');\n    const groupManageSection = document.getElementById('groupManageSection');\n    \n    // \n    if (modal) {\n        modal.style.display = 'flex';\n        modal.style.justifyContent = 'center';\n        modal.style.alignItems = 'center';\n        document.body.style.overflow = 'hidden';\n    }\n\n    // \n    const originalGroupName = unescapeHtml(groupData.name);\n\n    modalGroupName.textContent = `${originalGroupName} - `;\n    modalGroupNameValue.textContent = originalGroupName;\n    modalGroupIdValue.textContent = groupData.id;\n    modalGroupMemberCount.textContent = '';\n\n    // UIcreator_id\n    const ownerId = groupData.creator_id || groupData.ownerId || groupData.creatorId || groupData.adminId;\n    const isOwner = currentUser.id === String(ownerId);\n\n    // \n    const modalGroupNoticeValue = document.getElementById('modalGroupNoticeValue');\n    if (modalGroupNoticeValue) {\n        modalGroupNoticeValue.textContent = groupData.description ? unescapeHtml(groupData.description) : '';\n    }\n\n    // \n    const existingAvatarElement = document.getElementById('modalGroupAvatarValue');\n    if (existingAvatarElement) {\n        existingAvatarElement.remove();\n    }\n\n    // \n    const modalGroupAvatarValue = document.createElement('div');\n    modalGroupAvatarValue.id = 'modalGroupAvatarValue';\n    modalGroupAvatarValue.style.marginBottom = '15px';\n\n    // \n    const avatarContainer = document.createElement('div');\n    avatarContainer.style.display = 'flex';\n    avatarContainer.style.alignItems = 'center';\n    avatarContainer.style.gap = '10px';\n\n    // \n    const groupAvatarUrl = groupData.avatar_url || groupData.avatarUrl || '';\n    let avatarHtml = '';\n    if (groupAvatarUrl) {\n        // URLSVGXSS\n        const isSvgAvatar = /\\.svg$/i.test(groupAvatarUrl);\n        if (isSvgAvatar) {\n            // SVG\n            const initials = originalGroupName.charAt(0).toUpperCase();\n            avatarHtml = `<div class=\"group-avatar-large\" style=\"width: 80px; height: 80px; border-radius: 50%; background-color: #3498db; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 32px; color: white; cursor: pointer;\">${initials}</div>`;\n        } else {\n            const fullAvatarUrl = `${SERVER_URL}${groupAvatarUrl}`;\n            avatarHtml = `<img src=\"${fullAvatarUrl}\" alt=\"${originalGroupName}\" style=\"width: 80px; height: 80px; border-radius: 50%; object-fit: cover; cursor: pointer;\">`;\n        }\n    } else {\n        // \n        const initials = originalGroupName.charAt(0).toUpperCase();\n        avatarHtml = `<div class=\"group-avatar-large\" style=\"width: 80px; height: 80px; border-radius: 50%; background-color: #3498db; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 32px; color: white; cursor: pointer;\">${initials}</div>`;\n    }\n\n    avatarContainer.innerHTML = avatarHtml;\n\n    // \n    if (isOwner) {\n        const uploadAvatarBtn = document.createElement('button');\n        uploadAvatarBtn.id = 'uploadGroupAvatarBtn';\n        uploadAvatarBtn.className = 'edit-group-avatar-btn';\n        uploadAvatarBtn.style.padding = '6px 12px';\n        uploadAvatarBtn.style.backgroundColor = '#3498db';\n        uploadAvatarBtn.style.color = 'white';\n        uploadAvatarBtn.style.border = 'none';\n        uploadAvatarBtn.style.borderRadius = '4px';\n        uploadAvatarBtn.style.cursor = 'pointer';\n        uploadAvatarBtn.style.fontSize = '12px';\n        uploadAvatarBtn.textContent = '';\n\n        // \n        uploadAvatarBtn.addEventListener('click', function(e) {\n            // \n            e.stopPropagation();\n\n            // \n            const fileInput = document.createElement('input');\n            fileInput.type = 'file';\n            fileInput.accept = 'image/*';\n            fileInput.style.display = 'none';\n            document.body.appendChild(fileInput);\n\n            // \n            fileInput.click();\n\n            // \n            fileInput.addEventListener('change', function() {\n                if (this.files && this.files[0]) {\n                    uploadGroupAvatar(groupId, this.files[0]);\n                }\n                document.body.removeChild(fileInput);\n            });\n        });\n\n        avatarContainer.appendChild(uploadAvatarBtn);\n    }\n\n    modalGroupAvatarValue.appendChild(avatarContainer);\n\n    // \n    const modalBody = modal.querySelector('.modal-body');\n    if (modalBody && modalBody.firstChild) {\n        modalBody.insertBefore(modalGroupAvatarValue, modalBody.firstChild);\n    }\n\n    // \n    setupEditGroupNoticeButton(isOwner, groupData.description || '', groupId);\n\n    if (modalGroupOwner) {\n        modalGroupOwner.textContent = `ID: ${ownerId}`;\n    }\n\n    // \n    if (groupManageSection) {\n        groupManageSection.style.display = isOwner ? 'block' : 'none';\n    }\n\n    // \n    setupEditGroupNameButton(isOwner, originalGroupName, groupId);\n\n    // \n    modal.style.display = 'flex';\n\n    // \n    loadGroupMembers(groupId, isOwner);\n\n    // \n    const refreshGroupMembersBtn = document.getElementById('refreshGroupMembers');\n    if (refreshGroupMembersBtn) {\n        refreshGroupMembersBtn.onclick = function() {\n            loadGroupMembers(groupId, isOwner);\n        };\n    }\n\n    // \n    const addMemberToGroupBtn = document.getElementById('addMemberToGroup');\n    if (addMemberToGroupBtn) {\n        addMemberToGroupBtn.onclick = function() {\n            // \n            showAddGroupMemberModal(groupId);\n        };\n    }\n}\n\n// \nfunction uploadGroupAvatar(groupId, file) {\n    if (!currentUser || !currentSessionToken) {\n        toast.error('');\n        return;\n    }\n\n    const formData = new FormData();\n    formData.append('avatar', file);\n    formData.append('groupId', groupId);\n    formData.append('userId', currentUser.id);\n\n    // \n    toast.info('...');\n\n    fetch(`${SERVER_URL}/upload-group-avatar/${groupId}`, {\n        method: 'POST',\n        headers: {\n            'session-token': currentSessionToken,\n            'user-id': currentUser.id\n        },\n        body: formData\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                toast.success('');\n                // \n                fetch(`${SERVER_URL}/group-info/${groupId}`, {\n                    headers: {\n                        'user-id': currentUser.id,\n                        'session-token': currentSessionToken\n                    }\n                })\n                    .then(response => response.json())\n                    .then(data => {\n                        if (data.status === 'success') {\n                            // \n                            const modal = document.getElementById('groupInfoModal');\n                            if (modal) {\n                                modal.style.display = 'none';\n                            }\n\n                            // DOM\n                            setTimeout(() => {\n                                // \n                                displayGroupInfoModal(data.group, groupId);\n                                // \n                                loadGroupList();\n                            }, 100);\n                        }\n                    });\n            } else {\n                toast.error(': ' + (data.message || ''));\n            }\n        })\n        .catch(error => {\n            toast.error('');\n        });\n}\n\n// \nfunction setupEditGroupNoticeButton(isOwner, currentNotice, groupId) {\n    const editGroupNoticeBtn = document.getElementById('editGroupNoticeBtn');\n    if (!editGroupNoticeBtn) return;\n\n    if (isOwner) {\n        editGroupNoticeBtn.style.display = 'inline-block';\n\n        // \n        editGroupNoticeBtn.onclick = function() {\n            const modalGroupNoticeValue = document.getElementById('modalGroupNoticeValue');\n\n            // \n            const editTextarea = document.createElement('textarea');\n            editTextarea.value = currentNotice;\n            editTextarea.className = 'edit-group-notice-textarea';\n            editTextarea.style.padding = '6px';\n            editTextarea.style.border = '1px solid #dee2e6';\n            editTextarea.style.borderRadius = '4px';\n            editTextarea.style.fontSize = '14px';\n            editTextarea.style.flex = '1';\n            editTextarea.style.minHeight = '80px';\n            editTextarea.style.resize = 'vertical';\n\n            // \n            const saveBtn = document.createElement('button');\n            saveBtn.textContent = '';\n            saveBtn.className = 'save-group-notice-btn';\n            saveBtn.style.marginLeft = '5px';\n            saveBtn.style.padding = '6px 12px';\n            saveBtn.style.background = '#27ae60';\n            saveBtn.style.color = 'white';\n            saveBtn.style.border = 'none';\n            saveBtn.style.borderRadius = '4px';\n            saveBtn.style.cursor = 'pointer';\n            saveBtn.style.fontSize = '12px';\n            saveBtn.style.alignSelf = 'flex-start';\n\n            const cancelBtn = document.createElement('button');\n            cancelBtn.textContent = '';\n            cancelBtn.className = 'cancel-group-notice-btn';\n            cancelBtn.style.marginLeft = '5px';\n            cancelBtn.style.padding = '6px 12px';\n            cancelBtn.style.background = '#6c757d';\n            cancelBtn.style.color = 'white';\n            cancelBtn.style.border = 'none';\n            cancelBtn.style.borderRadius = '4px';\n            cancelBtn.style.cursor = 'pointer';\n            cancelBtn.style.fontSize = '12px';\n            cancelBtn.style.alignSelf = 'flex-start';\n\n            // \n            const groupNoticeContainer = modalGroupNoticeValue.parentElement;\n            groupNoticeContainer.innerHTML = '';\n            groupNoticeContainer.appendChild(editTextarea);\n            groupNoticeContainer.appendChild(saveBtn);\n            groupNoticeContainer.appendChild(cancelBtn);\n\n            // \n            editTextarea.focus();\n\n            // \n            saveBtn.onclick = function() {\n                const newNotice = editTextarea.value.trim();\n                // \n                updateGroupNotice(groupId, newNotice);\n            };\n\n            // \n            cancelBtn.onclick = function() {\n                // textContentXSS\n                const span = document.createElement('span');\n                span.id = 'modalGroupNoticeValue';\n                span.style.flex = '1';\n                span.style.wordBreak = 'break-word';\n                span.textContent = currentNotice || '';\n\n                const button = document.createElement('button');\n                button.id = 'editGroupNoticeBtn';\n                button.className = 'edit-group-notice-btn';\n                button.style.padding = '4px 8px';\n                button.style.backgroundColor = '#3498db';\n                button.style.color = 'white';\n                button.style.border = 'none';\n                button.style.borderRadius = '4px';\n                button.style.cursor = 'pointer';\n                button.style.fontSize = '12px';\n                button.textContent = '';\n\n                // \n                groupNoticeContainer.innerHTML = '';\n                groupNoticeContainer.appendChild(span);\n                groupNoticeContainer.appendChild(button);\n\n                // \n                button.onclick = editGroupNoticeBtn.onclick;\n            };\n        };\n    } else {\n        editGroupNoticeBtn.style.display = 'none';\n    }\n}\n\n// \nfunction setupEditGroupNameButton(isOwner, currentName, groupId) {\n    const editGroupNameBtn = document.getElementById('editGroupNameBtn');\n    if (!editGroupNameBtn) return;\n\n    if (isOwner) {\n        editGroupNameBtn.style.display = 'inline-block';\n\n        // \n        editGroupNameBtn.onclick = function() {\n            const modalGroupNameValue = document.getElementById('modalGroupNameValue');\n\n            // \n            const editInput = document.createElement('input');\n            editInput.type = 'text';\n            editInput.value = currentName;\n            editInput.className = 'edit-group-name-input';\n            editInput.style.padding = '6px';\n            editInput.style.border = '1px solid #dee2e6';\n            editInput.style.borderRadius = '4px';\n            editInput.style.fontSize = '14px';\n\n            // \n            const saveBtn = document.createElement('button');\n            saveBtn.textContent = '';\n            saveBtn.className = 'save-group-name-btn';\n            saveBtn.style.marginLeft = '5px';\n            saveBtn.style.padding = '6px 12px';\n            saveBtn.style.background = '#27ae60';\n            saveBtn.style.color = 'white';\n            saveBtn.style.border = 'none';\n            saveBtn.style.borderRadius = '4px';\n            saveBtn.style.cursor = 'pointer';\n            saveBtn.style.fontSize = '12px';\n\n            const cancelBtn = document.createElement('button');\n            cancelBtn.textContent = '';\n            cancelBtn.className = 'cancel-group-name-btn';\n            cancelBtn.style.marginLeft = '5px';\n            cancelBtn.style.padding = '6px 12px';\n            cancelBtn.style.background = '#6c757d';\n            cancelBtn.style.color = 'white';\n            cancelBtn.style.border = 'none';\n            cancelBtn.style.borderRadius = '4px';\n            cancelBtn.style.cursor = 'pointer';\n            cancelBtn.style.fontSize = '12px';\n\n            // \n            const groupNameContainer = modalGroupNameValue.parentElement;\n            groupNameContainer.innerHTML = '';\n            groupNameContainer.appendChild(editInput);\n            groupNameContainer.appendChild(saveBtn);\n            groupNameContainer.appendChild(cancelBtn);\n\n            // \n            editInput.focus();\n\n            // \n            saveBtn.onclick = function() {\n                const newGroupName = editInput.value.trim();\n                if (newGroupName && newGroupName !== currentName) {\n                    // \n                    updateGroupName(groupId, newGroupName);\n                }\n            };\n\n            // \n            cancelBtn.onclick = function() {\n                // textContentXSS\n                const span = document.createElement('span');\n                span.id = 'modalGroupNameValue';\n                span.textContent = currentName;\n\n                const button = document.createElement('button');\n                button.id = 'editGroupNameBtn';\n                button.className = 'edit-group-name-btn';\n                button.style.padding = '4px 8px';\n                button.style.backgroundColor = '#3498db';\n                button.style.color = 'white';\n                button.style.border = 'none';\n                button.style.borderRadius = '4px';\n                button.style.cursor = 'pointer';\n                button.style.fontSize = '12px';\n                button.textContent = '';\n\n                // \n                groupNameContainer.innerHTML = '';\n                groupNameContainer.appendChild(span);\n                groupNameContainer.appendChild(button);\n\n                // \n                button.onclick = editGroupNameBtn.onclick;\n            };\n        };\n    } else {\n        editGroupNameBtn.style.display = 'none';\n    }\n}\n\n// /\nfunction setupLeaveGroupButton(leaveGroupButton) {\n    if (!leaveGroupButton) return;\n\n    // \n    const newLeaveGroupButton = leaveGroupButton.cloneNode(true);\n    leaveGroupButton.parentNode.replaceChild(newLeaveGroupButton, leaveGroupButton);\n\n    // \n    updateLeaveGroupButtonText(newLeaveGroupButton);\n\n    // \n    newLeaveGroupButton.addEventListener('click', function() {\n        if (!currentGroupId) {\n            toast.warning('');\n            return;\n        }\n\n        // \n        fetch(`${SERVER_URL}/group-info/${currentGroupId}`, {\n            headers: {\n                'user-id': currentUser.id,\n                'session-token': currentSessionToken\n            }\n        })\n            .then(response => {\n                // \n                if (!response.ok) {\n                    throw new Error(`HTTP! : ${response.status}`);\n                }\n                return response.json();\n            })\n            .then(data => {\n                // \n                if (!data) {\n                    throw new Error('');\n                }\n\n                if (data.status === 'success') {\n                    const ownerId = data.group.creator_id || data.group.ownerId || data.group.creatorId || data.group.adminId;\n                    const isOwner = currentUser.id === String(ownerId);\n\n                    if (isOwner) {\n                        handleDissolveGroup(currentGroupId);\n                    } else {\n                        handleLeaveGroup(currentGroupId);\n                    }\n                } else {\n                    // \n                    toast.error(data.message || '');\n                }\n            })\n            .catch(error => {\n                console.error(':', error);\n                // HTTP\n                if (error.message && error.message.includes('HTTP')) {\n                    toast.error('');\n                } else {\n                    toast.error('');\n                }\n            });\n    });\n}\n\n// /\nfunction updateLeaveGroupButtonText(leaveGroupButton) {\n    if (!leaveGroupButton || !currentGroupId) return;\n\n    // \n    fetch(`${SERVER_URL}/group-info/${currentGroupId}`, {\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                const ownerId = data.group.creator_id || data.group.ownerId || data.group.creatorId || data.group.adminId;\n                const isOwner = currentUser.id === String(ownerId);\n\n                // \n                leaveGroupButton.textContent = isOwner ? '' : '';\n            }\n        })\n        .catch(error => {\n            console.error(':', error);\n        });\n}\n\n// \nfunction handleDissolveGroup(groupId) {\n    if (confirm('')) {\n        dissolveGroup(groupId);\n    }\n}\n\n// \nfunction handleLeaveGroup(groupId) {\n    if (confirm('')) {\n        // fetch API\n        fetch(`${SERVER_URL}/leave-group`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'user-id': currentUser.id,\n                'session-token': currentSessionToken\n            },\n            body: JSON.stringify({\n                groupId: groupId\n            })\n        })\n            .then(response => response.json())\n            .then(data => {\n                if (data.status === 'success') {\n                    toast.success('');\n                    // \n                    loadGroupList();\n\n                    // \n                    currentGroupId = null;\n                    currentGroupName = '';\n\n                    // \n                    const groupEmptyState = document.getElementById('groupEmptyState');\n                    const groupChatInterface = document.getElementById('groupChatInterface');\n                    const currentGroupNameElement = document.getElementById('currentGroupName');\n\n                    if (groupEmptyState) {\n                        groupEmptyState.style.display = 'flex';\n                    }\n                    if (groupChatInterface) {\n                        groupChatInterface.style.display = 'none';\n                    }\n                    if (currentGroupNameElement) {\n                        currentGroupNameElement.textContent = '';\n                    }\n                } else {\n                    toast.error(': ' + (data.message || ''));\n                }\n            })\n            .catch(error => {\n                toast.error('');\n            });\n    }\n}\n\n// \nfunction loadGroupMembers(groupId, isOwner) {\n    // console.log(` [] ID: ${groupId}: ${isOwner}`);\n\n    const groupMembersContainer = document.getElementById('groupMembersContainer');\n    const modalGroupMemberCount = document.getElementById('modalGroupMemberCount');\n    if (!groupMembersContainer) {\n        // console.error(' [] ');\n        return;\n    }\n\n    groupMembersContainer.innerHTML = '<div class=\"loading-members\">...</div>';\n\n    // console.log(` [] ID: ${groupId}`);\n    fetch(`${SERVER_URL}/group-members/${groupId}`, {\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(data => {\n            // console.log(` [] : ${data.status}:`, data);\n\n            if (data.status === 'success') {\n                // console.log(` []  ${data.members.length} `);\n                updateGroupMembersList(data.members, isOwner, groupId);\n                // \n                modalGroupMemberCount.textContent = data.members.length;\n            } else {\n                const errorMsg = data.message || '';\n                // console.error(` [] : ${errorMsg}`);\n                groupMembersContainer.innerHTML = `<div class=\"loading-members\">: ${errorMsg}</div>`;\n            }\n        })\n        .catch(error => {\n            // console.error(' [] :', error);\n            groupMembersContainer.innerHTML = '<div class=\"loading-members\"></div>';\n        });\n}\n\n// \nfunction updateGroupMembersList(members, isOwner, groupId) {\n    // console.log(` [] ID: ${groupId}: ${isOwner}: ${members ? members.length : 0}`);\n\n    const groupMembersContainer = document.getElementById('groupMembersContainer');\n    if (!groupMembersContainer) {\n        // console.error(' [] ');\n        return;\n    }\n\n    if (!members || !Array.isArray(members) || members.length === 0) {\n        // console.log(` [] ID: ${groupId}`);\n        groupMembersContainer.innerHTML = '<div class=\"loading-members\"></div>';\n        return;\n    }\n\n    // console.log(` []  ${members.length} ID: ${groupId}`);\n    let membersHtml = '';\n    members.forEach((member, index) => {\n        // \n        const isMemberOwner = String(member.id) === String(currentUser.id);\n\n        // console.log(` []  ${index + 1}/${members.length}: ID=${member.id}, =${member.nickname}, : ${isMemberOwner}`);\n\n        membersHtml += `\n            <div class=\"group-member-item\">\n                <div class=\"group-member-info\">\n                    <span class=\"group-member-name\">${member.nickname}</span>\n                    <span class=\"group-member-id\">ID: ${member.id}</span>\n                    ${isMemberOwner ? '<span class=\"group-member-role\"></span>' : ''}\n                </div>\n                ${isOwner && !isMemberOwner ? `\n                    <button class=\"kick-member-btn\" data-group-id=\"${groupId}\" data-member-id=\"${member.id}\" data-member-name=\"${member.nickname}\">\n                        \n                    </button>\n                ` : ''}\n            </div>\n        `;\n    });\n\n    // console.log(` [] HTML ${members.length} `);\n    groupMembersContainer.innerHTML = membersHtml;\n\n    // \n    if (isOwner) {\n        const kickButtons = groupMembersContainer.querySelectorAll('.kick-member-btn');\n        // console.log(` []  ${kickButtons.length} `);\n\n        kickButtons.forEach(button => {\n            button.addEventListener('click', function() {\n                const groupId = this.getAttribute('data-group-id');\n                const memberId = this.getAttribute('data-member-id');\n                const memberName = this.getAttribute('data-member-name');\n\n                // console.log(` [] ID: ${groupId}ID: ${memberId}: ${memberName}`);\n                removeMemberFromGroup(groupId, memberId, memberName);\n            });\n        });\n    }\n\n    // console.log(` [] ID: ${groupId}`);\n}\n\n// \nfunction removeMemberFromGroup(groupId, memberId, memberName) {\n    if (!confirm(` ${memberName} `)) return;\n    if (!currentUser || !currentSessionToken) {\n        toast.error('');\n        return;\n    }\n\n    fetch(`${SERVER_URL}/remove-group-member`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: JSON.stringify({\n            groupId: groupId,\n            memberId: memberId\n        })\n    })\n        .then(response => response.json())\n        .then(data => {\n\n            // \n            if (data.status === 'success' || (data.message && data.message.includes(''))) {\n                toast.success(` ${memberName}`);\n                // \n                loadGroupMembers(groupId, true);\n            } else {\n                toast.error(': ' + (data.message || ''));\n            }\n        })\n        .catch(error => {\n            console.error(':', error);\n            toast.error('');\n        });\n}\n\n// \nfunction showAddGroupMemberModal(groupId) {\n\n    if (!groupId || !currentUser || !currentSessionToken) {\n        return;\n    }\n\n    // ID\n    window.currentAddingGroupId = groupId;\n\n    // \n    const modal = document.getElementById('addGroupMemberModal');\n    if (modal) {\n        modal.style.display = 'flex';\n        modal.style.justifyContent = 'center';\n        modal.style.alignItems = 'center';\n        document.body.style.overflow = 'hidden';\n    }\n\n    // \n    loadAvailableMembersForGroup(groupId);\n}\n\n// \nfunction hideAddGroupMemberModal() {\n\n    const modal = document.getElementById('addGroupMemberModal');\n    if (modal) {\n        modal.style.display = 'none';\n        document.body.style.overflow = '';\n    }\n\n    // \n    const addMembersMessage = document.getElementById('addMembersMessage');\n    if (addMembersMessage) {\n        addMembersMessage.textContent = '';\n    }\n\n    // \n    const availableMembersList = document.getElementById('availableMembersList');\n    if (availableMembersList) {\n        const checkboxes = availableMembersList.querySelectorAll('.available-member-checkbox');\n        checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n        });\n    }\n\n    // ID\n    delete window.currentAddingGroupId;\n}\n\n// \nfunction loadAvailableMembersForGroup(groupId) {\n\n    if (!groupId || !currentUser || !currentSessionToken) {\n        return;\n    }\n\n    const availableMembersList = document.getElementById('availableMembersList');\n    if (!availableMembersList) {\n        return;\n    }\n\n    // \n    availableMembersList.innerHTML = '<div class=\"loading-members\">...</div>';\n\n    // \n    fetch(`${SERVER_URL}/user/friends`, {\n        method: 'GET',\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(friendsData => {\n            if (friendsData.status === 'success' && friendsData.friends && Array.isArray(friendsData.friends)) {\n                // \n                return fetch(`${SERVER_URL}/group-members/${groupId}`, {\n                    method: 'GET',\n                    headers: {\n                        'user-id': currentUser.id,\n                        'session-token': currentSessionToken\n                    }\n                })\n                    .then(response => response.json())\n                    .then(membersData => {\n                        let groupMembers = [];\n                        if (membersData.status === 'success' && membersData.members && Array.isArray(membersData.members)) {\n                            groupMembers = membersData.members;\n                        }\n\n                        // ID\n                        const groupMemberIds = new Set(groupMembers.map(member => {\n                            return String(member.id);\n                        }));\n\n                        // \n                        const availableFriends = friendsData.friends.filter(friend => {\n                            const friendId = String(friend.id);\n                            const isNotCurrentUser = friendId !== String(currentUser.id);\n                            const isNotInGroup = !groupMemberIds.has(friendId);\n                            return isNotCurrentUser && isNotInGroup;\n                        });\n\n                        return availableFriends;\n                    });\n            } else {\n                return [];\n            }\n        })\n        .then(availableFriends => {\n            if (availableFriends.length === 0) {\n                availableMembersList.innerHTML = '<div class=\"loading-members\"></div>';\n                return;\n            }\n\n            // \n            availableMembersList.innerHTML = availableFriends.map(friend => `\n            <div class=\"member-item\">\n                <input type=\"checkbox\" class=\"available-member-checkbox\" id=\"available-member-${friend.id}\" value=\"${friend.id}\">\n                <label for=\"available-member-${friend.id}\" class=\"member-nickname\">${friend.nickname || friend.username || ''}</label>\n            </div>\n        `).join('');\n        })\n        .catch(error => {\n            availableMembersList.innerHTML = '<div class=\"loading-members\"></div>';\n        });\n}\n\n// \nfunction confirmAddGroupMembers() {\n\n    const groupId = window.currentAddingGroupId;\n    if (!groupId || !currentUser || !currentSessionToken) {\n        return;\n    }\n\n    const availableMembersList = document.getElementById('availableMembersList');\n    const addMembersMessage = document.getElementById('addMembersMessage');\n\n    if (!availableMembersList || !addMembersMessage) {\n        console.error(' [] DOM');\n        return;\n    }\n\n    // ID\n    const checkboxes = availableMembersList.querySelectorAll('.available-member-checkbox:checked');\n    const selectedMemberIds = Array.from(checkboxes).map(checkbox => checkbox.value);\n\n    if (selectedMemberIds.length === 0) {\n        addMembersMessage.textContent = '1';\n        addMembersMessage.className = 'create-group-message error';\n        return;\n    }\n\n    // \n    addMembersMessage.textContent = '';\n    addMembersMessage.className = 'create-group-message';\n\n\n\n    // \n    fetch(`${SERVER_URL}/add-group-members`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: JSON.stringify({\n            groupId: groupId,\n            memberIds: selectedMemberIds\n        })\n    })\n        .then(response => response.json())\n        .then(data => {\n\n\n            if (data.status === 'success' || (data.message && data.message.includes(''))) {\n                addMembersMessage.textContent = '';\n                addMembersMessage.className = 'create-group-message success';\n\n                // \n                setTimeout(() => {\n                    hideAddGroupMemberModal();\n                    // \n                    loadGroupMembers(groupId, true);\n                }, 1000);\n            } else {\n                addMembersMessage.textContent = data.message || '';\n                addMembersMessage.className = 'create-group-message error';\n            }\n        })\n        .catch(error => {\n            console.error(` []  ${groupId} :`, error);\n            addMembersMessage.textContent = '';\n            addMembersMessage.className = 'create-group-message error';\n        });\n}\n\n// \nfunction updateGroupName(groupId, newGroupName) {\n    if (!currentUser || !currentSessionToken) {\n        toast.error('');\n        return;\n    }\n\n    fetch(`${SERVER_URL}/update-group-name`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: JSON.stringify({\n            groupId: groupId,\n            newGroupName: newGroupName\n        })\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                // \n                const unescapedGroupName = unescapeHtml(data.newGroupName);\n\n                // \n                currentGroupName = unescapedGroupName;\n\n                // \n                const currentGroupNameElement = document.getElementById('currentGroupName');\n                if (currentGroupNameElement) {\n                    currentGroupNameElement.textContent = unescapedGroupName;\n                }\n\n                // \n                updateGroupNameInList(groupId, unescapedGroupName);\n\n                // \n                const groupNameContainer = document.querySelector('.group-info-item:nth-of-type(1) > div');\n                if (groupNameContainer) {\n                    groupNameContainer.innerHTML = `\n                    <span id=\"modalGroupNameValue\">${unescapedGroupName}</span>\n                    <button id=\"editGroupNameBtn\" class=\"edit-group-name-btn\" style=\"padding: 4px 8px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;\">\n                        \n                    </button>\n                `;\n                    // \n                    setupEditGroupNameButton(true, unescapedGroupName, groupId);\n                }\n\n                // \n                const modalGroupName = document.getElementById('modalGroupName');\n                if (modalGroupName) {\n                    modalGroupName.textContent = `${unescapedGroupName} - `;\n                }\n\n                toast.success('');\n\n                // \n                const manageGroupModal = document.getElementById('manageGroupModal');\n                if (manageGroupModal && manageGroupModal.style.display !== 'none') {\n                    manageGroupModal.style.display = 'none';\n                }\n            } else {\n                toast.error(': ' + (data.message || ''));\n            }\n        })\n        .catch(error => {\n            toast.error('');\n        });\n}\n\n// \nfunction updateGroupNotice(groupId, newNotice) {\n    if (!currentUser || !currentSessionToken) {\n        toast.error('');\n        return;\n    }\n\n    fetch(`${SERVER_URL}/update-group-description`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: JSON.stringify({\n            groupId: groupId,\n            newDescription: newNotice\n        })\n    })\n        .then(response => {\n            if (!response.ok) {\n                throw new Error(`HTTP! : ${response.status}`);\n            }\n            return response.json();\n        })\n        .then(data => {\n            if (data.status === 'success') {\n                // \n                updateGroupNoticeInList(groupId, newNotice);\n\n                //  modalGroupNoticeValue\n                const groupNoticeContainer = document.querySelector('.group-info-item:nth-of-type(3) > div');\n                if (groupNoticeContainer) {\n                    // \n                    groupNoticeContainer.innerHTML = `\n                    <span id=\"modalGroupNoticeValue\" style=\"flex: 1; word-break: break-word;\">${newNotice || ''}</span>\n                    <button id=\"editGroupNoticeBtn\" class=\"edit-group-notice-btn\" style=\"padding: 4px 8px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;\">\n                        \n                    </button>\n                `;\n                    // \n                    setupEditGroupNoticeButton(true, newNotice, groupId);\n                }\n\n                toast.success('');\n            } else {\n                toast.error(': ' + (data.message || ''));\n            }\n        })\n        .catch(error => {\n            console.error(':', error);\n            toast.error(': ' + error.message);\n        });\n}\n\n// \nfunction updateGroupNoticeInList(groupId, newNotice) {\n    // \n    // \n}\n\n// \nfunction updateGroupNameInList(groupId, newGroupName) {\n    const groupList = document.getElementById('groupList');\n    if (!groupList) return;\n\n    const groupItems = groupList.querySelectorAll(`li[data-group-id=\"${groupId}\"]`);\n    groupItems.forEach(item => {\n        const groupNameEl = item.querySelector('.group-name');\n        if (groupNameEl) {\n            groupNameEl.textContent = newGroupName;\n        }\n    });\n}\n\n// \nfunction dissolveGroup(groupId) {\n    if (!currentUser || !currentSessionToken) {\n        toast.error('');\n        return;\n    }\n\n    if (!confirm('')) {\n        return;\n    }\n\n    fetch(`${SERVER_URL}/dissolve-group`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        },\n        body: JSON.stringify({\n            userId: currentUser.id,\n            groupId: groupId\n        })\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                toast.success('');\n\n                // \n                backToMainChat();\n\n                // \n                loadGroupList();\n            } else {\n                toast.error(': ' + (data.message || ''));\n            }\n        })\n        .catch(error => {\n            toast.error('');\n        });\n}\n\n// \nfunction backToMainChat() {\n    // \n    const publicChatContent = document.querySelector('.chat-content[data-content=\"public-chat\"]');\n    const groupChatInterface = document.getElementById('groupChatInterface');\n    const groupEmptyState = document.getElementById('groupEmptyState');\n    const currentGroupNameElement = document.getElementById('currentGroupName');\n\n    if (publicChatContent) {\n        publicChatContent.classList.add('active');\n    }\n\n    if (groupChatInterface) {\n        groupChatInterface.style.display = 'none';\n    }\n\n    if (groupEmptyState) {\n        groupEmptyState.style.display = 'flex';\n    }\n\n    if (currentGroupNameElement) {\n        currentGroupNameElement.textContent = '';\n    }\n\n    // \n    currentGroupId = null;\n    currentGroupName = '';\n\n    // \n    setActiveChat('main');\n}\n\n// \nfunction initializeGroupButtons() {\n    // \n    addGroupButtonListeners();\n\n    // \n    // \n    const groupChatInterface = document.getElementById('groupChatInterface');\n    if (groupChatInterface) {\n        // \n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach(mutation => {\n                if (mutation.attributeName === 'style') {\n                    if (groupChatInterface.style.display !== 'none') {\n                        addGroupButtonListeners();\n                    }\n                }\n            });\n        });\n\n        observer.observe(groupChatInterface, {\n            attributes: true\n        });\n    }\n\n    // \n    const groupList = document.getElementById('groupList');\n    if (groupList) {\n        groupList.addEventListener('click', () => {\n            // 50ms\n            setTimeout(() => {\n                addGroupButtonListeners();\n            }, 50);\n        });\n    }\n}\n\n// \nfunction loadUserList() {\n    // WebSocket\n    if (isConnected && window.chatSocket) {\n        window.chatSocket.emit('get-online-users');\n    }\n}\n\n// \nfunction updateUserList(users) {\n    const userList = document.getElementById('userList');\n    const onlineCount = document.getElementById('onlineCount');\n    if (!userList) {\n        console.error('User list element not found');\n        return;\n    }\n\n    // \n    if (!Array.isArray(users)) {\n        console.error('Invalid users data:', users);\n        users = [];\n    }\n\n    // \n    // console.log(' ');\n    // console.log('   ', users);\n    // console.log('   ', users.length);\n    // console.log('   IDs', users.map(user => user.id).join(', '));\n\n    // \n    onlineUsersList = users;\n\n    // \n    if (onlineCount) {\n        onlineCount.textContent = `(${users.length})`;\n    }\n\n    // \n    updateFriendsList(friendsList);\n\n    userList.innerHTML = '';\n\n    if (users.length === 0) {\n        userList.innerHTML = '<li></li>';\n        return;\n    }\n\n\n    users.forEach(user => {\n        // \n        if (!user || !user.id) {\n            console.error('Invalid user object:', user);\n            return;\n        }\n\n        const li = document.createElement('li');\n\n        // URLUI\n        let avatarUrl = '';\n        if (user.avatarUrl && typeof user.avatarUrl === 'string') {\n            avatarUrl = user.avatarUrl.trim();\n        } else if (user.avatar_url && typeof user.avatar_url === 'string') {\n            avatarUrl = user.avatar_url.trim();\n        } else if (user.avatar && typeof user.avatar === 'string') {\n            avatarUrl = user.avatar.trim();\n        }\n\n        // \n        let avatarHtml = '';\n        if (avatarUrl) {\n            // URLSVGXSS\n            const isSvgAvatar = /\\.svg$/i.test(avatarUrl);\n            if (isSvgAvatar) {\n                // SVG\n                const initials = user.nickname ? user.nickname.charAt(0).toUpperCase() : 'U';\n                avatarHtml = `<span class=\"user-avatar\">${initials}</span>`;\n            } else {\n                const fullAvatarUrl = `${SERVER_URL}${avatarUrl}`;\n                avatarHtml = `<span class=\"user-avatar\"><img src=\"${fullAvatarUrl}\" alt=\"${user.nickname}\"></span>`;\n            }\n        } else {\n            const initials = user.nickname ? user.nickname.charAt(0).toUpperCase() : 'U';\n            avatarHtml = `<span class=\"user-avatar\">${initials}</span>`;\n        }\n\n        // \n        const isCurrentUser = currentUser && String(currentUser.id) === String(user.id);\n        const displayName = isCurrentUser ? `${user.nickname} ()` : user.nickname;\n\n        // data-user-id\n        li.setAttribute('data-user-id', user.id);\n\n        // HTML\n        li.innerHTML = `\n            ${avatarHtml}\n            <span class=\"user-name\">${displayName}</span>\n            <span class=\"user-status online\"></span>\n        `;\n\n        // \n        li.style.padding = '8px 0';\n        li.style.borderBottom = '1px solid #f1f1f1';\n        li.style.display = 'flex';\n        li.style.alignItems = 'center';\n\n        // CSS\n        li.className = 'user-item';\n\n        // \n        if (isCurrentUser) {\n            li.style.fontWeight = 'bold';\n        }\n\n        userList.appendChild(li);\n    });\n\n    // \n    loadOfflineUsers();\n\n    // \n    const friendItems = document.querySelectorAll('.friend-item');\n    friendItems.forEach(item => {\n        const friendId = item.dataset.userId;\n        const isOnline = onlineUsersList.some(user => String(user.id) === String(friendId));\n        const statusElement = item.querySelector('.friend-status');\n        if (statusElement) {\n            statusElement.className = `friend-status ${isOnline ? 'online' : 'offline'}`;\n        }\n    });\n\n    // \n    addAvatarClickListeners();\n}\n\n// \nfunction loadGroupList() {\n    if (!currentUser || !currentSessionToken) return;\n\n    // fetch API\n    fetch(`${SERVER_URL}/user-groups/${currentUser.id}`, {\n        headers: {\n            'user-id': currentUser.id,\n            'session-token': currentSessionToken\n        }\n    })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === 'success') {\n                updateGroupList(data.groups);\n            } else {\n                const groupList = document.getElementById('groupList');\n                if (groupList) {\n                    groupList.innerHTML = '<li>: ' + data.message + '</li>';\n                }\n            }\n        })\n        .catch(error => {\n            const groupList = document.getElementById('groupList');\n            if (groupList) {\n                groupList.innerHTML = '<li>: </li>';\n            }\n        });\n}\n\n// HTMLXSS\nfunction escapeHtml(text) {\n    if (typeof text !== 'string') return text;\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\n// HTML\nfunction unescapeHtml(html) {\n    const text = document.createElement('textarea');\n    text.innerHTML = html;\n    return text.value;\n}\n\n// \nfunction updateTitleWithUnreadCount() {\n    let totalUnread = unreadMessages.global;\n\n    // \n    for (const groupId in unreadMessages.groups) {\n        const groupUnread = unreadMessages.groups[groupId] || 0;\n        totalUnread += groupUnread;\n    }\n\n    // \n    for (const userId in unreadMessages.private) {\n        const privateUnread = unreadMessages.private[userId] || 0;\n        totalUnread += privateUnread;\n    }\n\n    // X\n    if (totalUnread > 0) {\n        document.title = `${totalUnread}${originalTitle}`;\n\n    } else {\n        document.title = originalTitle;\n    }\n\n    // \n    updateUnreadCountsDisplay();\n}\n\n// \nfunction updateUnreadCountsDisplay() {\n    // \n    const publicChatUnreadEl = document.getElementById('publicChatUnreadCount');\n    if (publicChatUnreadEl) {\n        if (unreadMessages.global > 0) {\n            publicChatUnreadEl.textContent = unreadMessages.global;\n        } else {\n            publicChatUnreadEl.textContent = '';\n        }\n    }\n\n    // \n    const groupChatUnreadEl = document.getElementById('groupChatUnreadCount');\n    if (groupChatUnreadEl) {\n        // \n        let totalGroupUnread = 0;\n        // Object.keys()\n        Object.keys(unreadMessages.groups).forEach(groupId => {\n            const groupUnread = unreadMessages.groups[groupId] || 0;\n            totalGroupUnread += groupUnread;\n        });\n        if (totalGroupUnread > 0) {\n            groupChatUnreadEl.textContent = totalGroupUnread;\n        } else {\n            groupChatUnreadEl.textContent = '';\n        }\n    }\n\n    // \n    const privateChatUnreadEl = document.getElementById('privateChatUnreadCount');\n    if (privateChatUnreadEl) {\n        // \n        let totalPrivateUnread = 0;\n        // Object.keys()\n        Object.keys(unreadMessages.private).forEach(userId => {\n            const privateUnread = unreadMessages.private[userId] || 0;\n            totalPrivateUnread += privateUnread;\n        });\n        if (totalPrivateUnread > 0) {\n            privateChatUnreadEl.textContent = totalPrivateUnread;\n        } else {\n            privateChatUnreadEl.textContent = '';\n        }\n    }\n\n    // \n    const groupListItems = document.querySelectorAll('#groupList li[data-group-id]');\n    groupListItems.forEach(item => {\n        const groupId = item.getAttribute('data-group-id');\n        const unreadCount = unreadMessages.groups[groupId] || 0;\n        const unreadEl = item.querySelector('.group-unread-count');\n        if (unreadEl) {\n            if (unreadCount > 0) {\n                unreadEl.textContent = unreadCount;\n            } else {\n                unreadEl.textContent = '';\n            }\n        }\n    });\n\n    // \n    const friendListItems = document.querySelectorAll('#friendsList li.friend-item');\n    friendListItems.forEach(item => {\n        const userId = item.getAttribute('data-user-id');\n        const unreadCount = unreadMessages.private[userId] || 0;\n        const unreadEl = item.querySelector('.private-unread-count');\n        if (unreadEl) {\n            if (unreadCount > 0) {\n                unreadEl.textContent = unreadCount;\n            } else {\n                unreadEl.textContent = '';\n            }\n        }\n    });\n}\n\n// \nfunction handlePageVisibilityChange() {\n    isPageVisible = !document.hidden;\n    // console.log(`  : ${isPageVisible ? '' : ''}`);\n\n    // \n    if (isPageVisible) {\n        if (currentActiveChat === 'main') {\n            // \n            if (unreadMessages.global > 0) {\n                // console.log(` : ${unreadMessages.global}`);\n                unreadMessages.global = 0;\n                updateTitleWithUnreadCount();\n            }\n        } else if (currentActiveChat.startsWith('private_')) {\n            // \n            const userId = currentActiveChat.replace('private_', '');\n            if (unreadMessages.private[userId] > 0) {\n                unreadMessages.private[userId] = 0;\n                updateTitleWithUnreadCount();\n            }\n        } else {\n            // \n            if (unreadMessages.groups[currentActiveChat] > 0) {\n                unreadMessages.groups[currentActiveChat] = 0;\n                updateTitleWithUnreadCount();\n            }\n        }\n    }\n}\n\n// \nfunction handleFocusChange() {\n    isPageVisible = document.hasFocus();\n    // console.log(`  : ${isPageVisible ? '' : ''}`);\n\n    // \n    if (isPageVisible) {\n        if (currentActiveChat === 'main') {\n            // \n            if (unreadMessages.global > 0) {\n                // console.log(` : ${unreadMessages.global}`);\n                unreadMessages.global = 0;\n                updateTitleWithUnreadCount();\n            }\n        } else if (currentActiveChat.startsWith('private_')) {\n            // \n            const userId = currentActiveChat.replace('private_', '');\n            if (unreadMessages.private[userId] > 0) {\n                unreadMessages.private[userId] = 0;\n                updateTitleWithUnreadCount();\n            }\n        } else {\n            // \n            if (unreadMessages.groups[currentActiveChat] > 0) {\n                unreadMessages.groups[currentActiveChat] = 0;\n                updateTitleWithUnreadCount();\n            }\n        }\n    }\n}\n\n// \nexport function setActiveChat(chatType, id = null) {\n    if (chatType === 'main') {\n        currentActiveChat = 'main';\n        // \n        if (unreadMessages.global > 0) {\n            // console.log(` : ${unreadMessages.global}`);\n            unreadMessages.global = 0;\n            updateTitleWithUnreadCount();\n        }\n    } else if (chatType === 'group' && id) {\n        currentActiveChat = id;\n        // \n        if (unreadMessages.groups[id] > 0) {\n            unreadMessages.groups[id] = 0;\n            updateTitleWithUnreadCount();\n        }\n    } else if (chatType === 'private' && id) {\n        currentActiveChat = `private_${id}`;\n        // \n        if (unreadMessages.private[id] > 0) {\n            unreadMessages.private[id] = 0;\n            updateTitleWithUnreadCount();\n        }\n    }\n    // console.log(` : ${currentActiveChat}`);\n}\n\n// \nfunction handleNewMessage(message, isGroup = false, groupId = null) {\n    // \n    if (!message) return;\n\n    // \n    if (message.senderId === currentUser.id || message.userId === currentUser.id) {\n        return;\n    }\n\n    // API\n    // \n    let shouldAddUnread = !isPageVisible;\n    if (isPageVisible) {\n        if (isGroup && groupId) {\n            // \n            shouldAddUnread = currentActiveChat !== groupId;\n        } else {\n            // \n            shouldAddUnread = currentActiveChat !== 'main';\n        }\n    }\n\n    if (shouldAddUnread) {\n        if (isGroup && groupId) {\n            // \n            if (!isGroupMuted(groupId)) {\n                // \n                unreadMessages.groups[groupId] = (unreadMessages.groups[groupId] || 0) + 1;\n            } else {\n\n            }\n        } else {\n            // \n            unreadMessages.global++;\n            // console.log(` : ${unreadMessages.global}`);\n        }\n        // \n        updateTitleWithUnreadCount();\n    } else {\n        // console.log(` `);\n    }\n}\n\n// \n// \nfunction getMutedGroups() {\n    const mutedGroups = localStorage.getItem('mutedGroups');\n    return mutedGroups ? JSON.parse(mutedGroups) : [];\n}\n\nfunction isGroupMuted(groupId) {\n    const mutedGroups = getMutedGroups();\n    return mutedGroups.includes(groupId.toString());\n}\n\nfunction toggleGroupMute(groupId) {\n    const mutedGroups = getMutedGroups();\n    const groupIdStr = groupId.toString();\n    let updatedGroups;\n\n    if (mutedGroups.includes(groupIdStr)) {\n        // \n        updatedGroups = mutedGroups.filter(id => id !== groupIdStr);\n        console.log(`  - ID: ${groupId}`);\n    } else {\n        // \n        updatedGroups = [...mutedGroups, groupIdStr];\n        console.log(`  - ID: ${groupId}`);\n    }\n\n    localStorage.setItem('mutedGroups', JSON.stringify(updatedGroups));\n    // \n    updateGroupListDisplay();\n    // \n    updateUnreadCountsDisplay();\n    return !mutedGroups.includes(groupIdStr); // \n}\n\n// \nfunction updateGroupListDisplay() {\n    const groupList = document.getElementById('groupList');\n    if (!groupList) return;\n\n    // \n    const groupItems = groupList.querySelectorAll('li');\n    groupItems.forEach(item => {\n        const groupId = item.getAttribute('data-group-id');\n        updateGroupMuteIcon(item, groupId);\n    });\n}\n\n// \nfunction updateGroupMuteIcon(groupItem, groupId) {\n    // \n    let muteIcon = groupItem.querySelector('.mute-icon');\n    if (muteIcon) {\n        muteIcon.remove();\n    }\n\n    // \n    if (isGroupMuted(groupId)) {\n        muteIcon = document.createElement('span');\n        muteIcon.className = 'mute-icon';\n        muteIcon.textContent = '';\n        muteIcon.style.marginLeft = '5px';\n        muteIcon.style.fontSize = '12px';\n        muteIcon.title = '';\n        groupItem.appendChild(muteIcon);\n    }\n}\n\n// \nfunction showContextMenu(e, groupId, groupName) {\n    // \n    hideContextMenu();\n\n    // \n    const contextMenu = document.createElement('div');\n    contextMenu.className = 'context-menu';\n    contextMenu.style.position = 'fixed';\n    contextMenu.style.left = e.clientX + 'px';\n    contextMenu.style.top = e.clientY + 'px';\n    contextMenu.style.backgroundColor = 'white';\n    contextMenu.style.border = '1px solid #ddd';\n    contextMenu.style.borderRadius = '4px';\n    contextMenu.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';\n    contextMenu.style.zIndex = '1000';\n    contextMenu.style.padding = '5px 0';\n\n    // \n    const isMuted = isGroupMuted(groupId);\n    const menuItem = document.createElement('div');\n    menuItem.className = 'context-menu-item';\n    menuItem.textContent = isMuted ? '' : '';\n    menuItem.style.padding = '8px 15px';\n    menuItem.style.cursor = 'pointer';\n    menuItem.style.fontSize = '14px';\n    menuItem.style.whiteSpace = 'nowrap';\n\n    menuItem.addEventListener('click', () => {\n        toggleGroupMute(groupId);\n        hideContextMenu();\n    });\n\n    contextMenu.appendChild(menuItem);\n    document.body.appendChild(contextMenu);\n\n    // \n    window.currentContextMenu = contextMenu;\n\n    // \n    setTimeout(() => {\n        document.addEventListener('click', hideContextMenu);\n    }, 0);\n}\n\n// \nfunction hideContextMenu() {\n    if (window.currentContextMenu) {\n        document.body.removeChild(window.currentContextMenu);\n        window.currentContextMenu = null;\n    }\n    document.removeEventListener('click', hideContextMenu);\n}\n\nfunction updateGroupList(groups) {\n    const groupList = document.getElementById('groupList');\n    if (!groupList) return;\n\n    groupList.innerHTML = '';\n\n    groups.forEach(group => {\n        // \n        const originalGroupName = unescapeHtml(group.name);\n\n        const li = document.createElement('li');\n        li.setAttribute('data-group-id', group.id);\n        li.setAttribute('data-group-name', originalGroupName);\n\n        // active\n        // if (currentGroupId === group.id) {\n        //     li.classList.add('active');\n        // }\n\n        // \n        let avatarHtml = '';\n        const groupAvatarUrl = group.avatar_url || group.avatarUrl || '';\n        if (groupAvatarUrl) {\n            // URLSVGXSS\n            const isSvgAvatar = /\\.svg$/i.test(groupAvatarUrl);\n            if (isSvgAvatar) {\n                // SVG\n                const initials = originalGroupName.charAt(0).toUpperCase();\n                avatarHtml = `<span class=\"group-avatar\">${initials}</span>`;\n            } else {\n                const fullAvatarUrl = `${SERVER_URL}${groupAvatarUrl}`;\n                avatarHtml = `<span class=\"group-avatar\"><img src=\"${fullAvatarUrl}\" alt=\"${originalGroupName}\"></span>`;\n            }\n        } else {\n            // \n            const initials = originalGroupName.charAt(0).toUpperCase();\n            avatarHtml = `<span class=\"group-avatar\">${initials}</span>`;\n        }\n\n        // textContentHTML\n        const groupNameSpan = document.createElement('span');\n        groupNameSpan.className = 'group-name';\n        groupNameSpan.textContent = originalGroupName;\n\n        // \n        li.innerHTML = `\n            ${avatarHtml}\n            ${groupNameSpan.outerHTML}\n            <div class=\"unread-count group-unread-count\"></div>\n        `;\n\n        // \n        li.addEventListener('click', function() {\n            // ID\n            const groupId = this.getAttribute('data-group-id');\n            // \n            const groupName = originalGroupName;\n\n            // \n            currentGroupId = groupId;\n            currentGroupName = groupName;\n            currentActiveChat = `group_${groupId}`;\n            currentSendChatType = 'group';\n            selectedGroupIdForCard = groupId;\n            // \n            sessionStore.currentGroupId = currentGroupId;\n            sessionStore.currentGroupName = currentGroupName;\n            sessionStore.currentActiveChat = currentActiveChat;\n            sessionStore.currentSendChatType = currentSendChatType;\n            sessionStore.selectedGroupIdForCard = selectedGroupIdForCard;\n            \n            // \n            setActiveChat('group', groupId);\n\n            // \n            const groupEmptyState = document.getElementById('groupEmptyState');\n            const groupChatInterface = document.getElementById('groupChatInterface');\n            const currentGroupNameElement = document.getElementById('currentGroupName');\n            if (groupEmptyState) groupEmptyState.style.display = 'none';\n            if (groupChatInterface) {\n                groupChatInterface.style.display = 'flex';\n                groupChatInterface.style.flexDirection = 'column';\n            }\n            if (currentGroupNameElement) currentGroupNameElement.textContent = currentGroupName;\n            \n            // forceReloadtrue\n            loadGroupMessages(groupId, true);\n        });\n\n        // \n        li.addEventListener('contextmenu', function(e) {\n            e.preventDefault();\n            const groupId = this.getAttribute('data-group-id');\n            const groupName = this.getAttribute('data-group-name');\n            showContextMenu(e, groupId, groupName);\n        });\n\n        // \n        updateGroupMuteIcon(li, group.id);\n\n        groupList.appendChild(li);\n    });\n\n    // \n    updateUnreadCountsDisplay();\n\n    // \n    if (currentGroupId) {\n        const groupEmptyState = document.getElementById('groupEmptyState');\n        const groupChatInterface = document.getElementById('groupChatInterface');\n        const currentGroupNameElement = document.getElementById('currentGroupName');\n\n        if (groupEmptyState) {\n            groupEmptyState.style.display = 'none';\n        }\n        if (groupChatInterface) {\n            groupChatInterface.style.display = 'flex';\n            groupChatInterface.style.flexDirection = 'column';\n        }\n        if (currentGroupNameElement) {\n            currentGroupNameElement.textContent = currentGroupName;\n        }\n    }\n}\n\n// \nexport function loadGroupMessages(groupId, forceReload = false) {\n\n\n    const groupMessageContainer = document.getElementById('groupMessageContainer');\n    if (groupMessageContainer) {\n        // \n        groupMessageContainer.style.flex = '1';\n        groupMessageContainer.style.overflowY = 'auto';\n        groupMessageContainer.style.padding = '10px';\n\n\n\n        // \n        // \n        if (forceReload) {\n            // \n            groupMessageContainer.innerHTML = '';\n        }\n    }\n\n\n\n    // \n    const loadTime = Date.now();\n\n\n\n    // Socket.io\n    if (isConnected && window.chatSocket) {\n\n\n        // UIjoin-group\n        const joinGroupData = {\n            groupId: parseInt(groupId), // \n            sessionToken: currentSessionToken,\n            userId: currentUser.id,\n            loadTime: loadTime // \n        };\n        window.chatSocket.emit('join-group', joinGroupData);\n    } else {\n        // WebSocketHTTP\n        fetch(`${SERVER_URL}/group-chat-history/${groupId}`, {\n            headers: {\n                'user-id': currentUser.id,\n                'session-token': currentSessionToken\n            }\n        })\n            .then(response => response.json())\n            .then(data => {\n                if (data.status === 'success' && data.messages) {\n                    // \n                    if (groupMessageContainer) {\n                        // \n                        data.messages.forEach(message => {\n                            // \n                            message.isHistory = true;\n                            // \n                            // CSS\n                            function generateMessageHash(message) {\n                                const content = message.content || message.text || 'empty';\n                                const sender = message.userId || message.senderId || 'unknown';\n                                const time = message.timestamp || message.createdAt || 'unknown';\n                                const data = `${sender}-${time}-${JSON.stringify(content)}`;\n\n                                // \n                                let hash = 0;\n                                for (let i = 0; i < data.length; i++) {\n                                    const char = data.charCodeAt(i);\n                                    hash = ((hash << 5) - hash) + char;\n                                    hash = hash & hash; // 32\n                                }\n                                return Math.abs(hash).toString(16);\n                            }\n\n                            const messageIdentifier = generateMessageHash(message);\n                            if (!document.querySelector(`#groupMessageContainer [data-identifier=\"${messageIdentifier}\"]`)) {\n                                // \n                                message.identifier = messageIdentifier;\n                                displayGroupMessage(message);\n                            }\n                        });\n                    }\n                }\n            })\n            .catch(error => {\n            });\n    }\n\n\n\n    // \n    const groupIdStr = String(groupId);\n    if (groupMessageCache[groupIdStr] && groupMessageCache[groupIdStr].length > 0) {\n        // DOM\n        setTimeout(() => {\n            const container = document.getElementById('groupMessageContainer');\n            if (container) {\n                // \n                groupMessageCache[groupIdStr].forEach(message => {\n                    // \n                    // CSS\n                    function generateMessageHash(message) {\n                        const content = message.content || message.text || 'empty';\n                        const sender = message.userId || message.senderId || 'unknown';\n                        const time = message.timestamp || message.createdAt || 'unknown';\n                        const data = `${sender}-${time}-${JSON.stringify(content)}`;\n\n                        // \n                        let hash = 0;\n                        for (let i = 0; i < data.length; i++) {\n                            const char = data.charCodeAt(i);\n                            hash = ((hash << 5) - hash) + char;\n                            hash = hash & hash; // 32\n                        }\n                        return Math.abs(hash).toString(16);\n                    }\n\n                    const messageIdentifier = generateMessageHash(message);\n                    if (!document.querySelector(`#groupMessageContainer [data-identifier=\"${messageIdentifier}\"]`)) {\n                        // \n                        message.identifier = messageIdentifier;\n                        displayGroupMessage(message);\n                    }\n                });\n                // \n                groupMessageCache[groupIdStr] = [];\n            }\n        }, 100);\n    }\n\n\n\n    // \n    // \n    function ensureScrollToBottom() {\n        const container = document.getElementById('groupMessageContainer');\n        if (container) {\n            // \n            const currentHeight = container.scrollHeight;\n\n            // \n            container.scrollTop = currentHeight;\n\n            // \n            setTimeout(() => {\n                // \n                if (container.scrollHeight > currentHeight) {\n                    // \n                    container.scrollTop = container.scrollHeight;\n\n                    // \n                    setTimeout(() => {\n                        // \n                        container.scrollTop = container.scrollHeight;\n                    }, 200);\n                }\n            }, 300);\n        }\n    }\n\n    // \n    setTimeout(ensureScrollToBottom, 800);\n}\n\n// \nfunction showError(message) {\n    toast.error(message);\n}\n\n// \nfunction showSuccess(message) {\n    toast.success(message);\n}\n\n\n\n// \nexport function initSidebarToggle() {\n    const menuItems = document.querySelectorAll('.menu-item');\n    const secondaryContents = document.querySelectorAll('.secondary-content');\n    const chatContents = document.querySelectorAll('.chat-content');\n    const switchToOldUI = document.getElementById('switchToOldUI');\n\n    // UI\n    if (switchToOldUI) {\n        switchToOldUI.addEventListener('click', () => {\n            window.location.href = '/oldUI/';\n        });\n    }\n\n    menuItems.forEach(item => {\n        item.addEventListener('click', () => {\n            const targetSection = item.getAttribute('data-section');\n\n            //  - active\n            if (targetSection === 'logout') {\n                if (confirm('')) {\n                    logout();\n                }\n                return;\n            }\n\n            // active\n            menuItems.forEach(menuItem => {\n                menuItem.classList.remove('active');\n            });\n\n            secondaryContents.forEach(content => {\n                content.classList.remove('active');\n            });\n\n            chatContents.forEach(content => {\n                content.classList.remove('active');\n                // displaynone\n                content.style.display = 'none';\n            });\n\n            item.classList.add('active');\n\n            const targetSecondaryContent = document.querySelector(`.secondary-content[data-content=\"${targetSection}\"]`);\n            if (targetSecondaryContent) {\n                targetSecondaryContent.classList.add('active');\n            }\n\n            const targetChatContent = document.querySelector(`.chat-content[data-content=\"${targetSection}\"]`);\n            if (targetChatContent) {\n                targetChatContent.classList.add('active');\n                // displayflex\n                targetChatContent.style.display = 'flex';\n                // \n                adjustChatLayout();\n            }\n\n            // Markdown\n            const markdownToolbar = document.getElementById('markdownToolbar');\n            const toggleMarkdownToolbarBtn = document.getElementById('toggleMarkdownToolbar');\n            const toggleGroupMarkdownToolbarBtn = document.getElementById('toggleGroupMarkdownToolbar');\n\n            // \n            if (markdownToolbar) {\n                if (targetSection === 'public-chat') {\n                    // \n                    // display\n                } else {\n                    // \n                    markdownToolbar.style.display = 'none';\n                }\n            }\n\n            // /\n            if (toggleMarkdownToolbarBtn) {\n                if (targetSection === 'public-chat') {\n                    toggleMarkdownToolbarBtn.style.display = 'inline-block';\n                    // \n                    if (markdownToolbar) {\n                        if (markdownToolbar.style.display === 'none') {\n                            toggleMarkdownToolbarBtn.innerHTML = '<i class=\"fas fa-chevron-down\"></i> MD';\n                        } else {\n                            toggleMarkdownToolbarBtn.innerHTML = '<i class=\"fas fa-chevron-up\"></i> Markdown';\n                        }\n                    }\n                } else {\n                    toggleMarkdownToolbarBtn.style.display = 'none';\n                }\n            }\n\n            if (toggleGroupMarkdownToolbarBtn) {\n                toggleGroupMarkdownToolbarBtn.style.display = targetSection === 'group-chat' ? 'inline-block' : 'none';\n            }\n\n            // \n            if (targetSection === 'public-chat') {\n                setActiveChat('main');\n                // \n            } else if (targetSection === 'group-chat') {\n                // \n                loadGroupList();\n\n                // currentActiveChat\n                // loadGroupList\n                if (currentGroupId) {\n                    setActiveChat('group', currentGroupId);\n                }\n\n                // loadGroupList\n                const originalLoadGroupList = window.loadGroupList;\n                window.loadGroupList = function() {\n                    // loadGroupList\n                    fetch(`${SERVER_URL}/user-groups/${currentUser.id}`, {\n                        headers: {\n                            'user-id': currentUser.id,\n                            'session-token': currentSessionToken\n                        }\n                    })\n                        .then(response => response.json())\n                        .then(data => {\n                            if (data.status === 'success') {\n                                updateGroupList(data.groups);\n\n                                // \n                                if (currentGroupId) {\n                                    // currentActiveChat\n                                    setActiveChat('group', currentGroupId);\n\n                                    // active\n                                    // \n                                    // const groupItems = document.querySelectorAll('#groupList li[data-group-id]');\n                                    // groupItems.forEach(item => {\n                                    //     if (item.getAttribute('data-group-id') === currentGroupId) {\n                                    //         item.classList.add('active');\n                                    //     } else {\n                                    //         item.classList.remove('active');\n                                    //     }\n                                    // });\n\n                                    // \n                                    const groupEmptyState = document.getElementById('groupEmptyState');\n                                    const groupChatInterface = document.getElementById('groupChatInterface');\n                                    const currentGroupNameElement = document.getElementById('currentGroupName');\n\n                                    if (groupEmptyState) {\n                                        groupEmptyState.style.display = 'none';\n                                    }\n                                    if (groupChatInterface) {\n                                        groupChatInterface.style.display = 'flex';\n                                        groupChatInterface.style.flexDirection = 'column';\n                                    }\n                                    if (currentGroupNameElement) {\n                                        currentGroupNameElement.textContent = currentGroupName;\n                                    }\n\n                                    // \n                                    // \n                                    loadGroupMessages(currentGroupId, false);\n                                }\n                            }\n                        })\n                        .catch(error => {\n                            const groupList = document.getElementById('groupList');\n                            if (groupList) {\n                                groupList.innerHTML = '<li>: </li>';\n                            }\n                        });\n                };\n\n                // loadGroupList\n                loadGroupList();\n\n                // loadGroupList\n                setTimeout(() => {\n                    window.loadGroupList = originalLoadGroupList;\n                }, 1000);\n            }\n        });\n    });\n}\n\n// \nexport function initSettingsItemClick() {\n    const settingsItems = document.querySelectorAll('.settings-item');\n    const settingsDetails = document.querySelectorAll('.settings-detail');\n    const settingsEmptyState = document.getElementById('settingsEmptyState');\n    const settingsContainer = document.getElementById('settingsContainer');\n\n    settingsItems.forEach(item => {\n        item.addEventListener('click', () => {\n            const settingId = item.getAttribute('data-setting-id');\n\n            settingsEmptyState.style.display = 'none';\n            settingsContainer.style.display = 'block';\n\n            settingsDetails.forEach(detail => {\n                detail.style.display = 'none';\n            });\n\n            const targetSetting = document.querySelector(`.settings-detail[data-setting=\"${settingId}\"]`);\n            if (targetSetting) {\n                targetSetting.style.display = 'block';\n            }\n        });\n    });\n}\n\n// \nfunction initGroupClick() {\n    const groupItems = document.querySelectorAll('#groupList li[data-group-id]');\n    const groupEmptyState = document.getElementById('groupEmptyState');\n    const groupChatInterface = document.getElementById('groupChatInterface');\n    const currentGroupNameElement = document.getElementById('currentGroupName');\n\n    groupItems.forEach(item => {\n        // IDDOM\n        const groupId = item.getAttribute('data-group-id');\n        // textContentHTML\n        const groupNameSpan = item.querySelector('.group-name');\n\n        item.addEventListener('click', () => {\n            groupEmptyState.style.display = 'none';\n            groupChatInterface.style.display = 'flex';\n\n            // textContent\n            const groupName = groupNameSpan ? groupNameSpan.textContent : '';\n            currentGroupNameElement.textContent = groupName;\n            currentGroupId = groupId;\n            currentGroupName = groupName;\n\n            // \n            setActiveChat('group', groupId);\n\n            // TODO: \n        });\n    });\n}\n\n// \nfunction initCancelButtons() {\n    const cancelButtons = document.querySelectorAll('.cancel-btn');\n    const settingsEmptyState = document.getElementById('settingsEmptyState');\n    const settingsContainer = document.getElementById('settingsContainer');\n\n    cancelButtons.forEach(button => {\n        button.addEventListener('click', () => {\n            settingsEmptyState.style.display = 'flex';\n            settingsContainer.style.display = 'none';\n        });\n    });\n}\n\n// \nfunction initAllFunctions() {\n    // // \n    // checkLoginStatus();\n\n    // \n    initSidebarToggle();\n\n    updateUserAvatar();\n\n    // \n    // initSettingsItemClick();\n\n    // \n    initGroupClick();\n\n    // \n    initCancelButtons();\n\n    // \n    initializeScrollLoading();\n\n    // \n    initializeGroupButtons();\n}\n\n// \nexport function initializeScrollLoading() {\n    const messageContainer = document.getElementById('messageContainer');\n    const groupMessageContainer = document.getElementById('groupMessageContainer');\n    const privateMessageContainer = document.getElementById('privateMessageContainer');\n\n    // \n    window.isLoadingMoreMessages = false;\n    window.loadingIndicatorTimeout = null;\n\n    // \n    function isScrolledToBottom(container) {\n        const distanceToBottom = container.scrollHeight - container.scrollTop - container.clientHeight;\n        return distanceToBottom < 10; // 10px\n    }\n\n    // \n    function handleScroll(e, container, isGroup, isPrivate = false) {\n        // \n        if (container.scrollTop < 50) { // 50px\n            // console.log(' [] scrollTop:', container.scrollTop);\n            // \n            if (!window.isLoadingMoreMessages) {\n                // console.log(' [] ');\n                window.isLoadingMoreMessages = true;\n\n                // \n                const prevScrollHeight = container.scrollHeight;\n                const prevScrollTop = container.scrollTop;\n                // console.log(' []  - scrollHeight:', prevScrollHeight, 'scrollTop:', prevScrollTop);\n\n                // sequence\n                const messages = container.querySelectorAll('.message');\n                let olderThan = null;\n\n                if (messages.length > 0) {\n                    let minSequence = null;\n                    for (let i = 0; i < messages.length; i++) {\n                        const msg = messages[i];\n                        // data-sequencesequence\n                        const sequenceAttr = msg.getAttribute('data-sequence');\n                        if (sequenceAttr !== null) {\n                            const sequence = parseInt(sequenceAttr);\n                            if (!isNaN(sequence)) {\n                                if (minSequence === null || sequence < minSequence) {\n                                    minSequence = sequence;\n                                }\n                            }\n                        }\n                    }\n                    olderThan = minSequence;\n                    // console.log(' [] sequence:', olderThan);\n                } else {\n                    // console.log(' [] ');\n                }\n\n                // \n                if (currentUser && currentSessionToken) {\n                    // console.log(' [] ');\n                    if (isGroup && currentGroupId) {\n                        // console.log(' [] groupId:', currentGroupId);\n                        // \n                        const joinGroupData = {\n                            groupId: currentGroupId,\n                            sessionToken: currentSessionToken,\n                            userId: currentUser.id,\n                            limit: 20,\n                            loadMore: true,\n                            olderThan: olderThan\n                        };\n                        window.chatSocket.emit('get-group-chat-history', joinGroupData);\n                    } else if (isPrivate && currentPrivateChatUserId) {\n                        // console.log(' [] userId:', currentPrivateChatUserId);\n                        // \n                        const historyOptions = {\n                            userId: currentUser.id,\n                            friendId: currentPrivateChatUserId,\n                            sessionToken: currentSessionToken,\n                            limit: 20,\n                            loadMore: true,\n                            olderThan: olderThan\n                        };\n                        window.chatSocket.emit('get-private-chat-history', historyOptions);\n                    } else {\n                        // console.log(' [] ');\n                        // WebSocket\n                        window.chatSocket.emit('get-chat-history', {\n                            userId: currentUser.id,\n                            sessionToken: currentSessionToken,\n                            limit: 20,\n                            loadMore: true,\n                            olderThan: olderThan\n                        });\n                    }\n\n                    // 0.5\n                    window.loadingIndicatorTimeout = setTimeout(() => {\n                        // \n                        if (window.isLoadingMoreMessages) {\n                            // console.log(' [] ');\n                            const loadingIndicator = document.createElement('div');\n                            loadingIndicator.className = 'loading-indicator';\n                            loadingIndicator.textContent = '...';\n                            loadingIndicator.style.textAlign = 'center';\n                            loadingIndicator.style.padding = '10px';\n                            loadingIndicator.style.color = '#666';\n                            loadingIndicator.style.fontSize = '14px';\n                            container.insertBefore(loadingIndicator, container.firstChild);\n                        }\n                    }, 500);\n                } else {\n                    // console.log(' [] ');\n                    window.isLoadingMoreMessages = false;\n                }\n            } else {\n                // console.log(' [] ');\n            }\n        }\n    }\n\n    // \n    if (messageContainer) {\n        messageContainer.addEventListener('scroll', function(e) {\n            handleScroll(e, this, false);\n        });\n    }\n\n    // \n    if (groupMessageContainer) {\n        groupMessageContainer.addEventListener('scroll', function(e) {\n            handleScroll(e, this, true);\n        });\n    }\n\n    // \n    if (privateMessageContainer) {\n        privateMessageContainer.addEventListener('scroll', function(e) {\n            handleScroll(e, this, false, true);\n        });\n    }\n\n    // \n    window.resetLoadingState = function() {\n        window.isLoadingMoreMessages = false;\n        if (window.loadingIndicatorTimeout) {\n            clearTimeout(window.loadingIndicatorTimeout);\n            window.loadingIndicatorTimeout = null;\n        }\n\n        // \n        const loadingIndicators = document.querySelectorAll('.loading-indicator');\n        loadingIndicators.forEach(indicator => indicator.remove());\n    };\n}\n\n//  -  initializeChat \n\n// \n\n// \nfunction openAvatarPreview(avatarUrl) {\n    const modal = document.getElementById('avatarPreviewModal');\n    const imgElement = document.getElementById('previewAvatarElement');\n    const closeBtn = document.getElementById('closeAvatarPreviewModal');\n\n    if (modal && imgElement) {\n        imgElement.src = avatarUrl;\n        modal.style.display = 'flex';\n        document.body.style.overflow = 'hidden';\n    }\n\n    // \n    if (closeBtn) {\n        // \n        closeBtn.removeEventListener('click', closeAvatarPreviewModal);\n        closeBtn.addEventListener('click', closeAvatarPreviewModal);\n    }\n\n    // \n    if (modal) {\n        // \n        modal.removeEventListener('click', handleAvatarModalBackgroundClick);\n        modal.addEventListener('click', handleAvatarModalBackgroundClick);\n    }\n}\n\n// \nfunction closeAvatarPreviewModal() {\n    const modal = document.getElementById('avatarPreviewModal');\n    if (modal) {\n        modal.style.display = 'none';\n        document.body.style.overflow = '';\n    }\n}\n\n// \nfunction handleAvatarModalBackgroundClick(e) {\n    const modal = document.getElementById('avatarPreviewModal');\n    if (e.target === modal) {\n        closeAvatarPreviewModal();\n    }\n}\n\n// \nconst closeAvatarBtn = document.getElementById('closeAvatarPreviewModal');\nif (closeAvatarBtn) {\n    closeAvatarBtn.addEventListener('click', closeAvatarPreviewModal);\n}\n\n// \nconst avatarPreviewModal = document.getElementById('avatarPreviewModal');\nif (avatarPreviewModal) {\n    avatarPreviewModal.addEventListener('click', handleAvatarModalBackgroundClick);\n}\n\n// \nfunction addImageClickEvents() {\n    const images = document.querySelectorAll('.message-image');\n    images.forEach(img => {\n        if (!img.hasAttribute('data-click-added')) {\n            img.addEventListener('click', function() {\n                const src = this.getAttribute('src');\n                if (src) {\n                    openImagePreview(src);\n                }\n            });\n            img.setAttribute('data-click-added', 'true');\n        }\n    });\n}\n\n// \nfunction addAvatarClickEvents() {\n    // user-avatar\n    const avatars = document.querySelectorAll('.user-avatar');\n    avatars.forEach(avatar => {\n        if (!avatar.hasAttribute('data-click-added')) {\n            avatar.addEventListener('click', function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                // ID\n                let userId;\n\n                // data-user-id\n                if (this.closest('[data-user-id]')) {\n                    userId = this.closest('[data-user-id]').getAttribute('data-user-id');\n                }\n                // \n                else if (this.closest('.user-item')) {\n                    userId = this.closest('.user-item').getAttribute('data-user-id');\n                }\n                // \n                else if (this.closest('.message-item')) {\n                    userId = this.closest('.message-item').getAttribute('data-user-id');\n                }\n                // \n                else if (this.closest('.search-result-item')) {\n                    userId = this.closest('.search-result-item').querySelector('.add-friend-btn')?.getAttribute('data-user-id');\n                }\n\n                if (userId) {\n                    // \n                    let nickname = '';\n\n                    // data-user-nickname\n                    const parentWithId = this.closest('[data-user-id]');\n                    if (parentWithId) {\n                        if (parentWithId.hasAttribute('data-user-nickname')) {\n                            nickname = parentWithId.getAttribute('data-user-nickname');\n                        } else {\n                            const nameElement = parentWithId.querySelector('.friend-name, .user-name, .message-nickname');\n                            if (nameElement) {\n                                nickname = nameElement.textContent;\n                            }\n                        }\n                    } else if (this.closest('.user-item')) {\n                        const userItem = this.closest('.user-item');\n                        const nameElement = userItem.querySelector('.user-name');\n                        if (nameElement) {\n                            nickname = nameElement.textContent;\n                        }\n                    } else if (this.closest('.message-item')) {\n                        const messageItem = this.closest('.message-item');\n                        const nameElement = messageItem.querySelector('.message-nickname');\n                        if (nameElement) {\n                            nickname = nameElement.textContent;\n                        }\n                    }\n\n                    // \n                    showUserAvatarPopup(e, { id: userId, nickname: nickname });\n                }\n            });\n            avatar.setAttribute('data-click-added', 'true');\n        }\n    });\n\n    // \n    const avatarImages = document.querySelectorAll('.user-avatar-img');\n    avatarImages.forEach(img => {\n        if (!img.hasAttribute('data-click-added')) {\n            img.addEventListener('click', function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                // ID\n                let userId;\n\n                // data-user-id\n                if (this.closest('[data-user-id]')) {\n                    userId = this.closest('[data-user-id]').getAttribute('data-user-id');\n                }\n                // \n                else if (this.id === 'currentUserAvatar') {\n                    // \n                    return;\n                }\n\n                if (userId) {\n                    // \n                    let nickname = '';\n\n                    // data-user-nickname\n                    const parentWithId = this.closest('[data-user-id]');\n                    if (parentWithId) {\n                        if (parentWithId.hasAttribute('data-user-nickname')) {\n                            nickname = parentWithId.getAttribute('data-user-nickname');\n                        } else {\n                            const nameElement = parentWithId.querySelector('.friend-name, .user-name, .message-nickname');\n                            if (nameElement) {\n                                nickname = nameElement.textContent;\n                            }\n                        }\n                    }\n\n                    // \n                    showUserAvatarPopup(e, { id: userId, nickname: nickname });\n                }\n            });\n            img.setAttribute('data-click-added', 'true');\n        }\n    });\n}\n\n// \nfunction setupEventDelegation() {\n    // \n    const messageContainer = document.getElementById('messageContainer');\n    const groupMessageContainer = document.getElementById('groupMessageContainer');\n    const privateMessageContainer = document.getElementById('privateMessageContainer');\n\n    // \n    function handleAvatarClick(e) {\n        // ID\n        let userId;\n        let nickname = '';\n        const messageElement = e.target.closest('.message-item');\n\n        if (messageElement) {\n            userId = messageElement.getAttribute('data-user-id');\n            // \n            const nameElement = messageElement.querySelector('.message-nickname');\n            if (nameElement) {\n                nickname = nameElement.textContent;\n            }\n        } else {\n            const userElement = e.target.closest('[data-user-id]');\n            if (userElement) {\n                userId = userElement.getAttribute('data-user-id');\n                // \n                if (userElement.hasAttribute('data-user-nickname')) {\n                    nickname = userElement.getAttribute('data-user-nickname');\n                } else {\n                    const nameElement = userElement.querySelector('.friend-name, .user-name, .message-nickname');\n                    if (nameElement) {\n                        nickname = nameElement.textContent;\n                    }\n                }\n            }\n        }\n\n        if (userId) {\n            // \n            showUserAvatarPopup(e, { id: userId, nickname: nickname });\n        }\n    }\n\n    // \n    if (messageContainer) {\n        messageContainer.addEventListener('click', function(e) {\n            // \n            if (e.target.classList.contains('message-image')) {\n                const src = e.target.getAttribute('src');\n                if (src) {\n                    openImagePreview(src);\n                }\n            }\n            // \n            else if (e.target.classList.contains('user-avatar') || (e.target.tagName === 'IMG' && e.target.parentElement.classList.contains('user-avatar'))) {\n                handleAvatarClick(e);\n            }\n        });\n    }\n\n    // \n    if (groupMessageContainer) {\n        groupMessageContainer.addEventListener('click', function(e) {\n            // \n            if (e.target.classList.contains('message-image')) {\n                const src = e.target.getAttribute('src');\n                if (src) {\n                    openImagePreview(src);\n                }\n            }\n            // \n            else if (e.target.classList.contains('user-avatar') || (e.target.tagName === 'IMG' && e.target.parentElement.classList.contains('user-avatar'))) {\n                handleAvatarClick(e);\n            }\n        });\n    }\n\n    // \n    if (privateMessageContainer) {\n        privateMessageContainer.addEventListener('click', function(e) {\n            // \n            if (e.target.classList.contains('message-image')) {\n                const src = e.target.getAttribute('src');\n                if (src) {\n                    openImagePreview(src);\n                }\n            }\n            // \n            else if (e.target.classList.contains('user-avatar') || (e.target.tagName === 'IMG' && e.target.parentElement.classList.contains('user-avatar'))) {\n                handleAvatarClick(e);\n            }\n        });\n    }\n\n    // \n    const userList = document.getElementById('userList');\n    if (userList) {\n        userList.addEventListener('click', function(e) {\n            //  - \n            if (e.target.classList.contains('user-avatar') || (e.target.tagName === 'IMG' && e.target.parentElement.classList.contains('user-avatar'))) {\n                handleAvatarClick(e);\n            }\n        });\n    }\n\n    // \n    const offlineUserList = document.getElementById('offlineUserList');\n    if (offlineUserList) {\n        offlineUserList.addEventListener('click', function(e) {\n            //  - \n            if (e.target.classList.contains('user-avatar') || (e.target.tagName === 'IMG' && e.target.parentElement.classList.contains('user-avatar'))) {\n                handleAvatarClick(e);\n            }\n        });\n    }\n\n    // \n    const friendsList = document.getElementById('friendsList');\n    if (friendsList) {\n        friendsList.addEventListener('click', function(e) {\n            //  - \n            if ((e.target.classList.contains('user-avatar') || (e.target.tagName === 'IMG' && e.target.parentElement.classList.contains('user-avatar'))) && !e.target.closest('.friend-item')) {\n                handleAvatarClick(e);\n            }\n        });\n    }\n}\n\n// \nfunction addGroupAvatarClickEvents() {\n    // \n    const groupList = document.getElementById('groupList');\n    if (groupList) {\n        groupList.addEventListener('click', function(e) {\n            if (e.target.closest('.group-avatar')) {\n                const groupAvatar = e.target.closest('.group-avatar');\n                const img = groupAvatar.querySelector('img');\n                if (img && img.src) {\n                    openImagePreview(img.src);\n                }\n            }\n        });\n    }\n\n    // \n    const modal = document.getElementById('groupInfoModal');\n    if (modal) {\n        modal.addEventListener('click', function(e) {\n            if (e.target.closest('#modalGroupAvatarValue')) {\n                const avatarContainer = e.target.closest('#modalGroupAvatarValue');\n                const img = avatarContainer.querySelector('img');\n                if (img && img.src) {\n                    openImagePreview(img.src);\n                }\n            }\n        });\n    }\n}\n\nexport function login() {\n    // localStorage\n    const currentUserStr = localStorage.getItem('currentUser');\n    const storedCurrentSessionToken = localStorage.getItem('currentSessionToken');\n    const chatUserId = localStorage.getItem('chatUserId');\n    const chatSessionToken = localStorage.getItem('chatSessionToken');\n    const chatUserNickname = localStorage.getItem('chatUserNickname');\n    const chatUserAvatar = localStorage.getItem('chatUserAvatar');\n    \n    // currentUsercurrentSessionToken\n    if (!currentUser && (currentUserStr || chatUserId)) {\n        if (currentUserStr) {\n            try {\n                currentUser = JSON.parse(currentUserStr);\n            } catch (error) {\n                console.warn('currentUser:', error);\n            }\n        } else if (chatUserId) {\n            currentUser = {\n                id: chatUserId,\n                nickname: chatUserNickname,\n                avatarUrl: chatUserAvatar\n            };\n        }\n    }\n    \n    if (!currentSessionToken && (storedCurrentSessionToken || chatSessionToken)) {\n        currentSessionToken = storedCurrentSessionToken || chatSessionToken;\n    }\n    \n    // \n    window.location.hash = '#/chat';\n    \n    // \n    setTimeout(() => {\n        // \n        initializeChat()\n        // App.vue\n        const currentHash = window.location.hash;\n        window.location.hash = '';\n        setTimeout(() => {\n            window.location.hash = currentHash;\n        }, 50);\n    }, 100)\n}\n\nexport function saveChatHistory(type) {\n    const messageContainer = document.getElementById('messageContainer');\n    if (!messageContainer) return;\n    \n    if (type === 'save') {\n        // \n        const fragment = document.createDocumentFragment();\n        \n        // \n        const children = messageContainer.children;\n        for (let i = 0; i < children.length; i++) {\n            fragment.appendChild(children[i].cloneNode(true));\n        }\n        \n        chatHistory = fragment;\n    } else if (type === 'pull') {\n        if (!chatHistory) {\n            // \n            if (currentUser && currentSessionToken && window.chatSocket) {\n                window.chatSocket.emit('get-chat-history', {\n                    userId: currentUser.id,\n                    sessionToken: currentSessionToken,\n                    limit: 50,\n                    loadMore: false\n                });\n            }\n            return;\n        }\n        \n        // \n        messageContainer.innerHTML = '';\n        \n        // appendChild\n        if (chatHistory) {\n            // chatHistoryappendChild\n            if (chatHistory.nodeType === 11) { // 11 \n                messageContainer.appendChild(chatHistory.cloneNode(true));\n            } else if (typeof chatHistory === 'string') {\n                // chatHistory\n                messageContainer.innerHTML = chatHistory;\n            }\n        }\n        \n        // \n        messageContainer.scrollTop = messageContainer.scrollHeight;\n    }\n}\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    // \n    window.addEventListener('load', function() {\n        if (window.location.hash !== '#/login' && window.location.hash !== '#/register') {\n            // \n            setupEventDelegation();\n            // \n            addImageClickEvents();\n            addAvatarClickEvents();\n            addGroupAvatarClickEvents();\n        }\n    });\n});","<template>\r\n  <div id=\"groupInfoModal\" class=\"modal\" style=\"display: none;\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2 id=\"modalGroupName\"></h2>\r\n        <span class=\"close\" id=\"closeGroupInfoModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div class=\"group-info-item\">\r\n          <label>:</label>\r\n          <div style=\"display: flex; align-items: center; gap: 10px;\">\r\n            <span id=\"modalGroupNameValue\"></span>\r\n            <button id=\"editGroupNameBtn\" class=\"edit-group-name-btn\" style=\"padding: 4px 8px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;\">\r\n              \r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div class=\"group-info-item\">\r\n          <label>ID:</label>\r\n          <span id=\"modalGroupIdValue\"></span>\r\n        </div>\r\n        <div class=\"group-info-item\">\r\n          <label>:</label>\r\n          <div style=\"display: flex; align-items: flex-start; gap: 10px;\">\r\n            <span id=\"modalGroupNoticeValue\" style=\"flex: 1; word-break: break-word;\"></span>\r\n            <button id=\"editGroupNoticeBtn\" class=\"edit-group-notice-btn\" style=\"padding: 4px 8px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;\">\r\n              \r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div class=\"group-info-item\">\r\n          <label>:</label>\r\n          <span id=\"modalGroupMemberCount\"></span>\r\n        </div>\r\n        <div class=\"group-info-item\">\r\n          <label>:</label>\r\n          <span id=\"modalGroupOwner\">...</span>\r\n        </div>\r\n\r\n        <!--  -->\r\n        <div class=\"group-members-section\">\r\n          <h3></h3>\r\n          <div id=\"groupMembersContainer\" class=\"group-members-container\">\r\n            <div class=\"loading-members\">...</div>\r\n          </div>\r\n        </div>\r\n\r\n        <!--  -->\r\n        <div id=\"groupManageSection\" class=\"group-manage-section\" style=\"display: none;\">\r\n          <h3></h3>\r\n          <div class=\"group-manage-buttons\">\r\n            <button id=\"addMemberToGroup\" class=\"save-btn\"></button>\r\n            <button id=\"refreshGroupMembers\" class=\"save-btn\"></button>\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button id=\"modalCloseButton\" class=\"cancel-btn\"></button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"shareGroupCardModal\" class=\"modal\" style=\"display: none;\">\r\n    <div class=\"modal-content\" style=\"width: 500px;\">\r\n      <div class=\"modal-header\">\r\n        <h2></h2>\r\n        <span class=\"close\" id=\"closeShareGroupCardModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <p></p>\r\n        <div class=\"share-targets-container\" style=\"max-height: 300px; overflow-y: auto; margin: 15px 0;\">\r\n          <!--  -->\r\n          <div class=\"share-target-item\" style=\"display: flex; align-items: center; margin: 10px 0;\">\r\n            <input type=\"checkbox\" id=\"target-main-chat\" value=\"main\" class=\"share-target-checkbox\">\r\n            <label for=\"target-main-chat\" style=\"margin-left: 10px; cursor: pointer;\"></label>\r\n          </div>\r\n          <!--  -->\r\n          <div id=\"shareGroupList\" style=\"margin-top: 15px;\">\r\n            <!--  -->\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button id=\"cancelShareGroupCard\" class=\"cancel-btn\"></button>\r\n        <button id=\"confirmShareGroupCard\" class=\"save-btn\"></button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"sendGroupCardModal\" class=\"modal\" style=\"display: none;\">\r\n    <div class=\"modal-content\" style=\"width: 400px;\">\r\n      <div class=\"modal-header\">\r\n        <h2></h2>\r\n        <span class=\"close\" id=\"closeSendGroupCardModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <p></p>\r\n        <div class=\"send-group-card-container\" style=\"max-height: 300px; overflow-y: auto; margin: 15px 0;\">\r\n          <!--  -->\r\n          <div id=\"sendGroupCardList\"></div>\r\n        </div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button id=\"cancelSendGroupCard\" class=\"cancel-btn\"></button>\r\n        <button id=\"confirmSendGroupCard\" class=\"save-btn\" disabled></button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"createGroupModal\" class=\"modal\" style=\"display: none;\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2></h2>\r\n        <span class=\"close\" id=\"closeCreateGroupModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <form id=\"createGroupForm\" class=\"settings-form\">\r\n          <div class=\"form-group\">\r\n            <label for=\"newGroupName\"> *</label>\r\n            <input type=\"text\" id=\"newGroupName\" placeholder=\"\" maxlength=\"50\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"newGroupDescription\"></label>\r\n            <textarea id=\"newGroupDescription\" placeholder=\"\" rows=\"3\" maxlength=\"200\"></textarea>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label></label>\r\n            <div id=\"groupMembersList\" class=\"group-members-list\">\r\n              <!-- JavaScript -->\r\n              <div class=\"loading-members\">...</div>\r\n            </div>\r\n          </div>\r\n          <div id=\"createGroupMessage\" class=\"create-group-message\"></div>\r\n        </form>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button id=\"cancelCreateGroup\" class=\"cancel-btn\"></button>\r\n        <button id=\"submitCreateGroup\" class=\"save-btn\"></button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"addGroupMemberModal\" class=\"modal\" style=\"display: none;\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2></h2>\r\n        <span class=\"close\" id=\"closeAddGroupMemberModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div class=\"form-group\">\r\n          <label></label>\r\n          <div id=\"availableMembersList\" class=\"group-members-list\">\r\n            <!-- JavaScript -->\r\n            <div class=\"loading-members\">...</div>\r\n          </div>\r\n        </div>\r\n        <div id=\"addMembersMessage\" class=\"create-group-message\"></div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button id=\"cancelAddMembers\" class=\"cancel-btn\"></button>\r\n        <button id=\"confirmAddMembers\" class=\"save-btn\"></button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"userProfileModal\" class=\"modal\" style=\"display: none;\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2></h2>\r\n        <span class=\"close\" id=\"closeUserProfileModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div class=\"user-profile-container\">\r\n          <div class=\"user-profile-avatar\">\r\n            <img id=\"modalUserAvatar\" src=\"\" alt=\"\" class=\"user-avatar-img\" loading=\"lazy\" width=\"120\" height=\"120\" style=\"aspect-ratio: 1/1; object-fit: cover; border-radius: 50%;\">\r\n            <span id=\"modalUserInitials\" class=\"user-initials\"></span>\r\n          </div>\r\n          <div class=\"user-profile-info\">\r\n            <div class=\"user-profile-item\">\r\n              <label>:</label>\r\n              <span id=\"modalUserNickname\"></span>\r\n            </div>\r\n            <div class=\"user-profile-item\">\r\n              <label>:</label>\r\n              <span id=\"modalUsername\"></span>\r\n            </div>\r\n            <div class=\"user-profile-item\">\r\n              <label>ID:</label>\r\n              <span id=\"modalUserId\"></span>\r\n            </div>\r\n            <div class=\"user-profile-item\">\r\n              <label>:</label>\r\n              <span id=\"modalUserStatus\" class=\"user-status\"></span>\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button id=\"closeUserProfileButton\" class=\"cancel-btn\"></button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"userAvatarPopup\" style=\"display: none; position: absolute; background: white; border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 1000; min-width: 250px;\">\r\n    <div class=\"popup-header\" style=\"display: flex; align-items: center; gap: 10px; margin-bottom: 10px;\">\r\n      <div class=\"popup-avatar\" style=\"width: 40px; height: 40px; border-radius: 50%; overflow: hidden; display: flex; align-items: center; justify-content: center; background: #3498db; color: white; font-weight: bold;\">\r\n        <img id=\"popupAvatarImg\" src=\"\" alt=\"\" style=\"width: 100%; height: 100%; object-fit: cover;\">\r\n        <span id=\"popupInitials\" style=\"display: none; font-size: 18px;\"></span>\r\n      </div>\r\n      <div class=\"popup-info\">\r\n        <div id=\"popupNickname\" style=\"font-weight: bold; font-size: 16px;\"></div>\r\n        <div id=\"popupUsername\" style=\"font-size: 14px; color: #666;\"></div>\r\n      </div>\r\n    </div>\r\n    <div class=\"popup-actions\" style=\"margin-top: 10px; display: flex; gap: 10px;\">\r\n      <button id=\"popupAddFriend\" style=\"flex: 1; padding: 8px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;\"></button>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"userSearchModal\" class=\"modal\" style=\"display: none;\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h2></h2>\r\n        <span class=\"close\" id=\"closeUserSearchModal\">&times;</span>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div class=\"form-group\">\r\n          <label for=\"searchKeyword\">:</label>\r\n          <input type=\"text\" id=\"searchKeyword\" placeholder=\"\" required>\r\n        </div>\r\n        <div id=\"searchResults\" class=\"search-results\">\r\n          <!-- JavaScript -->\r\n        </div>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button id=\"cancelUserSearch\" class=\"cancel-btn\"></button>\r\n        <button id=\"confirmUserSearch\" class=\"save-btn\"></button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"imagePreviewModal\" class=\"modal\" style=\"display: none; position: fixed; z-index: 10001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.9); justify-content: center; align-items: center;\">\r\n    <div style=\"position: relative; max-width: 90%; max-height: 90%;\">\r\n      <img id=\"previewImgElement\" src=\"\" alt=\"\" style=\"width: 100%; height: auto; max-width: 90vw; max-height: 90vh; aspect-ratio: 16/9; object-fit: contain;\" loading=\"lazy\">\r\n      <span class=\"close\" id=\"closeImagePreviewModal\" style=\"position: absolute; top: -30px; right: -30px; color: #f1f1f1; font-size: 40px; font-weight: bold; cursor: pointer;\">&times;</span>\r\n    </div>\r\n  </div>\r\n\r\n  <!--  -->\r\n  <div id=\"avatarPreviewModal\" class=\"modal\" style=\"display: none; position: fixed; z-index: 10001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.9); justify-content: center; align-items: center;\">\r\n    <div style=\"position: relative; max-width: 300px; max-height: 300px;\">\r\n      <img id=\"previewAvatarElement\" src=\"\" alt=\"\" style=\"width: 300px; height: 300px; border-radius: 50%; object-fit: cover;\">\r\n      <span class=\"close\" id=\"closeAvatarPreviewModal\" style=\"position: absolute; top: -30px; right: -30px; color: #f1f1f1; font-size: 40px; font-weight: bold; cursor: pointer;\">&times;</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// \r\nwindow.addEventListener('click', function(event) {\r\n  // \r\n  if (event.target.classList.contains('modal')) {\r\n    // \r\n    const modals = document.querySelectorAll('.modal');\r\n    modals.forEach(modal => {\r\n      modal.style.display = 'none';\r\n    });\r\n  }\r\n});\r\n</script>\r\n\r\n<style src=\"@/css/index.css\"></style>\r\n<style src=\"@/css/code-highlight.css\"></style>","<script setup>\nimport { onMounted, computed } from 'vue';\nimport { useRouter } from 'vue-router';\nimport {saveChatHistory} from \"@/utils/chat\";\n\nconst router = useRouter();\n\n// \nconst activeMenuItem = computed(() => {\n  const hash = window.location.hash;\n  if (hash === '#/chat') {\n    return 'public-chat';\n  } else if (hash === '#/chat/group') {\n    return 'group-chat';\n  } else if (hash === '#/chat/private') {\n    return 'private-chat';\n  } else if (hash === '#/settings') {\n    return 'user-settings';\n  } else {\n    return 'public-chat';\n  }\n});\n\n// \nlet unreadMessages = { global: 0, groups: {}, private: {} }; // \nlet originalTitle = document.title; // \n\nonMounted(() => {\n  // \n  initSidebarToggle();\n  // \n  updateUserAvatar();\n});\n\n// \nfunction updateUserAvatar() {\n  const currentUserAvatar = document.getElementById('currentUserAvatar');\n  const userInitials = document.getElementById('userInitials');\n\n  if (!currentUserAvatar || !userInitials) return;\n\n  // \n  let currentUser = null;\n  \n  // localStoragecurrentUser\n  const currentUserStr = localStorage.getItem('currentUser');\n  if (currentUserStr) {\n    try {\n      currentUser = JSON.parse(currentUserStr);\n    } catch (error) {\n      console.warn('currentUserlocalStorage');\n    }\n  }\n  \n  // localStorage\n  if (!currentUser) {\n    const userId = localStorage.getItem('chatUserId');\n    const nickname = localStorage.getItem('chatUserNickname');\n    const avatarUrl = localStorage.getItem('chatUserAvatar');\n    \n    if (userId) {\n      currentUser = {\n        id: userId,\n        nickname: nickname,\n        avatarUrl: avatarUrl\n      };\n    }\n  }\n  \n  // userIdnickname\n  if (!currentUser) {\n    const userId = localStorage.getItem('userId');\n    const nickname = localStorage.getItem('nickname');\n    const avatarUrl = localStorage.getItem('avatarUrl');\n    \n    if (userId) {\n      currentUser = {\n        id: userId,\n        nickname: nickname,\n        avatarUrl: avatarUrl\n      };\n    }\n  }\n  \n  // \n  if (!currentUser) return;\n\n  // URL\n  let avatarUrl = '';\n  if (currentUser.avatar && typeof currentUser.avatar === 'string') {\n    avatarUrl = currentUser.avatar.trim();\n  } else if (currentUser.avatarUrl && typeof currentUser.avatarUrl === 'string') {\n    avatarUrl = currentUser.avatarUrl.trim();\n  }\n\n  // URLSVGSVG XSS\n  const isSvgAvatar = avatarUrl && /\\.svg$/i.test(avatarUrl);\n\n  if (avatarUrl && !isSvgAvatar) {\n    // \n    const fullAvatarUrl = `https://back.hs.airoe.cn${avatarUrl}`;\n    currentUserAvatar.src = fullAvatarUrl;\n    currentUserAvatar.style.display = 'block';\n    userInitials.style.display = 'none';\n  } else {\n    // SVG\n    const initials = currentUser.nickname ? currentUser.nickname.charAt(0).toUpperCase() : 'U';\n    userInitials.textContent = initials;\n    userInitials.style.display = 'block';\n    currentUserAvatar.style.display = 'none';\n  }\n}\n\nfunction initSidebarToggle() {\n  const menuItems = document.querySelectorAll('.menu-item');\n  const secondaryContents = document.querySelectorAll('.secondary-content');\n  const chatContents = document.querySelectorAll('.chat-content');\n  const switchToOldUI = document.getElementById('switchToOldUI');\n\n  // UI\n  if (switchToOldUI) {\n    switchToOldUI.addEventListener('click', () => {\n      window.location.href = '/oldUI/';\n    });\n  }\n\n  menuItems.forEach(item => {\n    item.addEventListener('click', () => {\n      const targetSection = item.getAttribute('data-section');\n\n      //  - active\n      if (targetSection === 'logout') {\n        if (confirm('')) {\n          logout();\n        }\n        return;\n      }\n\n      // active\n      menuItems.forEach(menuItem => {\n        menuItem.classList.remove('active');\n      });\n\n      secondaryContents.forEach(content => {\n        content.classList.remove('active');\n      });\n\n      chatContents.forEach(content => {\n        content.classList.remove('active');\n        // displaynone\n        content.style.display = 'none';\n      });\n\n      item.classList.add('active');\n\n      const targetSecondaryContent = document.querySelector(`.secondary-content[data-content=\"${targetSection}\"]`);\n      if (targetSecondaryContent) {\n        targetSecondaryContent.classList.add('active');\n      }\n\n      const targetChatContent = document.querySelector(`.chat-content[data-content=\"${targetSection}\"]`);\n      if (targetChatContent) {\n        targetChatContent.classList.add('active');\n        // displayflex\n        targetChatContent.style.display = 'flex';\n        // \n        adjustChatLayout();\n      }\n\n      // Markdown\n      const markdownToolbar = document.getElementById('markdownToolbar');\n      const toggleMarkdownToolbarBtn = document.getElementById('toggleMarkdownToolbar');\n      const toggleGroupMarkdownToolbarBtn = document.getElementById('toggleGroupMarkdownToolbar');\n\n      // \n      if (markdownToolbar) {\n        if (targetSection === 'public-chat') {\n          // \n          // display\n        } else {\n          // \n          markdownToolbar.style.display = 'none';\n        }\n      }\n\n      // /\n      if (toggleMarkdownToolbarBtn) {\n        if (targetSection === 'public-chat') {\n          toggleMarkdownToolbarBtn.style.display = 'inline-block';\n          // \n          if (markdownToolbar) {\n            if (markdownToolbar.style.display === 'none') {\n              toggleMarkdownToolbarBtn.innerHTML = '<i class=\"fas fa-chevron-down\"></i> MD';\n            } else {\n              toggleMarkdownToolbarBtn.innerHTML = '<i class=\"fas fa-chevron-up\"></i> Markdown';\n            }\n          }\n        } else {\n          toggleMarkdownToolbarBtn.style.display = 'none';\n        }\n      }\n\n      if (toggleGroupMarkdownToolbarBtn) {\n        toggleGroupMarkdownToolbarBtn.style.display = targetSection === 'group-chat' ? 'inline-block' : 'none';\n      }\n\n      // \n      if (targetSection === 'public-chat') {\n        // \n        unreadMessages.global = 0;\n        updateUnreadCount();\n        // \n        document.getElementById('publicChatUnreadCount').textContent = '';\n        // \n        document.title = originalTitle;\n      }\n\n      // \n      if (targetSection === 'group-chat') {\n        // \n        document.getElementById('groupChatUnreadCount').textContent = '';\n      }\n\n      // \n      if (targetSection === 'private-chat') {\n        // \n        document.getElementById('privateChatUnreadCount').textContent = '';\n      }\n\n      // \n      updateHashPath(targetSection);\n    });\n  });\n}\n\nfunction logout() {\n  // localStorage\n  localStorage.removeItem('currentUser');\n  localStorage.removeItem('currentSessionToken');\n  localStorage.removeItem('chatUserId');\n  localStorage.removeItem('chatUserNickname');\n  localStorage.removeItem('chatSessionToken');\n  localStorage.removeItem('chatUserAvatar');\n  localStorage.removeItem('userId');\n  localStorage.removeItem('nickname');\n  localStorage.removeItem('avatarUrl');\n  localStorage.removeItem('sessionToken');\n\n  // \n  router.push('/login');\n}\n\nfunction adjustChatLayout() {\n  // \n  console.log('Adjusting chat layout');\n}\n\nfunction updateUnreadCount() {\n  // \n  console.log('Updating unread count');\n}\n\nfunction updateHashPath(section) {\n  //  section \n  let hash = '';\n  // \n  if (window.location.hash === '#/chat') {\n    saveChatHistory('save')\n  }\n  switch (section) {\n    case 'public-chat':\n      hash = '#/chat';\n      break;\n    case 'group-chat':\n      hash = '#/chat/group';\n      break;\n    case 'private-chat':\n      hash = '#/chat/private';\n      break;\n    case 'user-settings':\n      hash = '#/settings';\n      break;\n    default:\n      hash = '#/chat';\n  }\n  // \n  window.location.hash = hash;\n}\n</script>\n\n<template>\n  <div id=\"sidebar\">\n    <div class=\"sidebar-header\">\n        <div id=\"userProfile\" class=\"user-profile\">\n            <div id=\"userAvatar\" class=\"user-avatar\">\n                <img id=\"currentUserAvatar\" src=\"\" alt=\"\" class=\"user-avatar-img\" loading=\"lazy\" width=\"60\" height=\"60\" style=\"aspect-ratio: 1/1; object-fit: cover;\">\n                <span id=\"userInitials\" class=\"user-initials\"></span>\n            </div>\n        </div>\n    </div>\n    <!--  -->\n    <div class=\"menu-section\">\n        <ul class=\"menu-list\">\n            <li :class=\"['menu-item', { active: activeMenuItem === 'public-chat' }]\" data-section=\"public-chat\">\n                <div class=\"chat-avatar\"></div>\n                <div class=\"unread-count\" id=\"publicChatUnreadCount\"></div>\n            </li>\n        </ul>\n    </div>\n    \n    <!--  -->\n    <div class=\"menu-section\">\n        <ul class=\"menu-list\">\n            <li :class=\"['menu-item', { active: activeMenuItem === 'group-chat' }]\" data-section=\"group-chat\">\n                <div class=\"chat-avatar\"><img src=\"icon/User-Group-256.ico\" alt=\"\" style=\"width: 24px; height: 24px;\"></div>\n                <div class=\"unread-count\" id=\"groupChatUnreadCount\"></div>\n            </li>\n        </ul>\n    </div>\n\n    <!--  -->\n    <div class=\"menu-section\">\n        <ul class=\"menu-list\">\n            <li :class=\"['menu-item', { active: activeMenuItem === 'private-chat' }]\" data-section=\"private-chat\">\n                <div class=\"chat-avatar\"><img src=\"icon/User-Profile-256.ico\" alt=\"\" style=\"width: 24px; height: 24px;\"></div>\n                <div class=\"unread-count\" id=\"privateChatUnreadCount\"></div>\n            </li>\n        </ul>\n    </div>\n\n    <div class=\"menu-section\">\n        <ul class=\"menu-list\">\n            <li :class=\"['menu-item', { active: activeMenuItem === 'user-settings' }]\" data-section=\"user-settings\">\n                <div class=\"chat-avatar\"><img src=\"icon/Settings-01-256.ico\" alt=\"\" style=\"width: 24px; height: 24px;\"></div>\n            </li>\n        </ul>\n    </div>\n    \n    <!--  -->\n    <div class=\"menu-section\" style=\"margin-top: auto; margin-bottom: 20px;\">\n        <!-- UI -->\n        <ul class=\"menu-list\">\n            <li class=\"menu-item\" id=\"switchToOldUI\">\n                <div class=\"chat-avatar\" title=\"UI\"></div>\n            </li>\n        </ul>\n        \n        <!--  -->\n        <ul class=\"menu-list\">\n            <li class=\"menu-item\" data-section=\"logout\">\n                <div class=\"chat-avatar\"></div>\n            </li>\n        </ul>\n    </div>\n</div>\n</template>\n\n<style src=\"@/css/index.css\"></style>\n<style src=\"@/css/code-highlight.css\"></style>","import script from \"./ChatSidebar.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ChatSidebar.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"@/css/index.css?vue&type=style&index=0&lang=css&external\"\nimport \"@/css/code-highlight.css?vue&type=style&index=1&lang=css&external\"\n\nconst __exports__ = script;\n\nexport default __exports__","<script setup>\n/* eslint-disable vue/multi-word-component-names */\nimport { computed } from 'vue';\n\n// \nconst activeSecondarySidebar = computed(() => {\n  const hash = window.location.hash;\n  if (hash === '#/chat') {\n    return 'public-chat';\n  } else if (hash === '#/chat/group') {\n    return 'group-chat';\n  } else if (hash === '#/chat/private') {\n    return 'private-chat';\n  } else if (hash === '#/settings') {\n    return 'user-settings';\n  } else {\n    return 'public-chat';\n  }\n});\n</script>\n\n<template>\n  <div id=\"secondary-sidebar\">\n    <!--  -->\n    <div :class=\"['secondary-content', { active: activeSecondarySidebar === 'public-chat' }]\" data-content=\"public-chat\">\n        <div class=\"sidebar-section\">\n            <h3> <span id=\"onlineCount\">(0)</span></h3>\n            <ul class=\"user-list\" id=\"userList\">\n                <li></li>\n            </ul>\n        </div>\n        \n        <div class=\"sidebar-section\">\n            <div class=\"section-header\">\n                <h3></h3>\n            </div>\n            <ul class=\"user-list\" id=\"offlineUserList\">\n                <li></li>\n            </ul>\n        </div>\n    </div>\n    \n    <!--  -->\n    <div :class=\"['secondary-content', { active: activeSecondarySidebar === 'group-chat' }]\" data-content=\"group-chat\">\n        <div class=\"sidebar-section\">\n            <div class=\"section-header\">\n                <div class=\"search-container\">\n                    <input type=\"text\" id=\"groupSearchInput\" placeholder=\"...\" class=\"search-input\">\n                    <button id=\"clearGroupSearch\" class=\"clear-search-btn\" style=\"display: none;\"></button>\n                    <button id=\"createGroupButton\" class=\"create-group-btn\" title=\"\">+</button>\n                </div>\n            </div>\n            <ul class=\"user-list\" id=\"groupList\">\n                <li class=\"loading-item\">\n                    <span class=\"loading-text\">...</span>\n                </li>\n            </ul>\n        </div>\n    </div>\n    \n    <!--  -->\n    <div :class=\"['secondary-content', { active: activeSecondarySidebar === 'private-chat' }]\" data-content=\"private-chat\">\n        <div class=\"sidebar-section\">\n            <div class=\"section-header\">\n                <div class=\"search-container\">\n                    <input type=\"text\" id=\"privateChatSearchInput\" placeholder=\"...\" class=\"search-input\">\n                    <button id=\"clearPrivateChatSearch\" class=\"clear-search-btn\" style=\"display: none;\"></button>\n                    <button id=\"searchUserButton\" class=\"create-group-btn\" style=\"background-color: #3498db;\" title=\"\">+</button>\n                </div>\n            </div>\n            <ul class=\"user-list\" id=\"friendsList\">\n                <li class=\"empty-friends\"></li>\n            </ul>\n        </div>\n    </div>\n    \n    <!--  -->\n    <div :class=\"['secondary-content', { active: activeSecondarySidebar === 'user-settings' }]\" data-content=\"user-settings\">\n        <div class=\"sidebar-section\">\n            <h3></h3>\n            <ul class=\"settings-list\">\n                <li class=\"settings-item\" data-setting-id=\"change-password\"></li>\n                <li class=\"settings-item\" data-setting-id=\"change-nickname\"></li>\n                <li class=\"settings-item\" data-setting-id=\"upload-avatar\"></li>\n            </ul>\n        </div>\n        \n        <div class=\"sidebar-section\">\n            <h3></h3>\n            <ul class=\"settings-list\">\n                <li class=\"settings-item\" data-setting-id=\"theme-settings\" style=\"color: #999;\"> <span style=\"color: #ff6b6b;\">()</span></li>\n                <li class=\"settings-item\" data-setting-id=\"shortcut-settings\"></li>\n            </ul>\n        </div>\n        \n        <div class=\"sidebar-section\">\n            <h3></h3>\n            <ul class=\"settings-list\">\n                <li class=\"settings-item\" data-setting-id=\"version-info\"></li>\n                <li class=\"settings-item\" data-setting-id=\"help-center\"></li>\n            </ul>\n        </div>\n    </div>\n</div>\n</template>\n\n<style src=\"@/css/index.css\"></style>\n<style src=\"@/css/code-highlight.css\"></style>","import script from \"./ChatSecondarySidebar.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ChatSecondarySidebar.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"@/css/index.css?vue&type=style&index=0&lang=css&external\"\nimport \"@/css/code-highlight.css?vue&type=style&index=1&lang=css&external\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { render } from \"./ChatModal.vue?vue&type=template&id=91d06b8c\"\nimport script from \"./ChatModal.vue?vue&type=script&lang=js\"\nexport * from \"./ChatModal.vue?vue&type=script&lang=js\"\n\nimport \"@/css/index.css?vue&type=style&index=0&lang=css&external\"\nimport \"@/css/code-highlight.css?vue&type=style&index=1&lang=css&external\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <div id=\"main-chat\" v-if=\"isUserLoggedIn && shouldShowSidebar\">\n    <ChatSidebar/>\n\n    <ChatSecondarySidebar/>\n\n    <div id=\"chat-main\">\n      <router-view></router-view>\n    </div>\n  </div>\n  <ChatModal v-if=\"isUserLoggedIn && shouldShowSidebar\"/>\n  <router-view v-else></router-view>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport ChatSidebar from \"@/components/ChatSidebar.vue\"\nimport ChatSecondarySidebar from \"@/components/ChatSecondarySidebar.vue\"\nimport { \n  initializeChat,\n} from \"@/utils/chat\"\nimport ChatModal from \"@/components/ChatModal.vue\";\n\nconst router = useRouter()\nconst route = useRoute()\n\n// \nconst userLoggedIn = ref(false)\n\n// \nfunction checkLoginStatus() {\n  const currentUser = localStorage.getItem('currentUser')\n  const currentSessionToken = localStorage.getItem('currentSessionToken')\n  const chatUserId = localStorage.getItem('chatUserId')\n  const chatSessionToken = localStorage.getItem('chatSessionToken')\n  const userId = localStorage.getItem('userId')\n  const sessionToken = localStorage.getItem('sessionToken')\n  \n  // \n  const isLoggedIn = (!!currentUser && (!!currentSessionToken || !!chatSessionToken)) || \n                     (!!chatUserId && !!chatSessionToken) || \n                     (!!userId && !!sessionToken)\n  \n  userLoggedIn.value = isLoggedIn\n  return isLoggedIn\n}\n\n// \nconst isUserLoggedIn = computed(() => userLoggedIn.value)\n\n// \nconst shouldShowSidebar = computed(() => {\n  // \n  const path = route.path\n  // \n  return ['/chat', '/chat/group', '/chat/private', '/settings'].includes(path)\n})\n\n/* \n// const checkLoginStatus = () => {\n//   const userId = localStorage.getItem('userId')\n//   const sessionToken = localStorage.getItem('sessionToken')\n//   const nickname = localStorage.getItem('nickname')\n//   const avatarUrl = localStorage.getItem('avatarUrl')\n//\n//   if (userId && sessionToken) {\n//     // \n//     setCurrentUser({\n//       id: userId,\n//       nickname: nickname,\n//       avatarUrl: avatarUrl\n//     })\n//     setCurrentSessionToken(sessionToken)\n//\n//     // \n//     initializeChat()\n//   }\n// }\n */\n\n// \nconst handleRouteChange = () => {\n  // \n  const requiresAuth = ['public', 'group', 'private', 'settings'].includes(route.name)\n  \n  // checkLoginStatus\n  const isLoggedIn = checkLoginStatus()\n  \n  if (requiresAuth && !isLoggedIn) {\n    // \n    router.push('/login')\n  }\n  \n  // \n  if (isLoggedIn) {\n    const path = route.path\n    if (['/chat', '/chat/group', '/chat/private', '/settings'].includes(path)) {\n      // \n      // shouldShowSidebar\n    }\n  }\n}\n\n// \nonMounted(async () => {\n  // \n  checkLoginStatus()\n  \n  // \n  router.afterEach(() => {\n    checkLoginStatus()\n    handleRouteChange()\n  })\n\n  await router.isReady()\n\n  if (isUserLoggedIn.value) {\n    initializeChat()\n  }\n})\n</script>","import script from \"./App.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { createApp } from 'vue'\nimport { createRouter, createWebHashHistory } from 'vue-router'\nimport App from './App.vue'\n\n//  css \nimport './css/index.css'\nimport './css/code-highlight.css'\nimport './css/mobile.css'\n\n// \nconst router = createRouter({\n    history: createWebHashHistory(),\n    routes: [\n        {\n            path: '/login',\n            name: 'login',\n            component: () => import('./views/Login.vue')\n        },\n        {\n            path: '/register',\n            name: 'register',\n            component: () => import('./views/Register.vue')\n        },\n        {\n            path: '/chat',\n            name: 'public',\n            component: () => import('./views/PublicChat.vue')\n        },\n        {\n            path: '/chat/group',\n            name: 'group',\n            component: () => import('./views/GroupChat.vue')\n        },\n        {\n            path: '/chat/private',\n            name: 'private',\n            component: () => import('./views/PrivateChat.vue')\n        },\n        {\n            path: '/settings',\n            name: 'settings',\n            component: () => import('./views/UserSettings.vue')\n        },\n        {\n            path: '/',\n            redirect: '/chat'\n        },\n        {\n            path: '/:pathMatch(.*)*',\n            redirect: '/chat'\n        }\n    ]\n})\n\n// \nconst app = createApp(App)\napp.use(router)\napp.mount('#app')\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".\" + {\"192\":\"62591ff9\",\"318\":\"6a09c342\",\"595\":\"3fb574af\",\"663\":\"09a96f22\",\"762\":\"38f401e8\",\"942\":\"83b0dd71\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"css/\" + chunkId + \".\" + {\"192\":\"fa82ba64\",\"663\":\"bb36ba2d\"}[chunkId] + \".css\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"vue-chat:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","if (typeof document === \"undefined\") return;\nvar createStylesheet = function(chunkId, fullhref, oldTag, resolve, reject) {\n\tvar linkTag = document.createElement(\"link\");\n\n\tlinkTag.rel = \"stylesheet\";\n\tlinkTag.type = \"text/css\";\n\tif (__webpack_require__.nc) {\n\t\tlinkTag.nonce = __webpack_require__.nc;\n\t}\n\tvar onLinkComplete = function(event) {\n\t\t// avoid mem leaks.\n\t\tlinkTag.onerror = linkTag.onload = null;\n\t\tif (event.type === 'load') {\n\t\t\tresolve();\n\t\t} else {\n\t\t\tvar errorType = event && event.type;\n\t\t\tvar realHref = event && event.target && event.target.href || fullhref;\n\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + errorType + \": \" + realHref + \")\");\n\t\t\terr.name = \"ChunkLoadError\";\n\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n\t\t\terr.type = errorType;\n\t\t\terr.request = realHref;\n\t\t\tif (linkTag.parentNode) linkTag.parentNode.removeChild(linkTag)\n\t\t\treject(err);\n\t\t}\n\t}\n\tlinkTag.onerror = linkTag.onload = onLinkComplete;\n\tlinkTag.href = fullhref;\n\n\n\tif (oldTag) {\n\t\toldTag.parentNode.insertBefore(linkTag, oldTag.nextSibling);\n\t} else {\n\t\tdocument.head.appendChild(linkTag);\n\t}\n\treturn linkTag;\n};\nvar findStylesheet = function(href, fullhref) {\n\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n\tfor(var i = 0; i < existingLinkTags.length; i++) {\n\t\tvar tag = existingLinkTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return tag;\n\t}\n\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n\tfor(var i = 0; i < existingStyleTags.length; i++) {\n\t\tvar tag = existingStyleTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\");\n\t\tif(dataHref === href || dataHref === fullhref) return tag;\n\t}\n};\nvar loadStylesheet = function(chunkId) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar href = __webpack_require__.miniCssF(chunkId);\n\t\tvar fullhref = __webpack_require__.p + href;\n\t\tif(findStylesheet(href, fullhref)) return resolve();\n\t\tcreateStylesheet(chunkId, fullhref, null, resolve, reject);\n\t});\n}\n// object to store loaded CSS chunks\nvar installedCssChunks = {\n\t524: 0\n};\n\n__webpack_require__.f.miniCss = function(chunkId, promises) {\n\tvar cssChunks = {\"192\":1,\"663\":1};\n\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n\t\tpromises.push(installedCssChunks[chunkId] = loadStylesheet(chunkId).then(function() {\n\t\t\tinstalledCssChunks[chunkId] = 0;\n\t\t}, function(e) {\n\t\t\tdelete installedCssChunks[chunkId];\n\t\t\tthrow e;\n\t\t}));\n\t}\n};\n\n// no hmr\n\n// no prefetching\n\n// no preloaded","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkvue_chat\"] = self[\"webpackChunkvue_chat\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(6002); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["createToastContainer","container","document","getElementById","createElement","id","style","position","top","right","zIndex","display","flexDirection","alignItems","gap","body","appendChild","showToast","message","type","duration","toast","className","padding","borderRadius","color","fontSize","fontWeight","boxShadow","transition","transform","opacity","backgroundColor","textContent","setTimeout","parentNode","removeChild","success","error","warning","info","marked","require","io","SERVER_URL","sessionStore","currentGroupId","currentGroupName","currentPrivateChatUserId","currentPrivateChatUsername","currentPrivateChatNickname","currentPrivateChatAvatarUrl","currentActiveChat","currentSendChatType","selectedGroupIdForCard","currentUser","currentSessionToken","localStorage","getItem","window","isConnected","onlineUsersList","friendsList","hasReceivedHistory","hasReceivedGroupHistory","hasReceivedPrivateHistory","originalTitle","title","unreadMessages","global","groups","private","isPageVisible","groupMessageCache","currentSharedGroup","chatHistory","initializeChat","userId","sessionToken","nickname","avatarUrl","console","warn","initializeChatInternal","initializeWebSocket","initializeMessageSending","enableMessageSending","log","username","activeChat","setActiveChat","privateEmptyState","privateChatInterface","privateUserName","loadPrivateChatHistory","updateUserAvatar","currentUserAvatar","userInitials","avatar","trim","isSvgAvatar","test","fullAvatarUrl","src","initials","charAt","toUpperCase","initializePrivateChatFunctions","initializeFriendsListListeners","initializeUserProfileModal","initializeUserSearch","initializePrivateMessageSending","initializePrivateChatInterface","loadFriendsList","fetch","headers","then","response","json","data","status","updateFriendsList","friends","innerHTML","catch","friendsListElement","length","forEach","friend","li","dataset","userNickname","avatarHtml","avatar_url","isOnline","some","onlineUser","String","addEventListener","switchToPrivateChat","updateUnreadCountsDisplay","addAvatarClickListeners","privateUserAvatar","privateUserInitials","privateUserStatus","unescapeHtml","visibility","privateMessageContainer","chatSocket","emit","friendId","renderPrivateMessage","returnElement","msgSenderId","senderId","msgReceiverId","receiverId","currentChatId","querySelector","loadingElement","remove","emptyElement","messageType","content","imageUrl","fileUrl","text","messageUser","senderNickname","sender","senderAvatarUrl","isOwn","messageElement","escapeHtml","div","setAttribute","undefined","sequence","marginLeft","marginRight","maxWidth","minWidth","alignSelf","border","marginBottom","messageHtml","timeString","Date","timestampISO","created_at","timestamp","toLocaleTimeString","fullImageUrl","startsWith","widthAttr","heightAttr","width","height","imageData","JSON","parse","url","fullFileUrl","fileName","fileSize","formatFileSize","fileData","name","size","groupCardData","group_name","group_description","setOptions","breaks","gfm","e","groupCardElement","stopPropagation","showGroupCardPopup","scrollTop","scrollHeight","bytes","toFixed","uploadPrivateImage","file","isFriend","formData","FormData","append","uploadProgress","uploadProgressBar","method","messageData","stringify","showError","finally","privateImageInput","value","uploadPrivateFile","privateFileInput","privateChatSearchInput","clearPrivateChatSearch","keyword","toLowerCase","friendItems","querySelectorAll","item","friendName","includes","searchUserButton","closeUserProfileModal","closeUserProfileButton","closeUserSearchModal","cancelUserSearch","confirmUserSearch","searchKeyword","searchUsers","encodeURIComponent","displaySearchResults","users","searchResults","user","resultItem","imageExtensions","match","addFriendBtn","addFriend","resultAvatar","showUserAvatarPopup","target","classList","contains","closest","showUserProfile","userProfileModal","modalUserAvatar","modalUserInitials","modalUserNickname","modalUsername","modalUserId","modalUserStatus","justifyContent","modalContent","event","popup","popupAvatarImg","popupInitials","popupNickname","popupUsername","popupAddFriend","isCurrentUser","cursor","disabled","onclick","hideUserAvatarPopup","fetchUserInfo","Error","displayPopup","displayUser","openImagePreview","popupRect","getBoundingClientRect","popupWidth","popupHeight","left","clientX","scrollX","clientY","scrollY","innerWidth","innerHeight","fullUser","removeEventListener","friendAvatars","index","onlineUserAvatars","offlineUserAvatars","offlineUserList","sendPrivateMessageButton","sendPrivateMessage","privateMessageInput","key","shiftKey","ctrlKey","preventDefault","tagName","isContentEditable","selection","getSelection","range","getRangeAt","br","deleteContents","insertNode","setStartAfter","setEndAfter","removeAllRanges","addRange","start","selectionStart","end","selectionEnd","substring","newPosition","setSelectionRange","focus","markdownToolbar","markdownButtons","button","prefix","getAttribute","suffix","sample","insertMarkdownFormat","privateImageUploadButton","onchange","click","this","files","privateFileUploadButton","items","clipboardData","getAsFile","activeInput","activeChatContent","contentType","activeElement","editableInputs","i","offsetParent","selectedText","toString","createRange","newText","execCommand","innerText","deleteFriendButton","deleteFriend","privateUserInfoButton","replace","privateMoreButton","privateMoreFunctions","toggle","togglePrivateMarkdownToolbar","privateMarkdownToolbar","icon","updateTitleWithUnreadCount","onlyClearUnread","confirm","logout","disconnect","removeItem","location","hash","reload","initializeGroupFunctions","initializeFocusListeners","initAllFunctions","loadUserList","loadOfflineUsers","loadGroupList","checkUserAndIPStatus","callback","ok","isBanned","userExists","socket","transports","reconnection","reconnectionAttempts","Infinity","reconnectionDelay","reconnectionDelayMax","timeout","autoConnect","onlineUsersTimer","on","canProceed","joinedData","groupId","historyRequest","limit","setInterval","attemptNumber","disableMessageSending","clearInterval","setItem","now","messageTime","getTime","isRecentMessage","isHistory","handleNewMessage","displayGroupMessage","displayMessage","updateUserList","updateGroupList","groupList","processedUnreadMessages","hasOwnProperty","unreadPrivateMessages","mutedGroups","getMutedGroups","messageContainer","emptyState","messages","Array","isArray","resetLoadingState","sortedMessages","sort","a","b","messagesToRender","loadMore","reverse","processedMessageIds","Set","existingMessages","prevScrollHeight","prevScrollTop","msg","add","has","insertBefore","firstChild","newScrollHeight","heightDifference","groupMessageContainer","groupEmptyState","messageId","groupMessageElement","nodeType","messageRegex","RegExp","modal","modalGroupNoticeValue","newDescription","isInCurrentPrivateChat","targetUserId","getChatHistory","options","olderThan","getGroupChatHistory","historyOptions","ModalManager","init","initCreateGroupModal","initGroupInfoModal","initAddGroupMemberModal","showModal","modalId","overflow","loadAvailableMembers","hideModal","closeButtons","createGroupButton","bindCreateGroupSubmit","hideAddGroupMemberModal","confirmAddMembersBtn","confirmAddGroupMembers","groupMembersList","availableMembers","filter","map","join","submitButton","handleCreateGroupSubmit","newGroupNameInput","newGroupDescriptionInput","createGroupMessage","groupName","groupDescription","selectedMemberCheckboxes","selectedMemberIds","from","checkbox","description","memberIds","closeImagePreviewModal","handleModalBackgroundClick","imgElement","closeBtn","closeBtnContainer","existingCloseBtn","imagePreviewModal","addImageClickEvents","images","img","hasAttribute","addCopyButtonEvents","copyButtons","code","decodeURIComponent","navigator","clipboard","writeText","copyNotice","parentElement","err","observer","MutationObserver","observe","childList","subtree","groupObserver","privateObserver","updateAllMessagesNickname","newNickname","messageHeader","messageUserId","messageInput","sendButton","imageUploadButton","fileUploadButton","removeAttribute","placeholder","groupMessageInput","sendGroupMessageBtn","groupImageUploadButton","groupFileUploadButton","updateOfflineUserList","filteredOfflineUsers","offlineUser","borderBottom","parsedContent","renderer","Renderer","lang","escaped","language","lines","split","lineNumbers","_","encodedCode","html","contentToParse","alt","trimmedUrl","urlRegex","attr1","hrefAttr","href","attr2","hasDownloadAttr","isHttpLink","isImageLink","fileExtensions","hasFileExtension","fileExtension","pop","fileIcon","filename","messageContent","group_id","imgSrc","displayFilename","deleteButton","messageAvatar","renderMathInElement","delimiters","distanceToBottom","clientHeight","isAtBottom","cloneNode","outerHTML","messageGroupId","isHistoryMessage","msgGroupId","isDuplicate","m","push","generateMessageHash","time","createdAt","char","charCodeAt","Math","abs","messageIdentifier","identifier","fileFullUrl","groupMessageAvatar","handlePageVisibilityChange","handleFocusChange","initializeMoreButtons","moreButton","mainMoreFunctions","mainInputContainer","newMoreButton","replaceChild","groupMoreButton","groupMoreFunctions","groupInputContainer","newGroupMoreButton","privateInputContainer","newPrivateMoreButton","sendGroupCardButton","sendGroupCardButtonGroup","privateSendGroupCardButton","newSendGroupCardButton","showSendGroupCardModal","newSendGroupCardButtonGroup","newPrivateSendGroupCardButton","closeSendGroupCardModal","cancelSendGroupCard","confirmSendGroupCard","newCloseSendGroupCardModal","newCancelSendGroupCard","newConfirmSendGroupCard","sendGroupCard","chatType","sendGroupCardList","group","groupItem","margin","label","flex","originalGroupName","radio","borderColor","token","groupData","groupCardContent","invite_token","imageInput","fileInput","sendMessage","uploadImage","uploadFile","toggleMarkdownToolbarBtn","adjustChatLayout","commonAncestorContainer","textNode","createTextNode","newCursorStart","newCursorEnd","setStart","setEnd","selectNodeContents","collapse","toggleGroupMarkdownToolbarBtn","groupMarkdownToolbar","groupMarkdownButtons","startPos","endPos","chatContent","paddingBottom","paddingTop","requestAnimationFrame","Image","reader","FileReader","onload","isGroupChat","groupImageInput","onerror","result","readAsDataURL","groupFileInput","groupSearchInput","clearGroupSearch","groupItems","groupChatInterface","sendGroupMessage","tempDiv","parseInt","textarea","existingPopup","header","titleContainer","avatarImg","objectFit","defaultAvatar","background","groupIdP","descP","descStrong","buttonArea","joinBtn","joinGroupWithToken","currentTarget","getPasswordCaptcha","captchaContainer","captchaIdInput","captchaSvg","svgElement","captchaId","initializeSettingsFunctions","settingsContainer","settingsForms","form","handleSettingsSubmit","selectAvatarButton","avatarFileInput","uploadAvatarButton","avatarPreview","uploadUserAvatar","showSuccess","currentAvatarImg","settingId","oldPassword","newPassword","confirmPassword","captchaCode","once","reset","endpoint","addGroupButtonListeners","groupInfoButton","leaveGroupButton","setupCreateGroupButton","setupGroupInfoButton","setupLeaveGroupButton","newCreateGroupButton","modalManager","newGroupInfoButton","displayGroupInfoModal","modalGroupName","modalGroupNameValue","modalGroupIdValue","modalGroupMemberCount","modalGroupOwner","groupManageSection","ownerId","creator_id","creatorId","adminId","isOwner","existingAvatarElement","modalGroupAvatarValue","avatarContainer","groupAvatarUrl","uploadAvatarBtn","accept","uploadGroupAvatar","modalBody","setupEditGroupNoticeButton","setupEditGroupNameButton","loadGroupMembers","refreshGroupMembersBtn","addMemberToGroupBtn","showAddGroupMemberModal","currentNotice","editGroupNoticeBtn","editTextarea","minHeight","resize","saveBtn","cancelBtn","groupNoticeContainer","newNotice","updateGroupNotice","span","wordBreak","currentName","editGroupNameBtn","editInput","groupNameContainer","newGroupName","updateGroupName","newLeaveGroupButton","updateLeaveGroupButtonText","handleDissolveGroup","handleLeaveGroup","dissolveGroup","currentGroupNameElement","groupMembersContainer","updateGroupMembersList","members","errorMsg","membersHtml","member","isMemberOwner","kickButtons","memberId","memberName","removeMemberFromGroup","currentAddingGroupId","loadAvailableMembersForGroup","addMembersMessage","availableMembersList","checkboxes","checked","friendsData","membersData","groupMembers","groupMemberIds","availableFriends","isNotCurrentUser","isNotInGroup","unescapedGroupName","updateGroupNameInList","manageGroupModal","updateGroupNoticeInList","groupNameEl","backToMainChat","publicChatContent","initializeGroupButtons","mutations","mutation","attributeName","attributes","userList","onlineCount","displayName","statusElement","totalUnread","groupUnread","privateUnread","publicChatUnreadEl","groupChatUnreadEl","totalGroupUnread","Object","keys","privateChatUnreadEl","totalPrivateUnread","groupListItems","unreadCount","unreadEl","friendListItems","hidden","hasFocus","isGroup","shouldAddUnread","isGroupMuted","toggleGroupMute","groupIdStr","updatedGroups","updateGroupListDisplay","updateGroupMuteIcon","muteIcon","showContextMenu","hideContextMenu","contextMenu","isMuted","menuItem","whiteSpace","currentContextMenu","groupNameSpan","loadGroupMessages","forceReload","overflowY","loadTime","joinGroupData","ensureScrollToBottom","currentHeight","initSidebarToggle","menuItems","secondaryContents","chatContents","switchToOldUI","targetSection","targetSecondaryContent","targetChatContent","originalLoadGroupList","initSettingsItemClick","settingsItems","settingsDetails","settingsEmptyState","detail","targetSetting","initGroupClick","initCancelButtons","cancelButtons","initializeScrollLoading","handleScroll","isPrivate","isLoadingMoreMessages","minSequence","sequenceAttr","isNaN","loadingIndicatorTimeout","loadingIndicator","textAlign","clearTimeout","loadingIndicators","indicator","closeAvatarPreviewModal","handleAvatarModalBackgroundClick","withdrawPrivateMessage","closeAvatarBtn","avatarPreviewModal","addAvatarClickEvents","avatars","parentWithId","nameElement","userItem","messageItem","avatarImages","setupEventDelegation","handleAvatarClick","userElement","addGroupAvatarClickEvents","groupAvatar","login","currentUserStr","storedCurrentSessionToken","chatUserId","chatSessionToken","chatUserNickname","chatUserAvatar","currentHash","saveChatHistory","fragment","createDocumentFragment","children","modals","router","useRouter","activeMenuItem","computed","updateUnreadCount","updateHashPath","section","onMounted","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","class","_normalizeClass","active","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","__exports__","activeSecondarySidebar","render","route","useRoute","userLoggedIn","ref","checkLoginStatus","isLoggedIn","isUserLoggedIn","shouldShowSidebar","path","handleRouteChange","requiresAuth","async","afterEach","isReady","_createVNode","ChatSidebar","ChatSecondarySidebar","_component_router_view","_createBlock","ChatModal","createRouter","history","createWebHashHistory","routes","component","redirect","app","createApp","App","use","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","deferred","O","chunkIds","fn","priority","notFulfilled","fulfilled","j","every","splice","r","n","getter","__esModule","d","definition","o","defineProperty","enumerable","get","f","chunkId","Promise","all","reduce","promises","u","miniCssF","g","globalThis","Function","obj","prop","prototype","inProgress","dataWebpackPrefix","l","done","script","needAttach","scripts","getElementsByTagName","s","charset","nc","onScriptComplete","prev","doneFns","bind","head","Symbol","toStringTag","p","createStylesheet","fullhref","oldTag","resolve","reject","linkTag","rel","nonce","onLinkComplete","errorType","realHref","request","nextSibling","findStylesheet","existingLinkTags","tag","dataHref","existingStyleTags","loadStylesheet","installedCssChunks","miniCss","cssChunks","installedChunks","installedChunkData","promise","loadingEnded","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"ignoreList":[],"sourceRoot":""}